
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Spring_3 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../springmvc/SpringMVC_1.html" />
    
    
    <link rel="prev" href="Spring_2.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">数据库</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../database/shu-ju-ku-ji-chu.html">
            
                <a href="../database/shu-ju-ku-ji-chu.html">
            
                    
                    数据库基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../database/yue-shu.html">
            
                <a href="../database/yue-shu.html">
            
                    
                    约束
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../database/design.html">
            
                <a href="../database/design.html">
            
                    
                    数据库设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../database/multi-table-query.html">
            
                <a href="../database/multi-table-query.html">
            
                    
                    多表查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../database/transaction.html">
            
                <a href="../database/transaction.html">
            
                    
                    事务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../database/JDBC.html">
            
                <a href="../database/JDBC.html">
            
                    
                    JDBC
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Spring framework</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="Spring_1.html">
            
                <a href="Spring_1.html">
            
                    
                    Spring_1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="Spring_2.html">
            
                <a href="Spring_2.html">
            
                    
                    Spring_2
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.3" data-path="Spring_3.html">
            
                <a href="Spring_3.html">
            
                    
                    Spring_3
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Spring MVC</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../springmvc/SpringMVC_1.html">
            
                <a href="../springmvc/SpringMVC_1.html">
            
                    
                    Spring MVC_1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../springmvc/SpringMVC_2.html">
            
                <a href="../springmvc/SpringMVC_2.html">
            
                    
                    Spring MVC_2
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Spring_3</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="springday03">Spring_day03</h2>
<p><strong>&#x4ECA;&#x65E5;&#x76EE;&#x6807;</strong></p>
<blockquote>
<ul>
<li>&#x7406;&#x89E3;&#x5E76;&#x638C;&#x63E1;AOP&#x76F8;&#x5173;&#x6982;&#x5FF5;</li>
<li>&#x80FD;&#x591F;&#x8BF4;&#x51FA;AOP&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</li>
<li>&#x80FD;&#x8FD0;&#x7528;AOP&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#x5B8C;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x6848;&#x4F8B;&#x7F16;&#x5199;</li>
<li>&#x91CD;&#x70B9;&#x638C;&#x63E1;Spring&#x7684;&#x58F0;&#x660E;&#x5F0F;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;</li>
</ul>
</blockquote>
<h2 id="1&#x3001;aop&#x7B80;&#x4ECB;">1&#x3001;AOP&#x7B80;&#x4ECB;</h2>
<p>&#x524D;&#x9762;&#x6211;&#x4EEC;&#x5728;&#x4ECB;&#x7ECD;Spring&#x7684;&#x65F6;&#x5019;&#x8BF4;&#x8FC7;&#xFF0C;Spring&#x6709;&#x4E24;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;<code>IOC/DI</code>&#xFF0C;&#x4E00;&#x4E2A;&#x662F;<code>AOP</code>&#x3002;</p>
<p>&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x5BF9;<code>IOC/DI</code>&#x8FDB;&#x884C;&#x4E86;&#x7CFB;&#x7EDF;&#x7684;&#x5B66;&#x4E60;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x5B66;&#x4E60;&#x5B83;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x6838;&#x5FC3;&#x5185;&#x5BB9;&#xFF0C;&#x5C31;&#x662F;<code>AOP</code>&#x3002;</p>
<p>&#x5BF9;&#x4E8E;AOP,&#x6211;&#x4EEC;&#x524D;&#x9762;&#x63D0;&#x8FC7;&#x4E00;&#x53E5;&#x8BDD;&#x662F;:<code>AOP&#x662F;&#x5728;&#x4E0D;&#x6539;&#x539F;&#x6709;&#x4EE3;&#x7801;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#x3002;</code></p>
<p>&#x5BF9;&#x4E8E;&#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x56F4;&#x7ED5;&#x7740;&#x8FD9;&#x4E00;&#x53E5;&#x8BDD;&#x8FDB;&#x884C;&#x5C55;&#x5F00;&#x5B66;&#x4E60;&#xFF0C;&#x4E3B;&#x8981;&#x5B66;&#x4E60;&#x4E24;&#x65B9;&#x9762;&#x5185;&#x5BB9;<code>AOP&#x6838;&#x5FC3;&#x6982;&#x5FF5;</code>,<code>AOP&#x4F5C;&#x7528;</code>:</p>
<h3 id="11-&#x4EC0;&#x4E48;&#x662F;aop">1.1 &#x4EC0;&#x4E48;&#x662F;AOP?</h3>
<ul>
<li>AOP(Aspect Oriented Programming)&#x9762;&#x5411;&#x5207;&#x9762;&#x7F16;&#x7A0B;&#xFF0C;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x8303;&#x5F0F;&#xFF0C;&#x6307;&#x5BFC;&#x5F00;&#x53D1;&#x8005;&#x5982;&#x4F55;&#x7EC4;&#x7EC7;&#x7A0B;&#x5E8F;&#x7ED3;&#x6784;&#x3002;<ul>
<li>OOP(Object Oriented Programming)&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;</li>
</ul>
</li>
</ul>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;OOP&#x662F;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x601D;&#x60F3;&#xFF0C;&#x90A3;&#x4E48;AOP&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x601D;&#x60F3;&#xFF0C;&#x7F16;&#x7A0B;&#x601D;&#x60F3;&#x4E3B;&#x8981;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x662F;&#x6307;&#x5BFC;&#x7A0B;&#x5E8F;&#x5458;&#x8BE5;&#x5982;&#x4F55;&#x7F16;&#x5199;&#x7A0B;&#x5E8F;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x4E24;&#x4E2A;&#x662F;&#x4E0D;&#x540C;&#x7684;<code>&#x7F16;&#x7A0B;&#x8303;&#x5F0F;</code>&#x3002;</p>
<h3 id="12-aop&#x4F5C;&#x7528;">1.2 AOP&#x4F5C;&#x7528;</h3>
<ul>
<li>&#x4F5C;&#x7528;:&#x5728;&#x4E0D;&#x60CA;&#x52A8;&#x539F;&#x59CB;&#x8BBE;&#x8BA1;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x4E3A;&#x5176;&#x8FDB;&#x884C;&#x529F;&#x80FD;&#x589E;&#x5F3A;&#xFF0C;&#x524D;&#x9762;&#x54B1;&#x4EEC;&#x6709;&#x6280;&#x672F;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;&#x5373;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x3002;</li>
</ul>
<p>&#x524D;&#x9762;&#x54B1;&#x4EEC;&#x6709;&#x6280;&#x672F;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x529F;&#x80FD;&#x5373;<code>&#x4EE3;&#x7406;&#x6A21;&#x5F0F;</code>&#x3002;</p>
<h3 id="13-aop&#x6838;&#x5FC3;&#x6982;&#x5FF5;">1.3 AOP&#x6838;&#x5FC3;&#x6982;&#x5FF5;</h3>
<p>&#x4E3A;&#x4E86;&#x80FD;&#x66F4;&#x597D;&#x7684;&#x7406;&#x89E3;AOP&#x7684;&#x76F8;&#x5173;&#x6982;&#x5FF5;&#xFF0C;&#x6211;&#x4EEC;&#x51C6;&#x5907;&#x4E86;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#xFF0C;&#x6574;&#x4E2A;&#x73AF;&#x5883;&#x7684;&#x5185;&#x5BB9;&#x6211;&#x4EEC;&#x6682;&#x65F6;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x5173;&#x6CE8;&#xFF0C;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x7C7B;&#x4E3A;:<code>BookDaoImpl</code></p>
<pre><code class="lang-java"><span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">//&#x8BB0;&#x5F55;&#x7A0B;&#x5E8F;&#x5F53;&#x524D;&#x6267;&#x884C;&#x6267;&#x884C;&#xFF08;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#xFF09;</span>
        Long startTime = System.currentTimeMillis();
        <span class="hljs-comment">//&#x4E1A;&#x52A1;&#x6267;&#x884C;&#x4E07;&#x6B21;</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10000</span>;i++) {
            System.out.println(<span class="hljs-string">&quot;book dao save ...&quot;</span>);
        }
        <span class="hljs-comment">//&#x8BB0;&#x5F55;&#x7A0B;&#x5E8F;&#x5F53;&#x524D;&#x6267;&#x884C;&#x65F6;&#x95F4;&#xFF08;&#x7ED3;&#x675F;&#x65F6;&#x95F4;&#xFF09;</span>
        Long endTime = System.currentTimeMillis();
        <span class="hljs-comment">//&#x8BA1;&#x7B97;&#x65F6;&#x95F4;&#x5DEE;</span>
        Long totalTime = endTime-startTime;
        <span class="hljs-comment">//&#x8F93;&#x51FA;&#x4FE1;&#x606F;</span>
        System.out.println(<span class="hljs-string">&quot;&#x6267;&#x884C;&#x4E07;&#x6B21;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#xFF1A;&quot;</span> + totalTime + <span class="hljs-string">&quot;ms&quot;</span>);
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;book dao update ...&quot;</span>);
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;book dao delete ...&quot;</span>);
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">select</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;book dao select ...&quot;</span>);
    }
}
</code></pre>
<p>&#x4EE3;&#x7801;&#x7684;&#x5185;&#x5BB9;&#x76F8;&#x4FE1;&#x5927;&#x5BB6;&#x90FD;&#x80FD;&#x591F;&#x8BFB;&#x61C2;&#xFF0C;&#x5BF9;&#x4E8E;<code>save</code>&#x65B9;&#x6CD5;&#x4E2D;&#x6709;&#x8BA1;&#x7B97;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x5F53;&#x5728;App&#x7C7B;&#x4E2D;&#x4ECE;&#x5BB9;&#x5668;&#x4E2D;&#x83B7;&#x53D6;bookDao&#x5BF9;&#x8C61;&#x540E;&#xFF0C;&#x5206;&#x522B;&#x6267;&#x884C;&#x5176;<code>save</code>,<code>delete</code>,<code>update</code>&#x548C;<code>select</code>&#x65B9;&#x6CD5;&#x540E;&#x4F1A;&#x6709;&#x5982;&#x4E0B;&#x7684;&#x6253;&#x5370;&#x7ED3;&#x679C;:</p>
<p><img src="../.gitbook/assets/1630143927489.png" alt="1630143927489"></p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5E94;&#x8BE5;&#x6709;&#x4E9B;&#x7591;&#x95EE;?</p>
<ul>
<li>&#x5BF9;&#x4E8E;&#x8BA1;&#x7B97;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;&#x53EA;&#x6709;save&#x65B9;&#x6CD5;&#x6709;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;delete&#x548C;update&#x65B9;&#x6CD5;&#x4E5F;&#x4F1A;&#x6709;&#x5462;?</li>
<li>delete&#x548C;update&#x65B9;&#x6CD5;&#x6709;&#xFF0C;&#x90A3;&#x4EC0;&#x4E48;select&#x65B9;&#x6CD5;&#x4E3A;&#x4EC0;&#x4E48;&#x53C8;&#x6CA1;&#x6709;&#x5462;?</li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x4E2D;&#x5176;&#x5B9E;&#x5C31;&#x4F7F;&#x7528;&#x4E86;Spring&#x7684;AOP&#xFF0C;&#x5728;&#x4E0D;&#x60CA;&#x52A8;(&#x6539;&#x52A8;)&#x539F;&#x6709;&#x8BBE;&#x8BA1;(&#x4EE3;&#x7801;)&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x60F3;&#x7ED9;&#x8C01;&#x6DFB;&#x52A0;&#x529F;&#x80FD;&#x5C31;&#x7ED9;&#x8C01;&#x6DFB;&#x52A0;&#x3002;&#x8FD9;&#x4E2A;&#x4E5F;&#x5C31;&#x662F;Spring&#x7684;&#x7406;&#x5FF5;&#xFF1A;</p>
<ul>
<li>&#x65E0;&#x5165;&#x4FB5;&#x5F0F;/&#x65E0;&#x4FB5;&#x5165;&#x5F0F;</li>
</ul>
<p>&#x8BF4;&#x4E86;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;Spring&#x5230;&#x5E95;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#x5462;?</p>
<p><img src="../.gitbook/assets/1630144353462.png" alt="1630144353462"></p>
<p>(1)&#x524D;&#x9762;&#x4E00;&#x76F4;&#x5728;&#x5F3A;&#x8C03;&#xFF0C;Spring&#x7684;AOP&#x662F;&#x5BF9;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x5728;&#x4E0D;&#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#x5B9E;&#x73B0;&#x589E;&#x5F3A;&#x3002;&#x5BF9;&#x4E8E;&#x4E0A;&#x9762;&#x7684;&#x6848;&#x4F8B;&#x4E2D;BookServiceImpl&#x4E2D;&#x6709;<code>save</code>,<code>update</code>,<code>delete</code>&#x548C;<code>select</code>&#x65B9;&#x6CD5;,&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x6211;&#x4EEC;&#x7ED9;&#x8D77;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x53EB;<code>&#x8FDE;&#x63A5;&#x70B9;</code></p>
<p>(2)&#x5728;BookServiceImpl&#x7684;&#x56DB;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;<code>update</code>&#x548C;<code>delete</code>&#x53EA;&#x6709;&#x6253;&#x5370;&#x6CA1;&#x6709;&#x8BA1;&#x7B97;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#x5DF2;&#x7ECF;&#x6709;&#x8BE5;&#x529F;&#x80FD;&#xFF0C;&#x90A3;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;<code>update</code>&#x548C;<code>delete</code>&#x65B9;&#x6CD5;&#x90FD;&#x5DF2;&#x7ECF;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x65B9;&#x6CD5;&#x6211;&#x4EEC;&#x7ED9;&#x8D77;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x53EB;<code>&#x5207;&#x5165;&#x70B9;</code></p>
<p>(3)&#x6267;&#x884C;BookServiceImpl&#x7684;update&#x548C;delete&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x90FD;&#x88AB;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5C06;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x62BD;&#x53D6;&#x5230;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#x5C31;&#x662F;&#x5B58;&#x653E;&#x5171;&#x6027;&#x529F;&#x80FD;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x7ED9;&#x8D77;&#x4E86;&#x4E2A;&#x540D;&#x5B57;&#x53EB;<code>&#x901A;&#x77E5;</code></p>
<p>(4)&#x901A;&#x77E5;&#x662F;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#xFF0C;&#x5207;&#x5165;&#x70B9;&#x662F;&#x9700;&#x8981;&#x88AB;&#x589E;&#x5F3A;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#xFF0C;&#x90A3;&#x54EA;&#x4E2A;&#x5207;&#x5165;&#x70B9;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x54EA;&#x4E2A;&#x901A;&#x77E5;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x63D0;&#x524D;&#x5C06;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x63CF;&#x8FF0;&#x6E05;&#x695A;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x901A;&#x77E5;&#x548C;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x63CF;&#x8FF0;&#xFF0C;&#x6211;&#x4EEC;&#x7ED9;&#x8D77;&#x4E86;&#x4E2A;&#x540D;&#x5B57;&#x53EB;<code>&#x5207;&#x9762;</code></p>
<p>(5)&#x901A;&#x77E5;&#x662F;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x65B9;&#x6CD5;&#x4E0D;&#x80FD;&#x72EC;&#x7ACB;&#x5B58;&#x5728;&#x9700;&#x8981;&#x88AB;&#x5199;&#x5728;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x6211;&#x4EEC;&#x4E5F;&#x7ED9;&#x8D77;&#x4E86;&#x4E2A;&#x540D;&#x5B57;&#x53EB;<code>&#x901A;&#x77E5;&#x7C7B;</code></p>
<p>&#x81F3;&#x6B64;AOP&#x4E2D;&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#x5C31;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x5B8C;&#x4E86;&#xFF0C;&#x603B;&#x7ED3;&#x4E0B;:</p>
<ul>
<li>&#x8FDE;&#x63A5;&#x70B9;(JoinPoint)&#xFF1A;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;&#xFF0C;&#x7C92;&#x5EA6;&#x4E3A;&#x6267;&#x884C;&#x65B9;&#x6CD5;&#x3001;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3001;&#x8BBE;&#x7F6E;&#x53D8;&#x91CF;&#x7B49;<ul>
<li>&#x5728;SpringAOP&#x4E2D;&#xFF0C;&#x7406;&#x89E3;&#x4E3A;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;</li>
</ul>
</li>
<li>&#x5207;&#x5165;&#x70B9;(Pointcut):&#x5339;&#x914D;&#x8FDE;&#x63A5;&#x70B9;&#x7684;&#x5F0F;&#x5B50;<ul>
<li>&#x5728;SpringAOP&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x5207;&#x5165;&#x70B9;&#x53EF;&#x4EE5;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x53EF;&#x4E5F;&#x5339;&#x914D;&#x591A;&#x4E2A;&#x65B9;&#x6CD5;<ul>
<li>&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x65B9;&#x6CD5;:&#x5982;com.itheima.dao&#x5305;&#x4E0B;&#x7684;BookDao&#x63A5;&#x53E3;&#x4E2D;&#x7684;&#x65E0;&#x5F62;&#x53C2;&#x65E0;&#x8FD4;&#x56DE;&#x503C;&#x7684;save&#x65B9;&#x6CD5;</li>
<li>&#x5339;&#x914D;&#x591A;&#x4E2A;&#x65B9;&#x6CD5;:&#x6240;&#x6709;&#x7684;save&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x6709;&#x7684;get&#x5F00;&#x5934;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x6709;&#x4EE5;Dao&#x7ED3;&#x5C3E;&#x7684;&#x63A5;&#x53E3;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x6709;&#x5E26;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;</li>
</ul>
</li>
<li>&#x8FDE;&#x63A5;&#x70B9;&#x8303;&#x56F4;&#x8981;&#x6BD4;&#x5207;&#x5165;&#x70B9;&#x8303;&#x56F4;&#x5927;&#xFF0C;&#x662F;&#x5207;&#x5165;&#x70B9;&#x7684;&#x65B9;&#x6CD5;&#x4E5F;&#x4E00;&#x5B9A;&#x662F;&#x8FDE;&#x63A5;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x662F;&#x8FDE;&#x63A5;&#x70B9;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x4E0D;&#x4E00;&#x5B9A;&#x8981;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x5207;&#x5165;&#x70B9;&#x3002;</li>
</ul>
</li>
<li>&#x901A;&#x77E5;(Advice):&#x5728;&#x5207;&#x5165;&#x70B9;&#x5904;&#x6267;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5171;&#x6027;&#x529F;&#x80FD;<ul>
<li>&#x5728;SpringAOP&#x4E2D;&#xFF0C;&#x529F;&#x80FD;&#x6700;&#x7EC8;&#x4EE5;&#x65B9;&#x6CD5;&#x7684;&#x5F62;&#x5F0F;&#x5448;&#x73B0;</li>
</ul>
</li>
<li>&#x901A;&#x77E5;&#x7C7B;&#xFF1A;&#x5B9A;&#x4E49;&#x901A;&#x77E5;&#x7684;&#x7C7B;</li>
<li>&#x5207;&#x9762;(Aspect):&#x63CF;&#x8FF0;&#x901A;&#x77E5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;&#x3002;</li>
</ul>
<p><strong>&#x5C0F;&#x7ED3;</strong></p>
<p>&#x8FD9;&#x4E00;&#x8282;&#x4E2D;&#x4E3B;&#x8981;&#x8BB2;&#x89E3;&#x4E86;AOP&#x7684;&#x6982;&#x5FF5;&#x4E0E;&#x4F5C;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;AOP&#x4E2D;&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF0C;&#x5B66;&#x5B8C;&#x4EE5;&#x540E;&#x5927;&#x5BB6;&#x9700;&#x8981;&#x80FD;&#x8BF4;&#x51FA;:</p>
<ul>
<li>&#x4EC0;&#x4E48;&#x662F;AOP?</li>
<li>AOP&#x7684;&#x4F5C;&#x7528;&#x662F;&#x4EC0;&#x4E48;?</li>
<li>AOP&#x4E2D;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#x5206;&#x522B;&#x6307;&#x7684;&#x662F;&#x4EC0;&#x4E48;?<ul>
<li>&#x8FDE;&#x63A5;&#x70B9;</li>
<li>&#x5207;&#x5165;&#x70B9;</li>
<li>&#x901A;&#x77E5;</li>
<li>&#x901A;&#x77E5;&#x7C7B;</li>
<li>&#x5207;&#x9762;</li>
</ul>
</li>
</ul>
<h2 id="2&#x3001;aop&#x5165;&#x95E8;&#x6848;&#x4F8B;">2&#x3001;AOP&#x5165;&#x95E8;&#x6848;&#x4F8B;</h2>
<h3 id="21-&#x9700;&#x6C42;&#x5206;&#x6790;">2.1 &#x9700;&#x6C42;&#x5206;&#x6790;</h3>
<p>&#x6848;&#x4F8B;&#x8BBE;&#x5B9A;&#xFF1A;&#x6D4B;&#x7B97;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x6548;&#x7387;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x7A0D;&#x5FAE;&#x590D;&#x6742;&#x4E86;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x7B80;&#x5316;&#x3002;</p>
<p>&#x7B80;&#x5316;&#x8BBE;&#x5B9A;&#xFF1A;&#x5728;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x524D;&#x8F93;&#x51FA;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;SpringAOP&#x7684;&#x5F00;&#x53D1;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;XML &#x548C; &#x6CE8;&#x89E3;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x54EA;&#x4E2A;&#x5462;?</p>
<p>&#x56E0;&#x4E3A;&#x73B0;&#x5728;&#x6CE8;&#x89E3;&#x4F7F;&#x7528;&#x7684;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x672C;&#x6B21;&#x8BFE;&#x7A0B;&#x5C31;&#x91C7;&#x7528;&#x6CE8;&#x89E3;&#x5B8C;&#x6210;AOP&#x7684;&#x5F00;&#x53D1;&#x3002;</p>
<p>&#x603B;&#x7ED3;&#x9700;&#x6C42;&#x4E3A;:&#x4F7F;&#x7528;SpringAOP&#x7684;&#x6CE8;&#x89E3;&#x65B9;&#x5F0F;&#x5B8C;&#x6210;&#x5728;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x524D;&#x6253;&#x5370;&#x51FA;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x3002;</p>
<h3 id="22-&#x601D;&#x8DEF;&#x5206;&#x6790;">2.2 &#x601D;&#x8DEF;&#x5206;&#x6790;</h3>
<p>&#x9700;&#x6C42;&#x660E;&#x786E;&#x540E;&#xFF0C;&#x5177;&#x4F53;&#x8BE5;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#xFF0C;&#x90FD;&#x6709;&#x54EA;&#x4E9B;&#x6B65;&#x9AA4;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x5206;&#x6790;&#x4E0B;:</p>
<blockquote>
<p>1.&#x5BFC;&#x5165;&#x5750;&#x6807;(pom.xml)</p>
<p>2.&#x5236;&#x4F5C;&#x8FDE;&#x63A5;&#x70B9;(&#x539F;&#x59CB;&#x64CD;&#x4F5C;&#xFF0C;Dao&#x63A5;&#x53E3;&#x4E0E;&#x5B9E;&#x73B0;&#x7C7B;)</p>
<p>3.&#x5236;&#x4F5C;&#x5171;&#x6027;&#x529F;&#x80FD;(&#x901A;&#x77E5;&#x7C7B;&#x4E0E;&#x901A;&#x77E5;)</p>
<p>4.&#x5B9A;&#x4E49;&#x5207;&#x5165;&#x70B9;</p>
<p>5.&#x7ED1;&#x5B9A;&#x5207;&#x5165;&#x70B9;&#x4E0E;&#x901A;&#x77E5;&#x5173;&#x7CFB;(&#x5207;&#x9762;)</p>
</blockquote>
<h3 id="23-&#x73AF;&#x5883;&#x51C6;&#x5907;">2.3 &#x73AF;&#x5883;&#x51C6;&#x5907;</h3>
<ul>
<li><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Maven&#x9879;&#x76EE;</p>
</li>
<li><p>pom.xml&#x6DFB;&#x52A0;Spring&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
</li>
<li><p>&#x6DFB;&#x52A0;BookDao&#x548C;BookDaoImpl&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">()</span> </span>{
        System.out.println(System.currentTimeMillis());
        System.out.println(<span class="hljs-string">&quot;book dao save ...&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;book dao update ...&quot;</span>);
    }
}
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;Spring&#x7684;&#x914D;&#x7F6E;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
</li>
<li><p>&#x7F16;&#x5199;App&#x8FD0;&#x884C;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        bookDao.save();
    }
}
</code></pre>
</li>
</ul>
<p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630167092142.png" alt="1630167092142"></p>
<p><strong>&#x8BF4;&#x660E;:</strong></p>
<ul>
<li>&#x76EE;&#x524D;&#x6253;&#x5370;save&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x56E0;&#x4E3A;&#x65B9;&#x6CD5;&#x4E2D;&#x6709;&#x6253;&#x5370;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#x662F;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;</li>
<li>&#x5BF9;&#x4E8E;update&#x65B9;&#x6CD5;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x6CA1;&#x6709;&#x8BE5;&#x529F;&#x80FD;</li>
<li>&#x6211;&#x4EEC;&#x8981;&#x4F7F;&#x7528;SpringAOP&#x7684;&#x65B9;&#x5F0F;&#x5728;&#x4E0D;&#x6539;&#x53D8;update&#x65B9;&#x6CD5;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#x8BA9;&#x5176;&#x5177;&#x6709;&#x6253;&#x5370;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x7684;&#x529F;&#x80FD;&#x3002;</li>
</ul>
<h3 id="24-aop&#x5B9E;&#x73B0;&#x6B65;&#x9AA4;">2.4 AOP&#x5B9E;&#x73B0;&#x6B65;&#x9AA4;</h3>
<h4 id="&#x6B65;&#x9AA4;1&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;">&#x6B65;&#x9AA4;1:&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;</h4>
<p>pom.xml</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="../.gitbook/assets/1630146885493.png" alt="1630146885493"></p>
<ul>
<li>&#x56E0;&#x4E3A;<code>spring-context</code>&#x4E2D;&#x5DF2;&#x7ECF;&#x5BFC;&#x5165;&#x4E86;<code>spring-aop</code>,&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x5355;&#x72EC;&#x5BFC;&#x5165;<code>spring-aop</code></li>
<li>&#x5BFC;&#x5165;AspectJ&#x7684;jar&#x5305;,AspectJ&#x662F;AOP&#x601D;&#x60F3;&#x7684;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF0C;Spring&#x6709;&#x81EA;&#x5DF1;&#x7684;AOP&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x662F;&#x76F8;&#x6BD4;&#x4E8E;AspectJ&#x6765;&#x8BF4;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x91C7;&#x7528;Spring&#x6574;&#x5408;ApsectJ&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;AOP&#x5F00;&#x53D1;&#x3002;</li>
</ul>
<h4 id="&#x6B65;&#x9AA4;2&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x4E0E;&#x5B9E;&#x73B0;&#x7C7B;">&#x6B65;&#x9AA4;2:&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x4E0E;&#x5B9E;&#x73B0;&#x7C7B;</h4>
<pre><code>&#x73AF;&#x5883;&#x51C6;&#x5907;&#x7684;&#x65F6;&#x5019;&#xFF0C;BookDaoImpl&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x505A;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;
</code></pre><h4 id="&#x6B65;&#x9AA4;3&#x5B9A;&#x4E49;&#x901A;&#x77E5;&#x7C7B;&#x548C;&#x901A;&#x77E5;">&#x6B65;&#x9AA4;3:&#x5B9A;&#x4E49;&#x901A;&#x77E5;&#x7C7B;&#x548C;&#x901A;&#x77E5;</h4>
<p>&#x901A;&#x77E5;&#x5C31;&#x662F;&#x5C06;&#x5171;&#x6027;&#x529F;&#x80FD;&#x62BD;&#x53D6;&#x51FA;&#x6765;&#x540E;&#x5F62;&#x6210;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5171;&#x6027;&#x529F;&#x80FD;&#x6307;&#x7684;&#x5C31;&#x662F;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x7684;&#x6253;&#x5370;&#x3002;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<p>&#x7C7B;&#x540D;&#x548C;&#x65B9;&#x6CD5;&#x540D;&#x6CA1;&#x6709;&#x8981;&#x6C42;&#xFF0C;&#x53EF;&#x4EE5;&#x4EFB;&#x610F;&#x3002;</p>
<h4 id="&#x6B65;&#x9AA4;4&#x5B9A;&#x4E49;&#x5207;&#x5165;&#x70B9;">&#x6B65;&#x9AA4;4:&#x5B9A;&#x4E49;&#x5207;&#x5165;&#x70B9;</h4>
<p>BookDaoImpl&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5206;&#x522B;&#x662F;save&#x548C;update&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x662F;update&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x5982;&#x4F55;&#x5B9A;&#x4E49;&#x5462;?</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<p><strong>&#x8BF4;&#x660E;:</strong></p>
<ul>
<li>&#x5207;&#x5165;&#x70B9;&#x5B9A;&#x4E49;&#x4F9D;&#x6258;&#x4E00;&#x4E2A;&#x4E0D;&#x5177;&#x6709;&#x5B9E;&#x9645;&#x610F;&#x4E49;&#x7684;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#xFF0C;&#x5373;&#x65E0;&#x53C2;&#x6570;&#x3001;&#x65E0;&#x8FD4;&#x56DE;&#x503C;&#x3001;&#x65B9;&#x6CD5;&#x4F53;&#x65E0;&#x5B9E;&#x9645;&#x903B;&#x8F91;&#x3002;</li>
<li>execution&#x53CA;&#x540E;&#x9762;&#x7F16;&#x5199;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x6709;&#x7AE0;&#x8282;&#x4E13;&#x95E8;&#x53BB;&#x5B66;&#x4E60;&#x3002;</li>
</ul>
<h4 id="&#x6B65;&#x9AA4;5&#x5236;&#x4F5C;&#x5207;&#x9762;">&#x6B65;&#x9AA4;5:&#x5236;&#x4F5C;&#x5207;&#x9762;</h4>
<p>&#x5207;&#x9762;&#x662F;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x901A;&#x77E5;&#x548C;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x5982;&#x4F55;&#x8FDB;&#x884C;&#x5173;&#x7CFB;&#x7684;&#x7ED1;&#x5B9A;?</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<p>&#x7ED1;&#x5B9A;&#x5207;&#x5165;&#x70B9;&#x4E0E;&#x901A;&#x77E5;&#x5173;&#x7CFB;&#xFF0C;&#x5E76;&#x6307;&#x5B9A;&#x901A;&#x77E5;&#x6DFB;&#x52A0;&#x5230;&#x539F;&#x59CB;&#x8FDE;&#x63A5;&#x70B9;&#x7684;&#x5177;&#x4F53;&#x6267;&#x884C;==&#x4F4D;&#x7F6E;==</p>
<p><img src="../.gitbook/assets/1630148447689.png" alt="1630148447689"></p>
<p><strong>&#x8BF4;&#x660E;:</strong>@Before&#x7FFB;&#x8BD1;&#x8FC7;&#x6765;&#x662F;&#x4E4B;&#x524D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x901A;&#x77E5;&#x4F1A;&#x5728;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x6267;&#x884C;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x524D;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x56DB;&#x79CD;&#x7C7B;&#x578B;&#xFF0C;&#x540E;&#x9762;&#x4F1A;&#x8BB2;&#x3002;</p>
<h4 id="&#x6B65;&#x9AA4;6&#x5C06;&#x901A;&#x77E5;&#x7C7B;&#x914D;&#x7ED9;&#x5BB9;&#x5668;&#x5E76;&#x6807;&#x8BC6;&#x5176;&#x4E3A;&#x5207;&#x9762;&#x7C7B;">&#x6B65;&#x9AA4;6:&#x5C06;&#x901A;&#x77E5;&#x7C7B;&#x914D;&#x7ED9;&#x5BB9;&#x5668;&#x5E76;&#x6807;&#x8BC6;&#x5176;&#x4E3A;&#x5207;&#x9762;&#x7C7B;</h4>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<h4 id="&#x6B65;&#x9AA4;7&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x683C;&#x5F0F;aop&#x529F;&#x80FD;">&#x6B65;&#x9AA4;7:&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x683C;&#x5F0F;AOP&#x529F;&#x80FD;</h4>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@EnableAspectJAutoProxy</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
<h4 id="&#x6B65;&#x9AA4;8&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;">&#x6B65;&#x9AA4;8:&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;</h4>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        bookDao.update();
    }
}
</code></pre>
<p>&#x770B;&#x5230;&#x5728;&#x6267;&#x884C;update&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#x6253;&#x5370;&#x4E86;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x8BF4;&#x660E;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x4E86;&#x589E;&#x5F3A;&#xFF0C;AOP&#x7F16;&#x7A0B;&#x6210;&#x529F;&#x3002;</p>
<p><img src="../.gitbook/assets/1630147945888.png" alt="1630147945888"></p>
<h3 id="&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;enableaspectjautoproxy">&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;@EnableAspectJAutoProxy</h3>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@EnableAspectJAutoProxy</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x914D;&#x7F6E;&#x7C7B;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x914D;&#x7F6E;&#x7C7B;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x683C;&#x5F0F;AOP&#x529F;&#x80FD;</td>
</tr>
</tbody>
</table>
<h3 id="&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;aspect">&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;@Aspect</h3>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@Aspect</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x7C7B;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x5207;&#x9762;&#x7C7B;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x7C7B;&#x4E3A;AOP&#x5207;&#x9762;&#x7C7B;</td>
</tr>
</tbody>
</table>
<h3 id="&#x77E5;&#x8BC6;&#x70B9;3&#xFF1A;pointcut">&#x77E5;&#x8BC6;&#x70B9;3&#xFF1A;@Pointcut</h3>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@Pointcut</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;</td>
</tr>
<tr>
<td>&#x5C5E;&#x6027;</td>
<td>value&#xFF08;&#x9ED8;&#x8BA4;&#xFF09;&#xFF1A;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;</td>
</tr>
</tbody>
</table>
<h3 id="&#x77E5;&#x8BC6;&#x70B9;4&#xFF1A;before">&#x77E5;&#x8BC6;&#x70B9;4&#xFF1A;@Before</h3>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@Before</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5728;&#x539F;&#x59CB;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x524D;&#x8FD0;&#x884C;</td>
</tr>
</tbody>
</table>
<h2 id="3&#x3001;aop&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;">3&#x3001;AOP&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</h2>
<p>AOP&#x7684;&#x5165;&#x95E8;&#x6848;&#x4F8B;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#xFF0C;&#x5BF9;&#x4E8E;&#x521A;&#x624D;&#x6848;&#x4F8B;&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5F97;&#x6765;&#x5206;&#x6790;&#x5206;&#x6790;&#xFF0C;&#x8FD9;&#x4E00;&#x8282;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x8BB2;&#x89E3;&#x4E24;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;:<code>AOP&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</code>&#x548C;<code>AOP&#x6838;&#x5FC3;&#x6982;&#x5FF5;</code>&#x3002;&#x5176;&#x4E2D;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#x662F;&#x5BF9;&#x524D;&#x9762;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#x7684;&#x8865;&#x5145;&#x3002;</p>
<h3 id="31-aop&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;">3.1 AOP&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</h3>
<p>&#x7531;&#x4E8E;AOP&#x662F;&#x57FA;&#x4E8E;Spring&#x5BB9;&#x5668;&#x7BA1;&#x7406;&#x7684;bean&#x505A;&#x7684;&#x589E;&#x5F3A;&#xFF0C;&#x6240;&#x4EE5;&#x6574;&#x4E2A;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;&#x9700;&#x8981;&#x4ECE;Spring&#x52A0;&#x8F7D;bean&#x8BF4;&#x8D77;:</p>
<h4 id="&#x6D41;&#x7A0B;1spring&#x5BB9;&#x5668;&#x542F;&#x52A8;">&#x6D41;&#x7A0B;1:Spring&#x5BB9;&#x5668;&#x542F;&#x52A8;</h4>
<ul>
<li>&#x5BB9;&#x5668;&#x542F;&#x52A8;&#x5C31;&#x9700;&#x8981;&#x53BB;&#x52A0;&#x8F7D;bean,&#x54EA;&#x4E9B;&#x7C7B;&#x9700;&#x8981;&#x88AB;&#x52A0;&#x8F7D;&#x5462;?</li>
<li>&#x9700;&#x8981;&#x88AB;&#x589E;&#x5F3A;&#x7684;&#x7C7B;&#xFF0C;&#x5982;:BookServiceImpl</li>
<li>&#x901A;&#x77E5;&#x7C7B;&#xFF0C;&#x5982;:MyAdvice</li>
<li>&#x6CE8;&#x610F;&#x6B64;&#x65F6;bean&#x5BF9;&#x8C61;&#x8FD8;&#x6CA1;&#x6709;&#x521B;&#x5EFA;&#x6210;&#x529F;</li>
</ul>
<h4 id="&#x6D41;&#x7A0B;2&#x8BFB;&#x53D6;&#x6240;&#x6709;&#x5207;&#x9762;&#x914D;&#x7F6E;&#x4E2D;&#x7684;&#x5207;&#x5165;&#x70B9;">&#x6D41;&#x7A0B;2:&#x8BFB;&#x53D6;&#x6240;&#x6709;&#x5207;&#x9762;&#x914D;&#x7F6E;&#x4E2D;&#x7684;&#x5207;&#x5165;&#x70B9;</h4>
<p><img src="../.gitbook/assets/1630151682428.png" alt="1630151682428"></p>
<ul>
<li>&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x5207;&#x5165;&#x70B9;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x4F46;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;<code>ptx()</code>&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x4F1A;&#x88AB;&#x8BFB;&#x53D6;&#x3002;</li>
</ul>
<h4 id="&#x6D41;&#x7A0B;3&#x521D;&#x59CB;&#x5316;bean&#xFF0C;">&#x6D41;&#x7A0B;3:&#x521D;&#x59CB;&#x5316;bean&#xFF0C;</h4>
<p>&#x5224;&#x5B9A;bean&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x5339;&#x914D;&#x5230;&#x4EFB;&#x610F;&#x5207;&#x5165;&#x70B9;</p>
<ul>
<li><p>&#x6CE8;&#x610F;&#x7B2C;1&#x6B65;&#x5728;&#x5BB9;&#x5668;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#xFF0C;bean&#x5BF9;&#x8C61;&#x8FD8;&#x6CA1;&#x6709;&#x88AB;&#x521B;&#x5EFA;&#x6210;&#x529F;&#x3002;</p>
</li>
<li><p>&#x8981;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;bean&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x5207;&#x5165;&#x70B9;&#x8FDB;&#x884C;&#x5339;&#x914D;</p>
<p><img src="../.gitbook/assets/1630152538083.png" alt="1630152538083"></p>
<ul>
<li>&#x5339;&#x914D;&#x5931;&#x8D25;&#xFF0C;&#x521B;&#x5EFA;&#x539F;&#x59CB;&#x5BF9;&#x8C61;,&#x5982;<code>UserDao</code><ul>
<li>&#x5339;&#x914D;&#x5931;&#x8D25;&#x8BF4;&#x660E;&#x4E0D;&#x9700;&#x8981;&#x589E;&#x5F3A;&#xFF0C;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x3002;</li>
</ul>
</li>
<li>&#x5339;&#x914D;&#x6210;&#x529F;&#xFF0C;&#x521B;&#x5EFA;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#xFF08;<code>&#x76EE;&#x6807;&#x5BF9;&#x8C61;</code>&#xFF09;&#x7684;<code>&#x4EE3;&#x7406;</code>&#x5BF9;&#x8C61;,&#x5982;:<code>BookDao</code><ul>
<li>&#x5339;&#x914D;&#x6210;&#x529F;&#x8BF4;&#x660E;&#x9700;&#x8981;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x589E;&#x5F3A;</li>
<li>&#x5BF9;&#x54EA;&#x4E2A;&#x7C7B;&#x505A;&#x589E;&#x5F3A;&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#x5C31;&#x53EB;&#x505A;&#x76EE;&#x6807;&#x5BF9;&#x8C61;</li>
<li>&#x56E0;&#x4E3A;&#x8981;&#x5BF9;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x529F;&#x80FD;&#x589E;&#x5F3A;&#xFF0C;&#x800C;&#x91C7;&#x7528;&#x7684;&#x6280;&#x672F;&#x662F;&#x52A8;&#x6001;&#x4EE3;&#x7406;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x4E3A;&#x5176;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;</li>
<li>&#x6700;&#x7EC8;&#x8FD0;&#x884C;&#x7684;&#x662F;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x8BE5;&#x65B9;&#x6CD5;&#x4E2D;&#x4F1A;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x529F;&#x80FD;&#x589E;&#x5F3A;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="&#x6D41;&#x7A0B;4&#x83B7;&#x53D6;bean&#x6267;&#x884C;&#x65B9;&#x6CD5;">&#x6D41;&#x7A0B;4:&#x83B7;&#x53D6;bean&#x6267;&#x884C;&#x65B9;&#x6CD5;</h4>
<ul>
<li>&#x83B7;&#x53D6;&#x7684;bean&#x662F;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x5E76;&#x6267;&#x884C;&#xFF0C;&#x5B8C;&#x6210;&#x64CD;&#x4F5C;</li>
<li>&#x83B7;&#x53D6;&#x7684;bean&#x662F;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x6839;&#x636E;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x7684;&#x8FD0;&#x884C;&#x6A21;&#x5F0F;&#x8FD0;&#x884C;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x4E0E;&#x589E;&#x5F3A;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5B8C;&#x6210;&#x64CD;&#x4F5C;</li>
</ul>
<h4 id="&#x9A8C;&#x8BC1;&#x5BB9;&#x5668;&#x4E2D;&#x662F;&#x5426;&#x4E3A;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;">&#x9A8C;&#x8BC1;&#x5BB9;&#x5668;&#x4E2D;&#x662F;&#x5426;&#x4E3A;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;</h4>
<p>&#x4E3A;&#x4E86;&#x9A8C;&#x8BC1;IOC&#x5BB9;&#x5668;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x548C;&#x6211;&#x4EEC;&#x521A;&#x624D;&#x6240;&#x8BF4;&#x7684;&#x7ED3;&#x8BBA;&#x662F;&#x5426;&#x4E00;&#x81F4;&#xFF0C;&#x9996;&#x5148;&#x5148;&#x628A;&#x7ED3;&#x8BBA;&#x7406;&#x51FA;&#x6765;:</p>
<ul>
<li>&#x5982;&#x679C;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x4F1A;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;&#x90A3;&#x4E48;&#x5BB9;&#x5668;&#x4E2D;&#x5C06;&#x5B58;&#x5165;&#x7684;&#x662F;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;</li>
<li>&#x5982;&#x679C;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;&#x90A3;&#x4E48;&#x5BB9;&#x5668;&#x4E2D;&#x5C06;&#x5B58;&#x5165;&#x7684;&#x662F;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x3002;</li>
</ul>
<h5 id="&#x9A8C;&#x8BC1;&#x601D;&#x8DEF;">&#x9A8C;&#x8BC1;&#x601D;&#x8DEF;</h5>
<blockquote>
<p>1.&#x8981;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x88AB;&#x5B9A;&#x4E49;&#x7684;&#x5207;&#x5165;&#x70B9;&#x5305;&#x542B;&#xFF0C;&#x5373;&#x4E0D;&#x8981;&#x589E;&#x5F3A;&#xFF0C;&#x6253;&#x5370;&#x5F53;&#x524D;&#x7C7B;&#x7684;getClass()&#x65B9;&#x6CD5;</p>
<p>2.&#x8981;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x88AB;&#x5B9A;&#x4E49;&#x7684;&#x5207;&#x5165;&#x70B9;&#x5305;&#x542B;&#xFF0C;&#x5373;&#x8981;&#x589E;&#x5F3A;&#xFF0C;&#x6253;&#x5370;&#x51FA;&#x5F53;&#x524D;&#x7C7B;&#x7684;getClass()&#x65B9;&#x6CD5;</p>
<p>3.&#x89C2;&#x5BDF;&#x4E24;&#x6B21;&#x6253;&#x5370;&#x7684;&#x7ED3;&#x679C;</p>
</blockquote>
<h5 id="&#x6B65;&#x9AA4;1&#x4FEE;&#x6539;app&#x7C7B;&#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x7C7B;&#x578B;">&#x6B65;&#x9AA4;1:&#x4FEE;&#x6539;App&#x7C7B;,&#x83B7;&#x53D6;&#x7C7B;&#x7684;&#x7C7B;&#x578B;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        System.out.println(bookDao);
        System.out.println(bookDao.getClass());
    }
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;2&#x4FEE;&#x6539;myadvice&#x7C7B;&#xFF0C;&#x4E0D;&#x589E;&#x5F3A;">&#x6B65;&#x9AA4;2:&#x4FEE;&#x6539;MyAdvice&#x7C7B;&#xFF0C;&#x4E0D;&#x589E;&#x5F3A;</h5>
<p>&#x56E0;&#x4E3A;&#x5B9A;&#x4E49;&#x7684;&#x5207;&#x5165;&#x70B9;&#x4E2D;&#xFF0C;&#x88AB;&#x4FEE;&#x6539;&#x6210;<code>update1</code>,&#x6240;&#x4EE5;BookDao&#x4E2D;&#x7684;update&#x65B9;&#x6CD5;&#x5728;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4E0D;&#x4F1A;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;</p>
<p>&#x6240;&#x4EE5;&#x5BB9;&#x5668;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x662F;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x3002;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update1())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;3&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;">&#x6B65;&#x9AA4;3:&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;</h5>
<p><img src="../.gitbook/assets/1630154495165.png" alt="1630154495165"></p>
<h5 id="&#x6B65;&#x9AA4;4&#x4FEE;&#x6539;myadvice&#x7C7B;&#xFF0C;&#x589E;&#x5F3A;">&#x6B65;&#x9AA4;4:&#x4FEE;&#x6539;MyAdvice&#x7C7B;&#xFF0C;&#x589E;&#x5F3A;</h5>
<p>&#x56E0;&#x4E3A;&#x5B9A;&#x4E49;&#x7684;&#x5207;&#x5165;&#x70B9;&#x4E2D;&#xFF0C;&#x88AB;&#x4FEE;&#x6539;&#x6210;<code>update</code>,&#x6240;&#x4EE5;BookDao&#x4E2D;&#x7684;update&#x65B9;&#x6CD5;&#x5728;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x4F1A;&#x88AB;&#x589E;&#x5F3A;&#xFF0C;</p>
<p>&#x6240;&#x4EE5;&#x5BB9;&#x5668;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x5E94;&#x8BE5;&#x662F;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method</span><span class="hljs-params">()</span></span>{
        System.out.println(System.currentTimeMillis());
    }
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;5&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;">&#x6B65;&#x9AA4;5:&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;</h5>
<p><img src="../.gitbook/assets/1630154625564.png" alt="1630154625564"></p>
<p>&#x81F3;&#x6B64;&#x5BF9;&#x4E8E;&#x521A;&#x624D;&#x7684;&#x7ED3;&#x8BBA;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x9A8C;&#x8BC1;&#xFF0C;&#x8FD9;&#x5757;&#x5927;&#x5BB6;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;:</p>
<p>&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x6253;&#x5370;&#x5BF9;&#x8C61;&#xFF0C;&#x4ECE;&#x4E0A;&#x9762;&#x4E24;&#x6B21;&#x7ED3;&#x679C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x76F4;&#x63A5;&#x6253;&#x5370;&#x5BF9;&#x8C61;&#x8D70;&#x7684;&#x662F;&#x5BF9;&#x8C61;&#x7684;toString&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x4E0D;&#x662F;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x6253;&#x5370;&#x7684;&#x7ED3;&#x679C;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x5185;&#x90E8;&#x5BF9;toString&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x4E86;&#x91CD;&#x5199;&#x3002;</p>
<h3 id="32-aop&#x6838;&#x5FC3;&#x6982;&#x5FF5;">3.2 AOP&#x6838;&#x5FC3;&#x6982;&#x5FF5;</h3>
<p>&#x5728;&#x4E0A;&#x9762;&#x4ECB;&#x7ECD;AOP&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x63D0;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x6838;&#x5FC3;&#x6982;&#x5FF5;&#xFF0C;&#x5206;&#x522B;&#x662F;:</p>
<ul>
<li>&#x76EE;&#x6807;&#x5BF9;&#x8C61;(Target)&#xFF1A;&#x539F;&#x59CB;&#x529F;&#x80FD;&#x53BB;&#x6389;&#x5171;&#x6027;&#x529F;&#x80FD;&#x5BF9;&#x5E94;&#x7684;&#x7C7B;&#x4EA7;&#x751F;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x79CD;&#x5BF9;&#x8C61;&#x662F;&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x5B8C;&#x6210;&#x6700;&#x7EC8;&#x5DE5;&#x4F5C;&#x7684;</li>
<li>&#x4EE3;&#x7406;(Proxy)&#xFF1A;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x5B8C;&#x6210;&#x5DE5;&#x4F5C;&#xFF0C;&#x9700;&#x8981;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x529F;&#x80FD;&#x56DE;&#x586B;&#xFF0C;&#x901A;&#x8FC7;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x7684;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x5B9E;&#x73B0;</li>
</ul>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#x6BD4;&#x8F83;&#x62BD;&#x8C61;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;</p>
<p>&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x7C7B;[&#x5982;:BookServiceImpl&#x7C7B;]&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4E5F;&#x53EB;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x80FD;&#x8BF4;&#x5B83;&#x4E0D;&#x80FD;&#x8FD0;&#x884C;&#xFF0C;&#x53EA;&#x80FD;&#x8BF4;&#x5B83;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x5BF9;&#x4E8E;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x7F3A;&#x5931;&#x7684;&#x3002;</p>
<p>SpringAOP&#x662F;&#x5728;&#x4E0D;&#x6539;&#x53D8;&#x539F;&#x6709;&#x8BBE;&#x8BA1;(&#x4EE3;&#x7801;)&#x7684;&#x524D;&#x63D0;&#x4E0B;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#x7684;&#xFF0C;&#x5B83;&#x7684;&#x5E95;&#x5C42;&#x91C7;&#x7528;&#x7684;&#x662F;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x5BF9;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x5BF9;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x4EE3;&#x7406;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x628A;&#x901A;&#x77E5;[&#x5982;:MyAdvice&#x4E2D;&#x7684;method&#x65B9;&#x6CD5;]&#x5185;&#x5BB9;&#x52A0;&#x8FDB;&#x53BB;&#xFF0C;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x589E;&#x5F3A;,&#x8FD9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x6240;&#x8BF4;&#x7684;&#x4EE3;&#x7406;(Proxy)&#x3002;</p>
<p><strong>&#x5C0F;&#x7ED3;</strong></p>
<p>&#x901A;&#x8FC7;&#x8FD9;&#x4E00;&#x8282;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x638C;&#x63E1;&#x7684;&#x5185;&#x5BB9;&#x6709;&#xFF1A;</p>
<ul>
<li>&#x80FD;&#x8BF4;&#x51FA;AOP&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;</li>
<li>AOP&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;<ul>
<li>&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x3001;&#x8FDE;&#x63A5;&#x70B9;&#x3001;&#x5207;&#x5165;&#x70B9;</li>
<li>&#x901A;&#x77E5;&#x7C7B;&#x3001;&#x901A;&#x77E5;</li>
<li>&#x5207;&#x9762;</li>
<li>&#x4EE3;&#x7406;</li>
</ul>
</li>
<li>SpringAOP&#x7684;&#x672C;&#x8D28;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x8BF4;&#x5E95;&#x5C42;&#x5B9E;&#x73B0;&#x662F;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x3002;</li>
</ul>
<h2 id="4&#x3001;aop&#x914D;&#x7F6E;&#x7BA1;&#x7406;">4&#x3001;AOP&#x914D;&#x7F6E;&#x7BA1;&#x7406;</h2>
<h3 id="41-aop&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;">4.1 AOP&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;</h3>
<p>&#x524D;&#x9762;&#x7684;&#x6848;&#x4F8B;&#x4E2D;&#xFF0C;&#x6709;&#x6D89;&#x53CA;&#x5230;&#x5982;&#x4E0B;&#x5185;&#x5BB9;:</p>
<p><img src="../.gitbook/assets/1630155937718.png" alt="1630155937718"></p>
<p>&#x5BF9;&#x4E8E;AOP&#x4E2D;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x5171;&#x4F1A;&#x5B66;&#x4E60;&#x4E09;&#x4E2A;&#x5185;&#x5BB9;&#xFF0C;&#x5206;&#x522B;&#x662F;<code>&#x8BED;&#x6CD5;&#x683C;&#x5F0F;</code>&#x3001;<code>&#x901A;&#x914D;&#x7B26;</code>&#x548C;<code>&#x4E66;&#x5199;&#x6280;&#x5DE7;</code>&#x3002;</p>
<h4 id="411-&#x8BED;&#x6CD5;&#x683C;&#x5F0F;">4.1.1 &#x8BED;&#x6CD5;&#x683C;&#x5F0F;</h4>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x5148;&#x8981;&#x660E;&#x786E;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;:</p>
<ul>
<li>&#x5207;&#x5165;&#x70B9;:&#x8981;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#x7684;&#x65B9;&#x6CD5;</li>
<li>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;:&#x8981;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x5207;&#x5165;&#x70B9;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x6211;&#x4EEC;&#x5176;&#x5B9E;&#x662F;&#x6709;&#x4E24;&#x4E2D;&#x65B9;&#x5F0F;&#x7684;&#xFF0C;&#x5148;&#x6765;&#x770B;&#x4E0B;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;</p>
<p><img src="../.gitbook/assets/1630156172790.png" alt="1630156172790"></p>
<p>&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;&#x4E00;&#xFF1A;&#x6267;&#x884C;com.itheima.dao&#x5305;&#x4E0B;&#x7684;BookDao&#x63A5;&#x53E3;&#x4E2D;&#x7684;&#x65E0;&#x53C2;&#x6570;update&#x65B9;&#x6CD5;</p>
<pre><code class="lang-java">execution(<span class="hljs-keyword">void</span> com.itheima.dao.BookDao.update())
</code></pre>
<p>&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;&#x4E8C;&#xFF1A;&#x6267;&#x884C;com.itheima.dao.impl&#x5305;&#x4E0B;&#x7684;BookDaoImpl&#x7C7B;&#x4E2D;&#x7684;&#x65E0;&#x53C2;&#x6570;update&#x65B9;&#x6CD5;</p>
<pre><code>execution(void com.itheima.dao.impl.BookDaoImpl.update())
</code></pre><p>&#x56E0;&#x4E3A;&#x8C03;&#x7528;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x6700;&#x7EC8;&#x8FD0;&#x884C;&#x7684;&#x8FD8;&#x662F;&#x5176;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x4E0A;&#x9762;&#x4E24;&#x79CD;&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;&#x90FD;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8BED;&#x6CD5;&#x4E3A;:</p>
<ul>
<li>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#xFF1A;&#x52A8;&#x4F5C;&#x5173;&#x952E;&#x5B57;(&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;  &#x8FD4;&#x56DE;&#x503C;  &#x5305;&#x540D;.&#x7C7B;/&#x63A5;&#x53E3;&#x540D;.&#x65B9;&#x6CD5;&#x540D;(&#x53C2;&#x6570;) &#x5F02;&#x5E38;&#x540D;&#xFF09;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x786C;&#x8BB0;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x7406;&#x89E3;&#x5B83;:</p>
<pre><code>execution(public User com.itheima.service.UserService.findById(int))
</code></pre><ul>
<li>execution&#xFF1A;&#x52A8;&#x4F5C;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x63CF;&#x8FF0;&#x5207;&#x5165;&#x70B9;&#x7684;&#x884C;&#x4E3A;&#x52A8;&#x4F5C;&#xFF0C;&#x4F8B;&#x5982;execution&#x8868;&#x793A;&#x6267;&#x884C;&#x5230;&#x6307;&#x5B9A;&#x5207;&#x5165;&#x70B9;</li>
<li>public:&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;,&#x8FD8;&#x53EF;&#x4EE5;&#x662F;public&#xFF0C;private&#x7B49;&#xFF0C;&#x53EF;&#x4EE5;&#x7701;&#x7565;</li>
<li>User&#xFF1A;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x5199;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;</li>
<li>com.itheima.service&#xFF1A;&#x5305;&#x540D;&#xFF0C;&#x591A;&#x7EA7;&#x5305;&#x4F7F;&#x7528;&#x70B9;&#x8FDE;&#x63A5;</li>
<li>UserService:&#x7C7B;/&#x63A5;&#x53E3;&#x540D;&#x79F0;</li>
<li>findById&#xFF1A;&#x65B9;&#x6CD5;&#x540D;</li>
<li>int:&#x53C2;&#x6570;&#xFF0C;&#x76F4;&#x63A5;&#x5199;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x591A;&#x4E2A;&#x7C7B;&#x578B;&#x7528;&#x9017;&#x53F7;&#x9694;&#x5F00;</li>
<li>&#x5F02;&#x5E38;&#x540D;&#xFF1A;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E2D;&#x629B;&#x51FA;&#x6307;&#x5B9A;&#x5F02;&#x5E38;&#xFF0C;&#x53EF;&#x4EE5;&#x7701;&#x7565;</li>
</ul>
<p>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x5C31;&#x662F;&#x8981;&#x627E;&#x5230;&#x9700;&#x8981;&#x589E;&#x5F3A;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x5C31;&#x662F;&#x5BF9;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x4F46;&#x662F;&#x65B9;&#x6CD5;&#x7684;&#x5B9A;&#x4E49;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6BCF;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x60F3;&#x60F3;&#x8FD9;&#x5757;&#x5C31;&#x4F1A;&#x89C9;&#x5F97;&#x5C06;&#x6765;&#x7F16;&#x5199;&#x8D77;&#x6765;&#x4F1A;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#xFF0C;&#x6709;&#x6CA1;&#x6709;&#x66F4;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;&#x5462;?</p>
<p>&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x4E0B;&#x9762;&#x6240;&#x5B66;&#x4E60;&#x7684;&#x901A;&#x914D;&#x7B26;&#x3002;</p>
<h4 id="412-&#x901A;&#x914D;&#x7B26;">4.1.2 &#x901A;&#x914D;&#x7B26;</h4>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;&#x63CF;&#x8FF0;&#x5207;&#x5165;&#x70B9;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x7B80;&#x5316;&#x4E4B;&#x524D;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x5177;&#x4F53;&#x90FD;&#x6709;&#x54EA;&#x4E9B;&#x901A;&#x914D;&#x7B26;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;?</p>
<ul>
<li><p><code>*</code>:&#x5355;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x4EFB;&#x610F;&#x7B26;&#x53F7;&#xFF0C;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x51FA;&#x73B0;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x524D;&#x7F00;&#x6216;&#x8005;&#x540E;&#x7F00;&#x7684;&#x5339;&#x914D;&#x7B26;&#x51FA;&#x73B0;</p>
<pre><code>execution&#xFF08;public * com.itheima.*.UserService.find*(*))
</code></pre><p>&#x5339;&#x914D;com.itheima&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x5305;&#x4E2D;&#x7684;UserService&#x7C7B;&#x6216;&#x63A5;&#x53E3;&#x4E2D;&#x6240;&#x6709;find&#x5F00;&#x5934;&#x7684;&#x5E26;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;</p>
</li>
<li><p><code>..</code>&#xFF1A;&#x591A;&#x4E2A;&#x8FDE;&#x7EED;&#x7684;&#x4EFB;&#x610F;&#x7B26;&#x53F7;&#xFF0C;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x51FA;&#x73B0;&#xFF0C;&#x5E38;&#x7528;&#x4E8E;&#x7B80;&#x5316;&#x5305;&#x540D;&#x4E0E;&#x53C2;&#x6570;&#x7684;&#x4E66;&#x5199;</p>
<pre><code>execution&#xFF08;public User com..UserService.findById(..))
</code></pre><p>&#x5339;&#x914D;com&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x5305;&#x4E2D;&#x7684;UserService&#x7C7B;&#x6216;&#x63A5;&#x53E3;&#x4E2D;&#x6240;&#x6709;&#x540D;&#x79F0;&#x4E3A;findById&#x7684;&#x65B9;&#x6CD5;</p>
</li>
<li><p><code>+</code>&#xFF1A;&#x4E13;&#x7528;&#x4E8E;&#x5339;&#x914D;&#x5B50;&#x7C7B;&#x7C7B;&#x578B;</p>
<pre><code>execution(* *..*Service+.*(..))
</code></pre><p>&#x8FD9;&#x4E2A;&#x4F7F;&#x7528;&#x7387;&#x8F83;&#x4F4E;&#xFF0C;&#x63CF;&#x8FF0;&#x5B50;&#x7C7B;&#x7684;&#xFF0C;&#x54B1;&#x4EEC;&#x505A;JavaEE&#x5F00;&#x53D1;&#xFF0C;&#x7EE7;&#x627F;&#x673A;&#x4F1A;&#x5C31;&#x4E00;&#x6B21;&#xFF0C;&#x4F7F;&#x7528;&#x90FD;&#x5F88;&#x614E;&#x91CD;&#xFF0C;&#x6240;&#x4EE5;&#x5F88;&#x5C11;&#x7528;&#x5B83;&#x3002;*Service+&#xFF0C;&#x8868;&#x793A;&#x6240;&#x6709;&#x4EE5;Service&#x7ED3;&#x5C3E;&#x7684;&#x63A5;&#x53E3;&#x7684;&#x5B50;&#x7C7B;&#x3002;</p>
</li>
</ul>
<p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x6848;&#x4F8B;&#x4E2D;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x6765;&#x5206;&#x6790;&#x4E0B;:</p>
<p><img src="assets/1630163744963.png" alt="1630163744963"></p>
<pre><code class="lang-java">execution(<span class="hljs-keyword">void</span> com.itheima.dao.BookDao.update())
&#x5339;&#x914D;&#x63A5;&#x53E3;&#xFF0C;&#x80FD;&#x5339;&#x914D;&#x5230;
execution(<span class="hljs-keyword">void</span> com.itheima.dao.impl.BookDaoImpl.update())
&#x5339;&#x914D;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x80FD;&#x5339;&#x914D;&#x5230;
execution(* com.itheima.dao.impl.BookDaoImpl.update())
&#x8FD4;&#x56DE;&#x503C;&#x4EFB;&#x610F;&#xFF0C;&#x80FD;&#x5339;&#x914D;&#x5230;
execution(* com.itheima.dao.impl.BookDaoImpl.update(*))
&#x8FD4;&#x56DE;&#x503C;&#x4EFB;&#x610F;&#xFF0C;&#x4F46;&#x662F;update&#x65B9;&#x6CD5;&#x5FC5;&#x987B;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x65E0;&#x6CD5;&#x5339;&#x914D;&#xFF0C;&#x8981;&#x60F3;&#x5339;&#x914D;&#x9700;&#x8981;&#x5728;update&#x63A5;&#x53E3;&#x548C;&#x5B9E;&#x73B0;&#x7C7B;&#x6DFB;&#x52A0;&#x53C2;&#x6570;
execution(<span class="hljs-keyword">void</span> com.*.*.*.*.update())
&#x8FD4;&#x56DE;&#x503C;&#x4E3A;<span class="hljs-keyword">void</span>,com&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x5305;&#x4E09;&#x5C42;&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x7C7B;&#x7684;update&#x65B9;&#x6CD5;&#xFF0C;&#x5339;&#x914D;&#x5230;&#x7684;&#x662F;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x80FD;&#x5339;&#x914D;
execution(<span class="hljs-keyword">void</span> com.*.*.*.update())
&#x8FD4;&#x56DE;&#x503C;&#x4E3A;<span class="hljs-keyword">void</span>,com&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x4E24;&#x5C42;&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x7C7B;&#x7684;update&#x65B9;&#x6CD5;&#xFF0C;&#x5339;&#x914D;&#x5230;&#x7684;&#x662F;&#x63A5;&#x53E3;&#xFF0C;&#x80FD;&#x5339;&#x914D;
execution(<span class="hljs-keyword">void</span> *..update())
&#x8FD4;&#x56DE;&#x503C;&#x4E3A;<span class="hljs-keyword">void</span>&#xFF0C;&#x65B9;&#x6CD5;&#x540D;&#x662F;update&#x7684;&#x4EFB;&#x610F;&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x7C7B;&#xFF0C;&#x80FD;&#x5339;&#x914D;
execution(* *..*(..))
&#x5339;&#x914D;&#x9879;&#x76EE;&#x4E2D;&#x4EFB;&#x610F;&#x7C7B;&#x7684;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#xFF0C;&#x80FD;&#x5339;&#x914D;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#x5E7F;
execution(* *..u*(..))
&#x5339;&#x914D;&#x9879;&#x76EE;&#x4E2D;&#x4EFB;&#x610F;&#x5305;&#x4EFB;&#x610F;&#x7C7B;&#x4E0B;&#x53EA;&#x8981;&#x4EE5;u&#x5F00;&#x5934;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;update&#x65B9;&#x6CD5;&#x80FD;&#x6EE1;&#x8DB3;&#xFF0C;&#x80FD;&#x5339;&#x914D;
execution(* *..*e(..))
&#x5339;&#x914D;&#x9879;&#x76EE;&#x4E2D;&#x4EFB;&#x610F;&#x5305;&#x4EFB;&#x610F;&#x7C7B;&#x4E0B;&#x53EA;&#x8981;&#x4EE5;e&#x7ED3;&#x5C3E;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;update&#x548C;save&#x65B9;&#x6CD5;&#x80FD;&#x6EE1;&#x8DB3;&#xFF0C;&#x80FD;&#x5339;&#x914D;
execution(<span class="hljs-keyword">void</span> com..*())
&#x8FD4;&#x56DE;&#x503C;&#x4E3A;<span class="hljs-keyword">void</span>&#xFF0C;com&#x5305;&#x4E0B;&#x7684;&#x4EFB;&#x610F;&#x5305;&#x4EFB;&#x610F;&#x7C7B;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#xFF0C;&#x80FD;&#x5339;&#x914D;&#xFF0C;*&#x4EE3;&#x8868;&#x7684;&#x662F;&#x65B9;&#x6CD5;
execution(* com.itheima.*.*Service.find*(..))
&#x5C06;&#x9879;&#x76EE;&#x4E2D;&#x6240;&#x6709;&#x4E1A;&#x52A1;&#x5C42;&#x65B9;&#x6CD5;&#x7684;&#x4EE5;find&#x5F00;&#x5934;&#x7684;&#x65B9;&#x6CD5;&#x5339;&#x914D;
execution(* com.itheima.*.*Service.save*(..))
&#x5C06;&#x9879;&#x76EE;&#x4E2D;&#x6240;&#x6709;&#x4E1A;&#x52A1;&#x5C42;&#x65B9;&#x6CD5;&#x7684;&#x4EE5;save&#x5F00;&#x5934;&#x7684;&#x65B9;&#x6CD5;&#x5339;&#x914D;
</code></pre>
<p>&#x540E;&#x9762;&#x4E24;&#x79CD;&#x66F4;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x5E73;&#x5E38;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7F16;&#x5199;&#x89C4;&#x5219;</p>
<h4 id="413-&#x4E66;&#x5199;&#x6280;&#x5DE7;">4.1.3 &#x4E66;&#x5199;&#x6280;&#x5DE7;</h4>
<p>&#x5BF9;&#x4E8E;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7F16;&#x5199;&#x5176;&#x5B9E;&#x662F;&#x5F88;&#x7075;&#x6D3B;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x7F16;&#x5199;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6709;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x597D;&#x7684;&#x6280;&#x5DE7;&#x8BA9;&#x6211;&#x4EEC;&#x7528;&#x7528;:</p>
<ul>
<li>&#x6240;&#x6709;&#x4EE3;&#x7801;&#x6309;&#x7167;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x5F00;&#x53D1;&#xFF0C;&#x5426;&#x5219;&#x4EE5;&#x4E0B;&#x6280;&#x5DE7;&#x5168;&#x90E8;&#x5931;&#x6548;</li>
<li>&#x63CF;&#x8FF0;&#x5207;&#x5165;&#x70B9;&#x901A;<strong>==&#x5E38;&#x63CF;&#x8FF0;&#x63A5;&#x53E3;==</strong>&#xFF0C;&#x800C;&#x4E0D;&#x63CF;&#x8FF0;&#x5B9E;&#x73B0;&#x7C7B;,&#x5982;&#x679C;&#x63CF;&#x8FF0;&#x5230;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x5C31;&#x51FA;&#x73B0;&#x7D27;&#x8026;&#x5408;&#x4E86;</li>
<li>&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x4FEE;&#x9970;&#x7B26;&#x9488;&#x5BF9;&#x63A5;&#x53E3;&#x5F00;&#x53D1;&#x5747;&#x91C7;&#x7528;public&#x63CF;&#x8FF0;&#xFF08;<strong>==&#x53EF;&#x7701;&#x7565;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x4FEE;&#x9970;&#x7B26;&#x63CF;&#x8FF0;==</strong>&#xFF09;</li>
<li>&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x5BF9;&#x4E8E;&#x589E;&#x5220;&#x6539;&#x7C7B;&#x4F7F;&#x7528;&#x7CBE;&#x51C6;&#x7C7B;&#x578B;&#x52A0;&#x901F;&#x5339;&#x914D;&#xFF0C;&#x5BF9;&#x4E8E;&#x67E5;&#x8BE2;&#x7C7B;&#x4F7F;&#x7528;*&#x901A;&#x914D;&#x5FEB;&#x901F;&#x63CF;&#x8FF0;</li>
<li><strong>==&#x5305;&#x540D;==</strong>&#x4E66;&#x5199;<strong>==&#x5C3D;&#x91CF;&#x4E0D;&#x4F7F;&#x7528;..&#x5339;&#x914D;==</strong>&#xFF0C;&#x6548;&#x7387;&#x8FC7;&#x4F4E;&#xFF0C;&#x5E38;&#x7528;*&#x505A;&#x5355;&#x4E2A;&#x5305;&#x63CF;&#x8FF0;&#x5339;&#x914D;&#xFF0C;&#x6216;&#x7CBE;&#x51C6;&#x5339;&#x914D;</li>
<li><strong>==&#x63A5;&#x53E3;&#x540D;/&#x7C7B;&#x540D;==</strong>&#x4E66;&#x5199;&#x540D;&#x79F0;&#x4E0E;&#x6A21;&#x5757;&#x76F8;&#x5173;&#x7684;<strong>==&#x91C7;&#x7528;*&#x5339;&#x914D;==</strong>&#xFF0C;&#x4F8B;&#x5982;UserService&#x4E66;&#x5199;&#x6210;*Service&#xFF0C;&#x7ED1;&#x5B9A;&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x540D;</li>
<li><strong>==&#x65B9;&#x6CD5;&#x540D;==</strong>&#x4E66;&#x5199;&#x4EE5;<strong>==&#x52A8;&#x8BCD;==</strong>&#x8FDB;&#x884C;<strong>==&#x7CBE;&#x51C6;&#x5339;&#x914D;==</strong>&#xFF0C;&#x540D;&#x8BCD;&#x91C7;&#x7528;<em>&#x5339;&#x914D;&#xFF0C;&#x4F8B;&#x5982;getById&#x4E66;&#x5199;&#x6210;getBy</em>,selectAll&#x4E66;&#x5199;&#x6210;selectAll</li>
<li>&#x53C2;&#x6570;&#x89C4;&#x5219;&#x8F83;&#x4E3A;&#x590D;&#x6742;&#xFF0C;&#x6839;&#x636E;&#x4E1A;&#x52A1;&#x65B9;&#x6CD5;&#x7075;&#x6D3B;&#x8C03;&#x6574;</li>
<li>&#x901A;&#x5E38;<strong>==&#x4E0D;&#x4F7F;&#x7528;&#x5F02;&#x5E38;==</strong>&#x4F5C;&#x4E3A;<strong>==&#x5339;&#x914D;==</strong>&#x89C4;&#x5219;</li>
</ul>
<h3 id="42-aop&#x901A;&#x77E5;&#x7C7B;&#x578B;">4.2 AOP&#x901A;&#x77E5;&#x7C7B;&#x578B;</h3>
<p>&#x524D;&#x9762;&#x7684;&#x6848;&#x4F8B;&#x4E2D;&#xFF0C;&#x6709;&#x6D89;&#x53CA;&#x5230;&#x5982;&#x4E0B;&#x5185;&#x5BB9;:</p>
<p><img src="../.gitbook/assets/1630164718080.png" alt="1630164718080"></p>
<p>&#x5B83;&#x6240;&#x4EE3;&#x8868;&#x7684;&#x542B;&#x4E49;&#x662F;&#x5C06;<code>&#x901A;&#x77E5;</code>&#x6DFB;&#x52A0;&#x5230;<code>&#x5207;&#x5165;&#x70B9;</code>&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;==&#x524D;&#x9762;==&#x3002;</p>
<p>&#x9664;&#x4E86;&#x8FD9;&#x4E2A;&#x6CE8;&#x89E3;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x6CE8;&#x89E3;&#xFF0C;&#x6362;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x9664;&#x4E86;&#x53EF;&#x4EE5;&#x5728;&#x524D;&#x9762;&#x52A0;&#xFF0C;&#x80FD;&#x4E0D;&#x80FD;&#x5728;&#x5176;&#x4ED6;&#x7684;&#x5730;&#x65B9;&#x52A0;?</p>
<h4 id="421-&#x7C7B;&#x578B;&#x4ECB;&#x7ECD;">4.2.1 &#x7C7B;&#x578B;&#x4ECB;&#x7ECD;</h4>
<p>&#x6211;&#x4EEC;&#x5148;&#x6765;&#x56DE;&#x987E;&#x4E0B;AOP&#x901A;&#x77E5;:</p>
<ul>
<li>AOP&#x901A;&#x77E5;&#x63CF;&#x8FF0;&#x4E86;&#x62BD;&#x53D6;&#x7684;&#x5171;&#x6027;&#x529F;&#x80FD;&#xFF0C;&#x6839;&#x636E;&#x5171;&#x6027;&#x529F;&#x80FD;&#x62BD;&#x53D6;&#x7684;&#x4F4D;&#x7F6E;&#x4E0D;&#x540C;&#xFF0C;&#x6700;&#x7EC8;&#x8FD0;&#x884C;&#x4EE3;&#x7801;&#x65F6;&#x8981;&#x5C06;&#x5176;&#x52A0;&#x5165;&#x5230;&#x5408;&#x7406;&#x7684;&#x4F4D;&#x7F6E;</li>
</ul>
<p>&#x901A;&#x77E5;&#x5177;&#x4F53;&#x8981;&#x6DFB;&#x52A0;&#x5230;&#x5207;&#x5165;&#x70B9;&#x7684;&#x54EA;&#x91CC;?</p>
<p>&#x5171;&#x63D0;&#x4F9B;&#x4E86;5&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;:</p>
<ul>
<li>&#x524D;&#x7F6E;&#x901A;&#x77E5;</li>
<li>&#x540E;&#x7F6E;&#x901A;&#x77E5;</li>
<li><strong>==&#x73AF;&#x7ED5;&#x901A;&#x77E5;(&#x91CD;&#x70B9;)==</strong></li>
<li>&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;(&#x4E86;&#x89E3;)</li>
<li>&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;(&#x4E86;&#x89E3;)</li>
</ul>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x7406;&#x89E3;&#x8FD9;&#x51E0;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x5F20;&#x56FE;</p>
<p><img src="../.gitbook/assets/1630166147697.png" alt="1630166147697"></p>
<p>(1)&#x524D;&#x7F6E;&#x901A;&#x77E5;&#xFF0C;&#x8FFD;&#x52A0;&#x529F;&#x80FD;&#x5230;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x524D;,&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x4EE3;&#x7801;1&#x6216;&#x8005;&#x4EE3;&#x7801;2&#x6DFB;&#x52A0;&#x5185;&#x5BB9;</p>
<p>(2)&#x540E;&#x7F6E;&#x901A;&#x77E5;,&#x8FFD;&#x52A0;&#x529F;&#x80FD;&#x5230;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x540E;,&#x4E0D;&#x7BA1;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x6CA1;&#x6709;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x4EE3;&#x7801;5&#x6DFB;&#x52A0;&#x5185;&#x5BB9;</p>
<p>(3)&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;,&#x8FFD;&#x52A0;&#x529F;&#x80FD;&#x5230;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x540E;&#xFF0C;&#x53EA;&#x6709;&#x65B9;&#x6CD5;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;&#x624D;&#x8FDB;&#x884C;,&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x4EE3;&#x7801;3&#x6DFB;&#x52A0;&#x5185;&#x5BB9;&#xFF0C;&#x5982;&#x679C;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x5C06;&#x4E0D;&#x4F1A;&#x88AB;&#x6DFB;&#x52A0;</p>
<p>(4)&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;,&#x8FFD;&#x52A0;&#x529F;&#x80FD;&#x5230;&#x65B9;&#x6CD5;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#xFF0C;&#x53EA;&#x6709;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x51FA;&#x5F02;&#x5E38;&#x624D;&#x8FDB;&#x884C;,&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x4EE3;&#x7801;4&#x6DFB;&#x52A0;&#x5185;&#x5BB9;&#xFF0C;&#x53EA;&#x6709;&#x65B9;&#x6CD5;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x624D;&#x4F1A;&#x88AB;&#x6DFB;&#x52A0;</p>
<p>(5)&#x73AF;&#x7ED5;&#x901A;&#x77E5;,&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x529F;&#x80FD;&#x6BD4;&#x8F83;&#x5F3A;&#x5927;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x8FFD;&#x52A0;&#x529F;&#x80FD;&#x5230;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x524D;&#x540E;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x6BD4;&#x8F83;&#x5E38;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5176;&#x4ED6;&#x56DB;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5177;&#x4F53;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x5F80;&#x4E0B;&#x5B66;&#x4E60;&#x3002;</p>
<h4 id="422-&#x73AF;&#x5883;&#x51C6;&#x5907;">4.2.2 &#x73AF;&#x5883;&#x51C6;&#x5907;</h4>
<ul>
<li><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Maven&#x9879;&#x76EE;</p>
</li>
<li><p>pom.xml&#x6DFB;&#x52A0;Spring&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
</li>
<li><p>&#x6DFB;&#x52A0;BookDao&#x548C;BookDaoImpl&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">select</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;book dao update ...&quot;</span>);
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">select</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;book dao select is running ...&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;
    }
}
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;Spring&#x7684;&#x914D;&#x7F6E;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@EnableAspectJAutoProxy</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;&#x901A;&#x77E5;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;before advice ...&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;after advice ...&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">around</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;around before advice ...&quot;</span>);
        System.out.println(<span class="hljs-string">&quot;around after advice ...&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterReturning</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterReturning advice ...&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterThrowing</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterThrowing advice ...&quot;</span>);
    }
}
</code></pre>
</li>
<li><p>&#x7F16;&#x5199;App&#x8FD0;&#x884C;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        bookDao.update();
    }
}
</code></pre>
</li>
</ul>
<p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630167385146.png" alt="1630167385146"></p>
<h4 id="423-&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x4F7F;&#x7528;">4.2.3 &#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x4F7F;&#x7528;</h4>
<h5 id="&#x524D;&#x7F6E;&#x901A;&#x77E5;">&#x524D;&#x7F6E;&#x901A;&#x77E5;</h5>
<p>&#x4FEE;&#x6539;MyAdvice,&#x5728;before&#x65B9;&#x6CD5;&#x4E0A;&#x6DFB;&#x52A0;<code>@Before&#x6CE8;&#x89E3;</code></p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-comment">//&#x6B64;&#x5904;&#x4E5F;&#x53EF;&#x4EE5;&#x5199;&#x6210; @Before(&quot;MyAdvice.pt()&quot;),&#x4E0D;&#x5EFA;&#x8BAE;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;before advice ...&quot;</span>);
    }
}
</code></pre>
<p><img src="../.gitbook/assets/1630167805723.png" alt="1630167805723"></p>
<h5 id="&#x540E;&#x7F6E;&#x901A;&#x77E5;">&#x540E;&#x7F6E;&#x901A;&#x77E5;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;before advice ...&quot;</span>);
    }
    <span class="hljs-meta">@After</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;after advice ...&quot;</span>);
    }
}
</code></pre>
<p><img src="../.gitbook/assets/1630167887131.png" alt="1630167887131"></p>
<h5 id="&#x73AF;&#x7ED5;&#x901A;&#x77E5;">&#x73AF;&#x7ED5;&#x901A;&#x77E5;</h5>
<h6 id="&#x57FA;&#x672C;&#x4F7F;&#x7528;">&#x57FA;&#x672C;&#x4F7F;&#x7528;</h6>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">around</span><span class="hljs-params">()</span></span>{
        System.out.println(<span class="hljs-string">&quot;around before advice ...&quot;</span>);
        System.out.println(<span class="hljs-string">&quot;around after advice ...&quot;</span>);
    }
}
</code></pre>
<p><img src="../.gitbook/assets/1630167969051.png" alt="1630167969051"></p>
<p>&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#x4E2D;&#xFF0C;&#x901A;&#x77E5;&#x7684;&#x5185;&#x5BB9;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x4F46;&#x662F;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x5185;&#x5BB9;&#x5374;&#x6CA1;&#x6709;&#x88AB;&#x6267;&#x884C;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x9700;&#x8981;&#x5728;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x524D;&#x540E;&#x8FDB;&#x884C;&#x589E;&#x5F3A;&#xFF0C;&#x6240;&#x4EE5;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x80FD;&#x5BF9;&#x539F;&#x59CB;&#x64CD;&#x4F5C;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4F55;&#x5B9E;&#x73B0;?</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable</span>{
        System.out.println(<span class="hljs-string">&quot;around before advice ...&quot;</span>);
        <span class="hljs-comment">//&#x8868;&#x793A;&#x5BF9;&#x539F;&#x59CB;&#x64CD;&#x4F5C;&#x7684;&#x8C03;&#x7528;</span>
        pjp.proceed();
        System.out.println(<span class="hljs-string">&quot;around after advice ...&quot;</span>);
    }
}
</code></pre>
<p><strong>&#x8BF4;&#x660E;:</strong>proceed()&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x629B;&#x51FA;&#x5F02;&#x5E38;?</p>
<p>&#x539F;&#x56E0;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x770B;&#x4E0B;&#x6E90;&#x7801;&#x5C31;&#x77E5;&#x9053;&#x4E86;</p>
<p><img src="../.gitbook/assets/1630168248052.png" alt="1630168248052"></p>
<p>&#x518D;&#x6B21;&#x8FD0;&#x884C;&#xFF0C;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x88AB;&#x6267;&#x884C;&#x4E86;</p>
<p><img src="../.gitbook/assets/1630168293492.png" alt="1630168293492"></p>
<h6 id="&#x6CE8;&#x610F;&#x4E8B;&#x9879;">&#x6CE8;&#x610F;&#x4E8B;&#x9879;</h6>
<p>(1)&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x5904;&#x7406;</p>
<ul>
<li>&#x4FEE;&#x6539;MyAdvice,&#x5BF9;BookDao&#x4E2D;&#x7684;select&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#xFF0C;</li>
</ul>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(int com.itheima.dao.BookDao.select())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt2</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt2()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">aroundSelect</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable </span>{
        System.out.println(<span class="hljs-string">&quot;around before advice ...&quot;</span>);
        <span class="hljs-comment">//&#x8868;&#x793A;&#x5BF9;&#x539F;&#x59CB;&#x64CD;&#x4F5C;&#x7684;&#x8C03;&#x7528;</span>
        pjp.proceed();
        System.out.println(<span class="hljs-string">&quot;around after advice ...&quot;</span>);
    }
}
</code></pre>
<ul>
<li>&#x4FEE;&#x6539;App&#x7C7B;&#xFF0C;&#x8C03;&#x7528;select&#x65B9;&#x6CD5;</li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        <span class="hljs-keyword">int</span> num = bookDao.select();
        System.out.println(num);
    }
}
</code></pre>
<p>&#x8FD0;&#x884C;&#x540E;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x9519;&#x8BEF;&#x5185;&#x5BB9;&#x4E3A;:</p>
<p>Exception in thread &quot;main&quot; org.springframework.aop.AopInvocationException: ==Null return value from advice does not match primitive return type for: public abstract int com.itheima.dao.BookDao.select()==
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:226)
    at com.sun.proxy.$Proxy19.select(Unknown Source)
    at com.itheima.App.main(App.java:12)</p>
<p>&#x9519;&#x8BEF;&#x5927;&#x6982;&#x7684;&#x610F;&#x601D;&#x662F;:<code>&#x7A7A;&#x7684;&#x8FD4;&#x56DE;&#x4E0D;&#x5339;&#x914D;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;int&#x8FD4;&#x56DE;</code></p>
<ul>
<li>void&#x5C31;&#x662F;&#x8FD4;&#x56DE;Null</li>
<li>&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x5C31;&#x662F;BookDao&#x4E0B;&#x7684;select&#x65B9;&#x6CD5;</li>
</ul>
<p>&#x6240;&#x4EE5;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x7684;&#x8BDD;&#xFF0C;&#x8981;&#x6839;&#x636E;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6765;&#x8BBE;&#x7F6E;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x5177;&#x4F53;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x4E3A;:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(int com.itheima.dao.BookDao.select())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt2</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt2()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">aroundSelect</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable </span>{
        System.out.println(<span class="hljs-string">&quot;around before advice ...&quot;</span>);
        <span class="hljs-comment">//&#x8868;&#x793A;&#x5BF9;&#x539F;&#x59CB;&#x64CD;&#x4F5C;&#x7684;&#x8C03;&#x7528;</span>
        Object ret = pjp.proceed();
        System.out.println(<span class="hljs-string">&quot;around after advice ...&quot;</span>);
        <span class="hljs-keyword">return</span> ret;
    }
}
</code></pre>
<p><strong>&#x8BF4;&#x660E;:</strong></p>
<p>&#x200B;    &#x4E3A;&#x4EC0;&#x4E48;&#x8FD4;&#x56DE;&#x7684;&#x662F;Object&#x800C;&#x4E0D;&#x662F;int&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x662F;Object&#x7C7B;&#x578B;&#x66F4;&#x901A;&#x7528;&#x3002;</p>
<p>&#x200B;    &#x5728;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4E2D;&#x662F;&#x53EF;&#x4EE5;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x503C;&#x5C31;&#x884C;&#x4FEE;&#x6539;&#x7684;&#x3002;</p>
<h5 id="&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;">&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(int com.itheima.dao.BookDao.select())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt2</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@AfterReturning</span>(<span class="hljs-string">&quot;pt2()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterReturning</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterReturning advice ...&quot;</span>);
    }
}
</code></pre>
<p><img src="../.gitbook/assets/1630169124446.png" alt="1630169124446"></p>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x662F;&#x9700;&#x8981;&#x5728;&#x539F;&#x59CB;&#x65B9;&#x6CD5;<code>select</code>&#x6B63;&#x5E38;&#x6267;&#x884C;&#x540E;&#x624D;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x5982;&#x679C;<code>select()</code>&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x5F02;&#x5E38;&#xFF0C;&#x90A3;&#x4E48;&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x662F;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;&#x540E;&#x7F6E;&#x901A;&#x77E5;&#x662F;&#x4E0D;&#x7BA1;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x6709;&#x6CA1;&#x6709;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x90FD;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x5927;&#x5BB6;&#x4E0B;&#x53BB;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x7EC3;&#x4E60;&#x9A8C;&#x8BC1;&#x4E0B;&#x3002;</p>
<h5 id="&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;">&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(void com.itheima.dao.BookDao.update())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(int com.itheima.dao.BookDao.select())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt2</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@AfterReturning</span>(<span class="hljs-string">&quot;pt2()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterThrowing</span><span class="hljs-params">()</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterThrowing advice ...&quot;</span>);
    }
}
</code></pre>
<p><img src="../.gitbook/assets/1630169357146.png" alt="1630169357146"></p>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x662F;&#x9700;&#x8981;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;<code>select()</code>&#x65B9;&#x6CD5;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x884C;&#x4EE3;&#x7801;<code>int i = 1/0</code>&#x5373;&#x53EF;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x629B;&#x5F02;&#x5E38;&#xFF0C;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x5C06;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;</p>
<p>&#x5B66;&#x4E60;&#x5B8C;&#x8FD9;5&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x601D;&#x8003;&#x4E0B;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x662F;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x5176;&#x4ED6;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x529F;&#x80FD;&#x7684;?</p>
<p>&#x56E0;&#x4E3A;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x662F;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x628A;&#x589E;&#x5F3A;&#x7684;&#x4EE3;&#x7801;&#x5199;&#x5728;&#x8C03;&#x7528;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x4E0D;&#x540C;&#x4F4D;&#x7F6E;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5982;:</p>
<p><img src="../.gitbook/assets/1630170090945.png" alt="1630170090945"></p>
<h5 id="&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x603B;&#x7ED3;">&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x603B;&#x7ED3;</h5>
<h6 id="&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;after">&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;@After</h6>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@After</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5728;&#x539F;&#x59CB;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x540E;&#x8FD0;&#x884C;</td>
</tr>
</tbody>
</table>
<h6 id="&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;afterreturning">&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;@AfterReturning</h6>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@AfterReturning</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5728;&#x539F;&#x59CB;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#x6267;&#x884C;</td>
</tr>
</tbody>
</table>
<h6 id="&#x77E5;&#x8BC6;&#x70B9;3&#xFF1A;afterthrowing">&#x77E5;&#x8BC6;&#x70B9;3&#xFF1A;@AfterThrowing</h6>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@AfterThrowing</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5728;&#x539F;&#x59CB;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x8FD0;&#x884C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x6267;&#x884C;</td>
</tr>
</tbody>
</table>
<h6 id="&#x77E5;&#x8BC6;&#x70B9;4&#xFF1A;around">&#x77E5;&#x8BC6;&#x70B9;4&#xFF1A;@Around</h6>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@Around</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x7ED1;&#x5B9A;&#x5173;&#x7CFB;&#xFF0C;&#x5F53;&#x524D;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5728;&#x539F;&#x59CB;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x524D;&#x540E;&#x8FD0;&#x884C;</td>
</tr>
</tbody>
</table>
<p>==<strong>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x6CE8;&#x610F;&#x4E8B;&#x9879;</strong>==</p>
<ol>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x5FC5;&#x987B;&#x4F9D;&#x8D56;&#x5F62;&#x53C2;ProceedingJoinPoint&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x8FDB;&#x800C;&#x5B9E;&#x73B0;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x524D;&#x540E;&#x540C;&#x65F6;&#x6DFB;&#x52A0;&#x901A;&#x77E5;</li>
<li>&#x901A;&#x77E5;&#x4E2D;&#x5982;&#x679C;&#x672A;&#x4F7F;&#x7528;ProceedingJoinPoint&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x5C06;&#x8DF3;&#x8FC7;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;</li>
<li>&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x4E0D;&#x63A5;&#x6536;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x8BBE;&#x7F6E;&#x6210;void&#x5373;&#x53EF;&#xFF0C;&#x5982;&#x679C;&#x63A5;&#x6536;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x6700;&#x597D;&#x8BBE;&#x5B9A;&#x4E3A;Object&#x7C7B;&#x578B;</li>
<li>&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5982;&#x679C;&#x662F;void&#x7C7B;&#x578B;&#xFF0C;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x6210;void,&#x4E5F;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x6210;Object</li>
<li>&#x7531;&#x4E8E;&#x65E0;&#x6CD5;&#x9884;&#x77E5;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8FD0;&#x884C;&#x540E;&#x662F;&#x5426;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x56E0;&#x6B64;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x5FC5;&#x987B;&#x8981;&#x5904;&#x7406;Throwable&#x5F02;&#x5E38;</li>
</ol>
<p>&#x4ECB;&#x7ECD;&#x5B8C;&#x8FD9;&#x4E48;&#x591A;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#xFF0C;&#x5177;&#x4F53;&#x8BE5;&#x9009;&#x54EA;&#x4E00;&#x79CD;&#x5462;?</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x6848;&#x4F8B;&#x52A0;&#x6DF1;&#x4E0B;&#x5BF9;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x5B66;&#x4E60;&#x3002;</p>
<h3 id="43-&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x6548;&#x7387;">4.3 &#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x6548;&#x7387;</h3>
<h4 id="431-&#x9700;&#x6C42;&#x5206;&#x6790;">4.3.1 &#x9700;&#x6C42;&#x5206;&#x6790;</h4>
<p>&#x8FD9;&#x4E2A;&#x9700;&#x6C42;&#x4E5F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x524D;&#x9762;&#x6211;&#x4EEC;&#x5728;&#x4ECB;&#x7ECD;AOP&#x7684;&#x65F6;&#x5019;&#x5DF2;&#x7ECF;&#x6F14;&#x793A;&#x8FC7;:</p>
<ul>
<li>&#x9700;&#x6C42;:&#x4EFB;&#x610F;&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x5747;&#x53EF;&#x663E;&#x793A;&#x5176;&#x6267;&#x884C;&#x6548;&#x7387;&#xFF08;&#x6267;&#x884C;&#x65F6;&#x957F;&#xFF09;</li>
</ul>
<p>&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x7684;&#x76EE;&#x7684;&#x662F;&#x67E5;&#x770B;&#x6BCF;&#x4E2A;&#x4E1A;&#x52A1;&#x5C42;&#x6267;&#x884C;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x76D1;&#x63A7;&#x51FA;&#x54EA;&#x4E2A;&#x4E1A;&#x52A1;&#x6BD4;&#x8F83;&#x8017;&#x65F6;&#xFF0C;&#x5C06;&#x5176;&#x67E5;&#x627E;&#x51FA;&#x6765;&#x65B9;&#x4FBF;&#x4F18;&#x5316;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x7684;&#x601D;&#x8DEF;:</p>
<p>(1) &#x5F00;&#x59CB;&#x6267;&#x884C;&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;</p>
<p>(2) &#x6267;&#x884C;&#x65B9;&#x6CD5;</p>
<p>(3) &#x6267;&#x884C;&#x5B8C;&#x65B9;&#x6CD5;&#x4E4B;&#x540E;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;</p>
<p>(4) &#x7528;&#x540E;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x51CF;&#x53BB;&#x524D;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x7684;&#x5DEE;&#x503C;&#xFF0C;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x8981;&#x5728;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x524D;&#x540E;&#x6DFB;&#x52A0;&#x4E1A;&#x52A1;&#xFF0C;&#x7ECF;&#x8FC7;&#x5206;&#x6790;&#x6211;&#x4EEC;&#x5C06;&#x91C7;&#x7528;<code>&#x73AF;&#x7ED5;&#x901A;&#x77E5;</code>&#x3002;</p>
<p><strong>&#x8BF4;&#x660E;:</strong>&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x5982;&#x679C;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;&#xFF0C;&#x65F6;&#x95F4;&#x592A;&#x5FEB;&#xFF0C;&#x4E24;&#x4E2A;&#x65F6;&#x95F4;&#x5DEE;&#x53EF;&#x80FD;&#x4E3A;0&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x6267;&#x884C;&#x4E07;&#x6B21;&#x6765;&#x8BA1;&#x7B97;&#x65F6;&#x95F4;&#x5DEE;&#x3002;</p>
<h4 id="432-&#x73AF;&#x5883;&#x51C6;&#x5907;">4.3.2 &#x73AF;&#x5883;&#x51C6;&#x5907;</h4>
<ul>
<li><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Maven&#x9879;&#x76EE;</p>
</li>
<li><p>pom.xml&#x6DFB;&#x52A0;Spring&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
</li>
<li><p>&#x6DFB;&#x52A0;AccountService&#x3001;AccountServiceImpl&#x3001;AccountDao&#x4E0E;Account&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountService</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">(Account account)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Account account)</span></span>;
    <span class="hljs-function">List&lt;Account&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">Account <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span></span>;
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">(Account account)</span> </span>{
        accountDao.save(account);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Account account)</span></span>{
        accountDao.update(account);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span> </span>{
        accountDao.delete(id);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> Account <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span> </span>{
        <span class="hljs-keyword">return</span> accountDao.findById(id);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Account&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> accountDao.findAll();
    }
}
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountDao</span> </span>{

    <span class="hljs-meta">@Insert</span>(<span class="hljs-string">&quot;insert into tbl_account(name,money)values(#{name},#{money})&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">save</span><span class="hljs-params">(Account account)</span></span>;

    <span class="hljs-meta">@Delete</span>(<span class="hljs-string">&quot;delete from tbl_account where id = #{id} &quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(Integer id)</span></span>;

    <span class="hljs-meta">@Update</span>(<span class="hljs-string">&quot;update tbl_account set name = #{name} , money = #{money} where id = #{id} &quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Account account)</span></span>;

    <span class="hljs-meta">@Select</span>(<span class="hljs-string">&quot;select * from tbl_account&quot;</span>)
    <span class="hljs-function">List&lt;Account&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;

    <span class="hljs-meta">@Select</span>(<span class="hljs-string">&quot;select * from tbl_account where id = #{id} &quot;</span>)
    <span class="hljs-function">Account <span class="hljs-title">findById</span><span class="hljs-params">(Integer id)</span></span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{

    <span class="hljs-keyword">private</span> Integer id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Double money;
    <span class="hljs-comment">//setter..getter..toString&#x65B9;&#x6CD5;&#x7701;&#x7565;</span>
}
</code></pre>
</li>
<li><p>resources&#x4E0B;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;jdbc.properties</p>
<pre><code class="lang-properties">jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/spring_db?useSSL=false
jdbc.username=root
jdbc.password=root
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-comment">//Spring&#x914D;&#x7F6E;&#x7C7B;:SpringConfig</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@PropertySource</span>(<span class="hljs-string">&quot;classpath:jdbc.properties&quot;</span>)
<span class="hljs-meta">@Import</span>({JdbcConfig.class,MybatisConfig.class})
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
<span class="hljs-comment">//JdbcConfig&#x914D;&#x7F6E;&#x7C7B;</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcConfig</span> </span>{
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.driver}&quot;</span>)
    <span class="hljs-keyword">private</span> String driver;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.url}&quot;</span>)
    <span class="hljs-keyword">private</span> String url;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.username}&quot;</span>)
    <span class="hljs-keyword">private</span> String userName;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.password}&quot;</span>)
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">dataSource</span><span class="hljs-params">()</span></span>{
        DruidDataSource ds = <span class="hljs-keyword">new</span> DruidDataSource();
        ds.setDriverClassName(driver);
        ds.setUrl(url);
        ds.setUsername(userName);
        ds.setPassword(password);
        <span class="hljs-keyword">return</span> ds;
    }
}
<span class="hljs-comment">//MybatisConfig&#x914D;&#x7F6E;&#x7C7B;</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisConfig</span> </span>{

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> SqlSessionFactoryBean <span class="hljs-title">sqlSessionFactory</span><span class="hljs-params">(DataSource dataSource)</span></span>{
        SqlSessionFactoryBean ssfb = <span class="hljs-keyword">new</span> SqlSessionFactoryBean();
        ssfb.setTypeAliasesPackage(<span class="hljs-string">&quot;com.itheima.domain&quot;</span>);
        ssfb.setDataSource(dataSource);
        <span class="hljs-keyword">return</span> ssfb;
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MapperScannerConfigurer <span class="hljs-title">mapperScannerConfigurer</span><span class="hljs-params">()</span></span>{
        MapperScannerConfigurer msc = <span class="hljs-keyword">new</span> MapperScannerConfigurer();
        msc.setBasePackage(<span class="hljs-string">&quot;com.itheima.dao&quot;</span>);
        <span class="hljs-keyword">return</span> msc;
    }
}
</code></pre>
</li>
<li><p>&#x7F16;&#x5199;Spring&#x6574;&#x5408;Junit&#x7684;&#x6D4B;&#x8BD5;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@RunWith</span>(SpringJUnit4ClassRunner.class)
<span class="hljs-meta">@ContextConfiguration</span>(classes = SpringConfig.class)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceTestCase</span> </span>{
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountService accountService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindById</span><span class="hljs-params">()</span></span>{
        Account ac = accountService.findById(<span class="hljs-number">2</span>);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindAll</span><span class="hljs-params">()</span></span>{
        List&lt;Account&gt; all = accountService.findAll();
    }

}
</code></pre>
</li>
</ul>
<p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630214631112.png" alt="1630214631112"></p>
<h4 id="433-&#x529F;&#x80FD;&#x5F00;&#x53D1;">4.3.3 &#x529F;&#x80FD;&#x5F00;&#x53D1;</h4>
<h5 id="&#x6B65;&#x9AA4;1&#x5F00;&#x542F;springaop&#x7684;&#x6CE8;&#x89E3;&#x529F;&#x80FD;">&#x6B65;&#x9AA4;1:&#x5F00;&#x542F;SpringAOP&#x7684;&#x6CE8;&#x89E3;&#x529F;&#x80FD;</h5>
<p>&#x5728;Spring&#x7684;&#x4E3B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;SpringConfig&#x7C7B;&#x4E2D;&#x6DFB;&#x52A0;&#x6CE8;&#x89E3;</p>
<pre><code class="lang-java"><span class="hljs-meta">@EnableAspectJAutoProxy</span>
</code></pre>
<h5 id="&#x6B65;&#x9AA4;2&#x521B;&#x5EFA;aop&#x7684;&#x901A;&#x77E5;&#x7C7B;">&#x6B65;&#x9AA4;2:&#x521B;&#x5EFA;AOP&#x7684;&#x901A;&#x77E5;&#x7C7B;</h5>
<ul>
<li><p>&#x8BE5;&#x7C7B;&#x8981;&#x88AB;Spring&#x7BA1;&#x7406;&#xFF0C;&#x9700;&#x8981;&#x6DFB;&#x52A0;@Component</p>
</li>
<li><p>&#x8981;&#x6807;&#x8BC6;&#x8BE5;&#x7C7B;&#x662F;&#x4E00;&#x4E2A;AOP&#x7684;&#x5207;&#x9762;&#x7C7B;&#xFF0C;&#x9700;&#x8981;&#x6DFB;&#x52A0;@Aspect</p>
</li>
<li>&#x914D;&#x7F6E;&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;@Pointcut</li>
</ul>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProjectAdvice</span> </span>{
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;</span>
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.service.*Service.*(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">runSpeed</span><span class="hljs-params">()</span></span>{

    } 
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;3&#x6DFB;&#x52A0;&#x73AF;&#x7ED5;&#x901A;&#x77E5;">&#x6B65;&#x9AA4;3:&#x6DFB;&#x52A0;&#x73AF;&#x7ED5;&#x901A;&#x77E5;</h5>
<p>&#x5728;runSpeed()&#x65B9;&#x6CD5;&#x4E0A;&#x6DFB;&#x52A0;@Around</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProjectAdvice</span> </span>{
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;</span>
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.service.*Service.*(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}
    <span class="hljs-comment">//@Around(&quot;ProjectAdvice.servicePt()&quot;) &#x53EF;&#x4EE5;&#x7B80;&#x5199;&#x4E3A;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;</span>
    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;servicePt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">runSpeed</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span></span>{
        Object ret = pjp.proceed();
        <span class="hljs-keyword">return</span> ret;
    } 
}
</code></pre>
<p><strong>&#x6CE8;&#x610F;:</strong>&#x76EE;&#x524D;&#x5E76;&#x6CA1;&#x6709;&#x505A;&#x4EFB;&#x4F55;&#x589E;&#x5F3A;</p>
<h5 id="&#x6B65;&#x9AA4;4&#x5B8C;&#x6210;&#x6838;&#x5FC3;&#x4E1A;&#x52A1;&#xFF0C;&#x8BB0;&#x5F55;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x7684;&#x65F6;&#x95F4;">&#x6B65;&#x9AA4;4:&#x5B8C;&#x6210;&#x6838;&#x5FC3;&#x4E1A;&#x52A1;&#xFF0C;&#x8BB0;&#x5F55;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x7684;&#x65F6;&#x95F4;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProjectAdvice</span> </span>{
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;</span>
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.service.*Service.*(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}
    <span class="hljs-comment">//@Around(&quot;ProjectAdvice.servicePt()&quot;) &#x53EF;&#x4EE5;&#x7B80;&#x5199;&#x4E3A;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;</span>
    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;servicePt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">runSpeed</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span></span>{

        <span class="hljs-keyword">long</span> start = System.currentTimeMillis();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
           pjp.proceed();
        }
        <span class="hljs-keyword">long</span> end = System.currentTimeMillis();
        System.out.println(<span class="hljs-string">&quot;&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x65F6;&#x95F4;: &quot;</span>+(end-start)+<span class="hljs-string">&quot;ms&quot;</span>);
    } 
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;5&#x8FD0;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7C7B;">&#x6B65;&#x9AA4;5:&#x8FD0;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7C7B;</h5>
<p><img src="../.gitbook/assets/1630215355776.png" alt="1630215355776"></p>
<p><strong>&#x6CE8;&#x610F;:</strong>&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x6BCF;&#x6B21;&#x6267;&#x884C;&#x7684;&#x65F6;&#x957F;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD0;&#x884C;&#x591A;&#x6B21;&#x6700;&#x7EC8;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<h5 id="&#x6B65;&#x9AA4;6&#x7A0B;&#x5E8F;&#x4F18;&#x5316;">&#x6B65;&#x9AA4;6:&#x7A0B;&#x5E8F;&#x4F18;&#x5316;</h5>
<p>&#x76EE;&#x524D;&#x7A0B;&#x5E8F;&#x6240;&#x9762;&#x4E34;&#x7684;&#x95EE;&#x9898;&#x662F;&#xFF0C;&#x591A;&#x4E2A;&#x65B9;&#x6CD5;&#x4E00;&#x8D77;&#x6267;&#x884C;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x63A7;&#x5236;&#x53F0;&#x90FD;&#x6253;&#x5370;&#x7684;&#x662F;:</p>
<p><code>&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x4E07;&#x6B21;&#x6267;&#x884C;&#x65F6;&#x95F4;:xxxms</code></p>
<p>&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x533A;&#x5206;&#x5230;&#x5E95;&#x662F;&#x54EA;&#x4E2A;&#x63A5;&#x53E3;&#x7684;&#x54EA;&#x4E2A;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x7684;&#x5177;&#x4F53;&#x65F6;&#x95F4;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4F55;&#x4F18;&#x5316;?</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProjectAdvice</span> </span>{
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x4E1A;&#x52A1;&#x5C42;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;</span>
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.service.*Service.*(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}
    <span class="hljs-comment">//@Around(&quot;ProjectAdvice.servicePt()&quot;) &#x53EF;&#x4EE5;&#x7B80;&#x5199;&#x4E3A;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;</span>
    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;servicePt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">runSpeed</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span></span>{
        <span class="hljs-comment">//&#x83B7;&#x53D6;&#x6267;&#x884C;&#x7B7E;&#x540D;&#x4FE1;&#x606F;</span>
        Signature signature = pjp.getSignature();
        <span class="hljs-comment">//&#x901A;&#x8FC7;&#x7B7E;&#x540D;&#x83B7;&#x53D6;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x540D;&#x79F0;(&#x63A5;&#x53E3;&#x540D;)</span>
        String className = signature.getDeclaringTypeName();
        <span class="hljs-comment">//&#x901A;&#x8FC7;&#x7B7E;&#x540D;&#x83B7;&#x53D6;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x540D;&#x79F0;(&#x65B9;&#x6CD5;&#x540D;)</span>
        String methodName = signature.getName();

        <span class="hljs-keyword">long</span> start = System.currentTimeMillis();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
           pjp.proceed();
        }
        <span class="hljs-keyword">long</span> end = System.currentTimeMillis();
        System.out.println(<span class="hljs-string">&quot;&#x4E07;&#x6B21;&#x6267;&#x884C;&#xFF1A;&quot;</span>+ className+<span class="hljs-string">&quot;.&quot;</span>+methodName+<span class="hljs-string">&quot;----&gt;&quot;</span> +(end-start) + <span class="hljs-string">&quot;ms&quot;</span>);
    } 
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;7&#x8FD0;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7C7B;">&#x6B65;&#x9AA4;7:&#x8FD0;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7C7B;</h5>
<p><img src="../.gitbook/assets/1630215743444.png" alt="1630215743444"></p>
<p>==&#x8865;&#x5145;&#x8BF4;&#x660E;==</p>
<p>&#x5F53;&#x524D;&#x6D4B;&#x8BD5;&#x7684;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x6548;&#x7387;&#x4EC5;&#x4EC5;&#x662F;&#x4E00;&#x4E2A;&#x7406;&#x8BBA;&#x503C;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x6B21;&#x5B8C;&#x6574;&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>&#x8FD9;&#x5757;&#x53EA;&#x662F;&#x901A;&#x8FC7;&#x8BE5;&#x6848;&#x4F8B;&#x628A;AOP&#x7684;&#x4F7F;&#x7528;&#x8FDB;&#x884C;&#x4E86;&#x5B66;&#x4E60;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x9645;&#x503C;&#x662F;&#x6709;&#x5F88;&#x591A;&#x56E0;&#x7D20;&#x5171;&#x540C;&#x51B3;&#x5B9A;&#x7684;&#x3002;</p>
<h3 id="44-aop&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x6570;&#x636E;">4.4 AOP&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x6570;&#x636E;</h3>
<p>&#x76EE;&#x524D;&#x6211;&#x4EEC;&#x5199;AOP&#x4EC5;&#x4EC5;&#x662F;&#x5728;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x524D;&#x540E;&#x8FFD;&#x52A0;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x8981;&#x8BF4;&#x8BF4;AOP&#x4E2D;&#x6570;&#x636E;&#x76F8;&#x5173;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4ECE;<code>&#x83B7;&#x53D6;&#x53C2;&#x6570;</code>&#x3001;<code>&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;</code>&#x548C;<code>&#x83B7;&#x53D6;&#x5F02;&#x5E38;</code>&#x4E09;&#x4E2A;&#x65B9;&#x9762;&#x6765;&#x7814;&#x7A76;&#x5207;&#x5165;&#x70B9;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x524D;&#x9762;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x7684;&#x65F6;&#x5019;&#x603B;&#x5171;&#x8BB2;&#x4E86;&#x4E94;&#x79CD;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E94;&#x79CD;&#x7C7B;&#x578B;&#x90FD;&#x4F1A;&#x6709;&#x53C2;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x503C;&#x548C;&#x5F02;&#x5E38;&#x5417;?</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x6765;&#x4E00;&#x4E2A;&#x4E2A;&#x5206;&#x6790;&#x4E0B;:</p>
<ul>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x90FD;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x53C2;&#x6570;<ul>
<li>JoinPoint&#xFF1A;&#x9002;&#x7528;&#x4E8E;&#x524D;&#x7F6E;&#x3001;&#x540E;&#x7F6E;&#x3001;&#x8FD4;&#x56DE;&#x540E;&#x3001;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</li>
<li>ProceedingJoinPoint&#xFF1A;&#x9002;&#x7528;&#x4E8E;&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x524D;&#x7F6E;&#x548C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x662F;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x540E;&#x7F6E;&#x901A;&#x77E5;&#x53EF;&#x6709;&#x53EF;&#x65E0;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x505A;&#x7814;&#x7A76;<ul>
<li>&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x8FD0;&#x884C;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#xFF0C;&#x524D;&#x7F6E;&#x548C;&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x662F;&#x4E0D;&#x4F1A;&#x6709;&#xFF0C;&#x540E;&#x7F6E;&#x901A;&#x77E5;&#x53EF;&#x6709;&#x53EF;&#x65E0;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x505A;&#x7814;&#x7A76;<ul>
<li>&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
</ul>
<h4 id="441-&#x73AF;&#x5883;&#x51C6;&#x5907;">4.4.1 &#x73AF;&#x5883;&#x51C6;&#x5907;</h4>
<ul>
<li><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Maven&#x9879;&#x76EE;</p>
</li>
<li><p>pom.xml&#x6DFB;&#x52A0;Spring&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
</li>
<li><p>&#x6DFB;&#x52A0;BookDao&#x548C;BookDaoImpl&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findName</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;
}
<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findName</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>{
        System.out.println(<span class="hljs-string">&quot;id:&quot;</span>+id);
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;itcast&quot;</span>;
    }
}
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;Spring&#x7684;&#x914D;&#x7F6E;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@EnableAspectJAutoProxy</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
</li>
<li><p>&#x7F16;&#x5199;&#x901A;&#x77E5;&#x7C7B;</p>
<p>```java
@Component
@Aspect
public class MyAdvice {</p>
<pre><code>@Pointcut(&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;)
private void pt(){}

@Before(&quot;pt()&quot;)
public void before() {
    System.out.println(&quot;before advice ...&quot; );
}

@After(&quot;pt()&quot;)
public void after() {
    System.out.println(&quot;after advice ...&quot;);
}

@Around(&quot;pt()&quot;)
public Object around() throws Throwable{
    Object ret = pjp.proceed();
    return ret;
}
@AfterReturning(&quot;pt()&quot;)
public void afterReturning() {
    System.out.println(&quot;afterReturning advice ...&quot;);
}
</code></pre></li>
</ul>
<pre><code>  @AfterThrowing(&quot;pt()&quot;)
  public void afterThrowing() {
      System.out.println(&quot;afterThrowing advice ...&quot;);
  }
</code></pre><p>  }</p>
<pre><code>
- &#x7F16;&#x5199;App&#x8FD0;&#x884C;&#x7C7B;

  ```java
  public class App {
      public static void main(String[] args) {
          ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);
          BookDao bookDao = ctx.getBean(BookDao.class);
          String name = bookDao.findName(100);
          System.out.println(name);
      }
  }
</code></pre><p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630233154992.png" alt="1630233154992"></p>
<h4 id="442-&#x83B7;&#x53D6;&#x53C2;&#x6570;">4.4.2 &#x83B7;&#x53D6;&#x53C2;&#x6570;</h4>
<h5 id="&#x975E;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;">&#x975E;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;</h5>
<p>&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x6DFB;&#x52A0;JoinPoint,&#x901A;&#x8FC7;JoinPoint&#x6765;&#x83B7;&#x53D6;&#x53C2;&#x6570;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Before</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">(JoinPoint jp)</span> 
        Object[] args </span>= jp.getArgs();
        System.out.println(Arrays.toString(args));
        System.out.println(<span class="hljs-string">&quot;before advice ...&quot;</span> );
    }
    <span class="hljs-comment">//...&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x8FD0;&#x884C;App&#x7C7B;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF0C;&#x8BF4;&#x660E;&#x53C2;&#x6570;100&#x5DF2;&#x7ECF;&#x88AB;&#x83B7;&#x53D6;</p>
<p><img src="../.gitbook/assets/1630233291929.png" alt="1630233291929"></p>
<p><strong>&#x601D;&#x8003;:&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x83B7;&#x53D6;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;?</strong></p>
<p>&#x56E0;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x662F;&#x4E0D;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x6570;&#x7EC4;&#x66F4;&#x901A;&#x914D;&#x4E9B;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5C06;&#x53C2;&#x6570;&#x6539;&#x6210;&#x4E24;&#x4E2A;&#x4F1A;&#x662F;&#x4EC0;&#x4E48;&#x6548;&#x679C;&#x5462;?</p>
<p>(1)&#x4FEE;&#x6539;BookDao&#x63A5;&#x53E3;&#x548C;BookDaoImpl&#x5B9E;&#x73B0;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findName</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id,String password)</span></span>;
}
<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findName</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id,String password)</span> </span>{
        System.out.println(<span class="hljs-string">&quot;id:&quot;</span>+id);
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;itcast&quot;</span>;
    }
}
</code></pre>
<p>(2)&#x4FEE;&#x6539;App&#x7C7B;&#xFF0C;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x4F20;&#x5165;&#x591A;&#x4E2A;&#x53C2;&#x6570;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        BookDao bookDao = ctx.getBean(BookDao.class);
        String name = bookDao.findName(<span class="hljs-number">100</span>,<span class="hljs-string">&quot;itheima&quot;</span>);
        System.out.println(name);
    }
}
</code></pre>
<p>(3)&#x8FD0;&#x884C;App&#xFF0C;&#x67E5;&#x770B;&#x7ED3;&#x679C;,&#x8BF4;&#x660E;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x5DF2;&#x7ECF;&#x88AB;&#x83B7;&#x53D6;&#x5230;</p>
<p><img src="../.gitbook/assets/1630233548743.png" alt="1630233548743"></p>
<p><strong>&#x8BF4;&#x660E;:</strong></p>
<p>&#x4F7F;&#x7528;JoinPoint&#x7684;&#x65B9;&#x5F0F;&#x83B7;&#x53D6;&#x53C2;&#x6570;&#x9002;&#x7528;&#x4E8E;<code>&#x524D;&#x7F6E;</code>&#x3001;<code>&#x540E;&#x7F6E;</code>&#x3001;<code>&#x8FD4;&#x56DE;&#x540E;</code>&#x3001;<code>&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;</code>&#x901A;&#x77E5;&#x3002;&#x5269;&#x4E0B;&#x7684;&#x5927;&#x5BB6;&#x81EA;&#x884C;&#x53BB;&#x9A8C;&#x8BC1;&#x3002;</p>
<h5 id="&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;">&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;</h5>
<p>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4F7F;&#x7528;&#x7684;&#x662F;ProceedingJoinPoint&#xFF0C;&#x56E0;&#x4E3A;ProceedingJoinPoint&#x662F;JoinPoint&#x7C7B;&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;ProceedingJoinPoint&#x7C7B;&#x4E2D;&#x5E94;&#x8BE5;&#x4E5F;&#x4F1A;&#x6709;&#x5BF9;&#x5E94;&#x7684;<code>getArgs()</code>&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x53BB;&#x9A8C;&#x8BC1;&#x4E0B;:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span><span class="hljs-keyword">throws</span> Throwable </span>{
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        Object ret = pjp.proceed();
        <span class="hljs-keyword">return</span> ret;
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x8FD0;&#x884C;App&#x540E;&#x67E5;&#x770B;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF0C;&#x8BF4;&#x660E;ProceedingJoinPoint&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;getArgs()&#x83B7;&#x53D6;&#x53C2;&#x6570;</p>
<p><img src="../.gitbook/assets/1630233974310.png" alt="1630233974310"></p>
<p><strong>&#x6CE8;&#x610F;:</strong></p>
<ul>
<li><p>pjp.proceed()&#x65B9;&#x6CD5;&#x662F;&#x6709;&#x4E24;&#x4E2A;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#xFF0C;&#x5206;&#x522B;&#x662F;:</p>
<p><img src="../.gitbook/assets/1630234756123.png" alt="1630234756123"></p>
<ul>
<li><p>&#x8C03;&#x7528;&#x65E0;&#x53C2;&#x6570;&#x7684;proceed&#xFF0C;&#x5F53;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x6709;&#x53C2;&#x6570;&#xFF0C;&#x4F1A;&#x5728;&#x8C03;&#x7528;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x81EA;&#x52A8;&#x4F20;&#x5165;&#x53C2;&#x6570;</p>
</li>
<li><p>&#x6240;&#x4EE5;&#x8C03;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x90FD;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x529F;&#x80FD;</p>
</li>
<li><p>&#x4F46;&#x662F;&#x5F53;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x5C31;&#x53EA;&#x80FD;&#x91C7;&#x7528;&#x5E26;&#x6709;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x6CD5;,&#x5982;&#x4E0B;:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable</span>{
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        args[<span class="hljs-number">0</span>] = <span class="hljs-number">666</span>;
        Object ret = pjp.proceed(args);
        <span class="hljs-keyword">return</span> ret;
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x6709;&#x4E86;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4E2D;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x62E6;&#x622A;&#x8FC7;&#x6EE4;&#xFF0C;&#x907F;&#x514D;&#x7531;&#x4E8E;&#x53C2;&#x6570;&#x7684;&#x95EE;&#x9898;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x8FD0;&#x884C;&#xFF0C;&#x4FDD;&#x8BC1;&#x4EE3;&#x7801;&#x7684;&#x5065;&#x58EE;&#x6027;&#x3002;</p>
</li>
</ul>
</li>
</ul>
<h4 id="443-&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;">4.4.3 &#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;</h4>
<p>&#x5BF9;&#x4E8E;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x53EA;&#x6709;&#x8FD4;&#x56DE;&#x540E;<code>AfterReturing</code>&#x548C;&#x73AF;&#x7ED5;<code>Around</code>&#x8FD9;&#x4E24;&#x4E2A;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4F55;&#x83B7;&#x53D6;?</p>
<h5 id="&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;">&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable</span>{
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        args[<span class="hljs-number">0</span>] = <span class="hljs-number">666</span>;
        Object ret = pjp.proceed(args);
        <span class="hljs-keyword">return</span> ret;
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;<code>ret</code>&#x5C31;&#x662F;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x6211;&#x4EEC;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x83B7;&#x53D6;&#xFF0C;&#x4E0D;&#x4F46;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x8FD8;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;</p>
<h5 id="&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;">&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x503C;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@AfterReturning</span>(value = <span class="hljs-string">&quot;pt()&quot;</span>,returning = <span class="hljs-string">&quot;ret&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterReturning</span><span class="hljs-params">(Object ret)</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterReturning advice ...&quot;</span>+ret);
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>==&#x6CE8;&#x610F;:==</p>
<p>(1)&#x53C2;&#x6570;&#x540D;&#x7684;&#x95EE;&#x9898;</p>
<p><img src="../.gitbook/assets/1630237320870.png" alt="1630237320870"></p>
<p>(2)afterReturning&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x95EE;&#x9898;</p>
<p>&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x5199;&#x6210;String&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x80FD;&#x5339;&#x914D;&#x66F4;&#x591A;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#xFF0C;&#x5EFA;&#x8BAE;&#x5199;&#x6210;Object&#x7C7B;&#x578B;</p>
<p>(3)afterReturning&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x7684;&#x987A;&#x5E8F;&#x95EE;&#x9898;</p>
<p><img src="../.gitbook/assets/1630237586682.png" alt="1630237586682"></p>
<p>&#x8FD0;&#x884C;App&#x540E;&#x67E5;&#x770B;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF0C;&#x8BF4;&#x660E;&#x8FD4;&#x56DE;&#x503C;&#x5DF2;&#x7ECF;&#x88AB;&#x83B7;&#x53D6;&#x5230;</p>
<p><img src="../.gitbook/assets/1630237372286.png" alt="1630237372286"></p>
<h4 id="444-&#x83B7;&#x53D6;&#x5F02;&#x5E38;">4.4.4 &#x83B7;&#x53D6;&#x5F02;&#x5E38;</h4>
<p>&#x5BF9;&#x4E8E;&#x83B7;&#x53D6;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x53EA;&#x6709;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;<code>AfterThrowing</code>&#x548C;&#x73AF;&#x7ED5;<code>Around</code>&#x8FD9;&#x4E24;&#x4E2A;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4F55;&#x83B7;&#x53D6;?</p>
<h5 id="&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x5F02;&#x5E38;">&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x5F02;&#x5E38;</h5>
<p>&#x8FD9;&#x5757;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x4EE5;&#x524D;&#x6211;&#x4EEC;&#x662F;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x73B0;&#x5728;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x5F02;&#x5E38;&#x6355;&#x83B7;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E86;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;pt()&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span></span>{
        Object[] args = pjp.getArgs();
        System.out.println(Arrays.toString(args));
        args[<span class="hljs-number">0</span>] = <span class="hljs-number">666</span>;
        Object ret = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">try</span>{
            ret = pjp.proceed(args);
        }<span class="hljs-keyword">catch</span>(Throwable throwable){
            t.printStackTrace();
        }
        <span class="hljs-keyword">return</span> ret;
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x5728;catch&#x65B9;&#x6CD5;&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;&#x5F02;&#x5E38;&#xFF0C;&#x81F3;&#x4E8E;&#x83B7;&#x53D6;&#x5230;&#x5F02;&#x5E38;&#x4EE5;&#x540E;&#x8BE5;&#x5982;&#x4F55;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x548C;&#x4F60;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#x6709;&#x5173;&#x4E86;&#x3002;</p>
<h5 id="&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x5F02;&#x5E38;">&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x83B7;&#x53D6;&#x5F02;&#x5E38;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(* com.itheima.dao.BookDao.findName(..))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@AfterThrowing</span>(value = <span class="hljs-string">&quot;pt()&quot;</span>,throwing = <span class="hljs-string">&quot;t&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterThrowing</span><span class="hljs-params">(Throwable t)</span> </span>{
        System.out.println(<span class="hljs-string">&quot;afterThrowing advice ...&quot;</span>+t);
    }
    <span class="hljs-comment">//&#x5176;&#x4ED6;&#x7684;&#x7565;</span>
}
</code></pre>
<p>&#x5982;&#x4F55;&#x8BA9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x65B9;&#x5F0F;&#x6709;&#x5F88;&#x591A;&#xFF0C;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookDao</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">findName</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id,String password)</span> </span>{
        System.out.println(<span class="hljs-string">&quot;id:&quot;</span>+id);
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;itcast&quot;</span>;
    }
}
</code></pre>
<p>==&#x6CE8;&#x610F;:==</p>
<p><img src="../.gitbook/assets/1630239939043.png" alt="1630239939043"></p>
<p>&#x8FD0;&#x884C;App&#x540E;&#xFF0C;&#x67E5;&#x770B;&#x63A7;&#x5236;&#x53F0;&#xFF0C;&#x5C31;&#x80FD;&#x770B;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x88AB;&#x6253;&#x5370;&#x5230;&#x63A7;&#x5236;&#x53F0;</p>
<p><img src="../.gitbook/assets/1630239997560.png" alt="1630239997560"></p>
<p>&#x81F3;&#x6B64;&#xFF0C;AOP&#x901A;&#x77E5;&#x5982;&#x4F55;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x5C31;&#x5DF2;&#x7ECF;&#x8BB2;&#x89E3;&#x5B8C;&#x4E86;&#xFF0C;&#x6570;&#x636E;&#x4E2D;&#x5305;&#x542B;<code>&#x53C2;&#x6570;</code>&#x3001;<code>&#x8FD4;&#x56DE;&#x503C;</code>&#x3001;<code>&#x5F02;&#x5E38;(&#x4E86;&#x89E3;)</code>&#x3002;</p>
<h3 id="45-&#x767E;&#x5EA6;&#x7F51;&#x76D8;&#x5BC6;&#x7801;&#x6570;&#x636E;&#x517C;&#x5BB9;&#x5904;&#x7406;">4.5 &#x767E;&#x5EA6;&#x7F51;&#x76D8;&#x5BC6;&#x7801;&#x6570;&#x636E;&#x517C;&#x5BB9;&#x5904;&#x7406;</h3>
<h4 id="451-&#x9700;&#x6C42;&#x5206;&#x6790;">4.5.1 &#x9700;&#x6C42;&#x5206;&#x6790;</h4>
<p>&#x9700;&#x6C42;: &#x5BF9;&#x767E;&#x5EA6;&#x7F51;&#x76D8;&#x5206;&#x4EAB;&#x94FE;&#x63A5;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#x65F6;&#x5C3E;&#x90E8;&#x591A;&#x8F93;&#x5165;&#x7684;&#x7A7A;&#x683C;&#x505A;&#x517C;&#x5BB9;&#x5904;&#x7406;&#x3002;</p>
<p><img src="../.gitbook/assets/1630240203033.png" alt="1630240203033"></p>
<p>&#x95EE;&#x9898;&#x63CF;&#x8FF0;:</p>
<ul>
<li><p>&#x70B9;&#x51FB;&#x94FE;&#x63A5;&#xFF0C;&#x4F1A;&#x63D0;&#x793A;&#xFF0C;&#x8BF7;&#x8F93;&#x5165;&#x63D0;&#x53D6;&#x7801;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;</p>
<p><img src="../.gitbook/assets/1630240528228.png" alt="1630240528228"></p>
</li>
<li><p>&#x5F53;&#x6211;&#x4EEC;&#x4ECE;&#x522B;&#x4EBA;&#x53D1;&#x7ED9;&#x6211;&#x4EEC;&#x7684;&#x5185;&#x5BB9;&#x4E2D;&#x590D;&#x5236;&#x63D0;&#x53D6;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x591A;&#x590D;&#x5236;&#x5230;&#x4E00;&#x4E9B;&#x7A7A;&#x683C;&#xFF0C;&#x76F4;&#x63A5;&#x7C98;&#x8D34;&#x5230;&#x767E;&#x5EA6;&#x7684;&#x63D0;&#x53D6;&#x7801;&#x8F93;&#x5165;&#x6846;</p>
</li>
<li><p>&#x4F46;&#x662F;&#x767E;&#x5EA6;&#x90A3;&#x8FB9;&#x8BB0;&#x5F55;&#x7684;&#x63D0;&#x53D6;&#x7801;&#x662F;&#x6CA1;&#x6709;&#x7A7A;&#x683C;&#x7684;</p>
</li>
<li><p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5982;&#x679C;&#x4E0D;&#x505A;&#x5904;&#x7406;&#xFF0C;&#x76F4;&#x63A5;&#x5BF9;&#x6BD4;&#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4F1A;&#x5F15;&#x53D1;&#x63D0;&#x53D6;&#x7801;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x5BFC;&#x81F4;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x767E;&#x5EA6;&#x76D8;&#x4E0A;&#x7684;&#x5185;&#x5BB9;</p>
</li>
<li><p>&#x6240;&#x4EE5;&#x591A;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x9879;&#x76EE;&#x7684;&#x529F;&#x80FD;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x3002;</p>
</li>
<li><p>&#x6B64;&#x65F6;&#x6211;&#x4EEC;&#x5C31;&#x60F3;&#x80FD;&#x4E0D;&#x80FD;&#x5C06;&#x8F93;&#x5165;&#x7684;&#x53C2;&#x6570;&#x5148;&#x5E2E;&#x7528;&#x6237;&#x53BB;&#x6389;&#x7A7A;&#x683C;&#x518D;&#x64CD;&#x4F5C;&#x5462;?</p>
</li>
</ul>
<p>&#x7B54;&#x6848;&#x662F;&#x53EF;&#x4EE5;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5728;&#x4E1A;&#x52A1;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x683C;&#x5F0F;&#x5904;&#x7406;&#x2014;&#x2014;trim()</p>
<ul>
<li>&#x662F;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x53C2;&#x6570;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x9664;&#x7A7A;&#x683C;&#x4E48;?</li>
</ul>
<p>&#x4E5F;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x4E00;&#x822C;&#x53EA;&#x9700;&#x8981;&#x9488;&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x5373;&#x53EF;&#x3002;</p>
<ul>
<li>&#x4EE5;&#x540E;&#x6D89;&#x53CA;&#x5230;&#x9700;&#x8981;&#x53BB;&#x9664;&#x524D;&#x540E;&#x7A7A;&#x683C;&#x7684;&#x4E1A;&#x52A1;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x8FD9;&#x4E2A;&#x53BB;&#x7A7A;&#x683C;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x6BCF;&#x4E2A;&#x4E1A;&#x52A1;&#x90FD;&#x5199;&#x4E48;?</li>
</ul>
<p>&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;AOP&#x6765;&#x7EDF;&#x4E00;&#x5904;&#x7406;&#x3002;</p>
<ul>
<li>AOP&#x6709;&#x4E94;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#xFF0C;&#x8BE5;&#x4F7F;&#x7528;&#x54EA;&#x79CD;&#x5462;?</li>
</ul>
<p>&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;&#x662F;&#x5C06;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x5904;&#x7406;&#x540E;&#x5728;&#x53C2;&#x4E0E;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x80FD;&#x505A;&#x8FD9;&#x4EF6;&#x4E8B;&#x7684;&#x5C31;&#x53EA;&#x6709;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x3002;</p>
<p>&#x7EFC;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8003;&#x8651;&#x4E24;&#x4EF6;&#x4E8B;:
&#x2460;&#xFF1A;&#x5728;&#x4E1A;&#x52A1;&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x683C;&#x5F0F;&#x5904;&#x7406;&#x2014;&#x2014;trim()
&#x2461;&#xFF1A;&#x4F7F;&#x7528;&#x5904;&#x7406;&#x540E;&#x7684;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x2014;&#x2014;&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4E2D;&#x5B58;&#x5728;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;</p>
<h4 id="452-&#x73AF;&#x5883;&#x51C6;&#x5907;">4.5.2 &#x73AF;&#x5883;&#x51C6;&#x5907;</h4>
<ul>
<li><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;Maven&#x9879;&#x76EE;</p>
</li>
<li><p>pom.xml&#x6DFB;&#x52A0;Spring&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
</li>
<li><p>&#x6DFB;&#x52A0;ResourcesService&#xFF0C;ResourcesServiceImpl,ResourcesDao&#x548C;ResourcesDaoImpl&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ResourcesDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">readResources</span><span class="hljs-params">(String url, String password)</span></span>;
}
<span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResourcesDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ResourcesDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">readResources</span><span class="hljs-params">(String url, String password)</span> </span>{
        <span class="hljs-comment">//&#x6A21;&#x62DF;&#x6821;&#x9A8C;</span>
        <span class="hljs-keyword">return</span> password.equals(<span class="hljs-string">&quot;root&quot;</span>);
    }
}
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ResourcesService</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">openURL</span><span class="hljs-params">(String url ,String password)</span></span>;
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResourcesServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ResourcesService</span> </span>{
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ResourcesDao resourcesDao;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">openURL</span><span class="hljs-params">(String url, String password)</span> </span>{
        <span class="hljs-keyword">return</span> resourcesDao.readResources(url,password);
    }
}
</code></pre>
</li>
<li><p>&#x521B;&#x5EFA;Spring&#x7684;&#x914D;&#x7F6E;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
</li>
<li><p>&#x7F16;&#x5199;App&#x8FD0;&#x884C;&#x7C7B;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        ApplicationContext ctx = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(SpringConfig.class);
        ResourcesService resourcesService = ctx.getBean(ResourcesService.class);
        <span class="hljs-keyword">boolean</span> flag = resourcesService.openURL(<span class="hljs-string">&quot;http://pan.baidu.com/haha&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>);
        System.out.println(flag);
    }
}
</code></pre>
</li>
</ul>
<p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630241681697.png" alt="1630241681697"></p>
<p>&#x73B0;&#x5728;&#x9879;&#x76EE;&#x7684;&#x6548;&#x679C;&#x662F;&#xFF0C;&#x5F53;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#x4E3A;&quot;root&quot;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x4E3A;true,&#x5982;&#x679C;&#x5BC6;&#x7801;&#x6539;&#x4E3A;&quot;root  &quot;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x7684;&#x662F;false</p>
<p>&#x9700;&#x6C42;&#x662F;&#x4F7F;&#x7528;AOP&#x5C06;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;&#x5904;&#x7406;&#xFF0C;&#x4E0D;&#x7BA1;&#x8F93;&#x5165;&#x7684;&#x5BC6;&#x7801;<code>root</code>&#x524D;&#x540E;&#x5305;&#x542B;&#x591A;&#x5C11;&#x4E2A;&#x7A7A;&#x683C;&#xFF0C;&#x6700;&#x7EC8;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x7684;&#x90FD;&#x662F;true&#x3002;</p>
<h4 id="453-&#x5177;&#x4F53;&#x5B9E;&#x73B0;">4.5.3 &#x5177;&#x4F53;&#x5B9E;&#x73B0;</h4>
<h5 id="&#x6B65;&#x9AA4;1&#x5F00;&#x542F;springaop&#x7684;&#x6CE8;&#x89E3;&#x529F;&#x80FD;">&#x6B65;&#x9AA4;1:&#x5F00;&#x542F;SpringAOP&#x7684;&#x6CE8;&#x89E3;&#x529F;&#x80FD;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@EnableAspectJAutoProxy</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;2&#x7F16;&#x5199;&#x901A;&#x77E5;&#x7C7B;">&#x6B65;&#x9AA4;2:&#x7F16;&#x5199;&#x901A;&#x77E5;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(boolean com.itheima.service.*Service.*(*,*))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}

}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;3&#x6DFB;&#x52A0;&#x73AF;&#x7ED5;&#x901A;&#x77E5;">&#x6B65;&#x9AA4;3:&#x6DFB;&#x52A0;&#x73AF;&#x7ED5;&#x901A;&#x77E5;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(boolean com.itheima.service.*Service.*(*,*))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;DataAdvice.servicePt()&quot;</span>)
    <span class="hljs-comment">// @Around(&quot;servicePt()&quot;)&#x8FD9;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x90FD;&#x5BF9;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">trimStr</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable </span>{
        Object ret = pjp.proceed();
        <span class="hljs-keyword">return</span> ret;
    }

}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;4&#x5B8C;&#x6210;&#x6838;&#x5FC3;&#x4E1A;&#x52A1;&#xFF0C;&#x5904;&#x7406;&#x53C2;&#x6570;&#x4E2D;&#x7684;&#x7A7A;&#x683C;">&#x6B65;&#x9AA4;4:&#x5B8C;&#x6210;&#x6838;&#x5FC3;&#x4E1A;&#x52A1;&#xFF0C;&#x5904;&#x7406;&#x53C2;&#x6570;&#x4E2D;&#x7684;&#x7A7A;&#x683C;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataAdvice</span> </span>{
    <span class="hljs-meta">@Pointcut</span>(<span class="hljs-string">&quot;execution(boolean com.itheima.service.*Service.*(*,*))&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">servicePt</span><span class="hljs-params">()</span></span>{}

    <span class="hljs-meta">@Around</span>(<span class="hljs-string">&quot;DataAdvice.servicePt()&quot;</span>)
    <span class="hljs-comment">// @Around(&quot;servicePt()&quot;)&#x8FD9;&#x4E24;&#x79CD;&#x5199;&#x6CD5;&#x90FD;&#x5BF9;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">trimStr</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable </span>{
        <span class="hljs-comment">//&#x83B7;&#x53D6;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;</span>
        Object[] args = pjp.getArgs();
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; args.length; i++) {
            <span class="hljs-comment">//&#x5224;&#x65AD;&#x53C2;&#x6570;&#x662F;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;</span>
            <span class="hljs-keyword">if</span>(args[i].getClass().equals(String.class)){
                args[i] = args[i].toString().trim();
            }
        }
        <span class="hljs-comment">//&#x5C06;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x5230;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x4E2D;</span>
        Object ret = pjp.proceed(args);
        <span class="hljs-keyword">return</span> ret;
    }

}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;5&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;">&#x6B65;&#x9AA4;5:&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;</h5>
<p>&#x4E0D;&#x7BA1;&#x5BC6;&#x7801;<code>root</code>&#x524D;&#x540E;&#x662F;&#x5426;&#x52A0;&#x7A7A;&#x683C;&#xFF0C;&#x6700;&#x7EC8;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x7684;&#x90FD;&#x662F;true</p>
<h5 id="&#x6B65;&#x9AA4;6&#x4F18;&#x5316;&#x6D4B;&#x8BD5;">&#x6B65;&#x9AA4;6:&#x4F18;&#x5316;&#x6D4B;&#x8BD5;</h5>
<p>&#x4E3A;&#x4E86;&#x80FD;&#x66F4;&#x597D;&#x7684;&#x770B;&#x51FA;AOP&#x5DF2;&#x7ECF;&#x751F;&#x6548;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;ResourcesImpl&#x7C7B;&#xFF0C;&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#x5C06;&#x5BC6;&#x7801;&#x7684;&#x957F;&#x5EA6;&#x8FDB;&#x884C;&#x6253;&#x5370;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResourcesDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ResourcesDao</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">readResources</span><span class="hljs-params">(String url, String password)</span> </span>{
        System.out.println(password.length());
        <span class="hljs-comment">//&#x6A21;&#x62DF;&#x6821;&#x9A8C;</span>
        <span class="hljs-keyword">return</span> password.equals(<span class="hljs-string">&quot;root&quot;</span>);
    }
}
</code></pre>
<p>&#x518D;&#x6B21;&#x8FD0;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x6700;&#x7EC8;&#x6253;&#x5370;&#x7684;&#x957F;&#x5EA6;&#x6765;&#x770B;&#x770B;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x7A7A;&#x683C;&#x6709;&#x6CA1;&#x6709;&#x88AB;&#x53BB;&#x9664;&#x6389;&#x3002;</p>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong></p>
<p><img src="../.gitbook/assets/1630242491831.png" alt="1630242491831"></p>
<h2 id="5&#x3001;aop&#x603B;&#x7ED3;">5&#x3001;AOP&#x603B;&#x7ED3;</h2>
<p>AOP&#x7684;&#x77E5;&#x8BC6;&#x5C31;&#x5DF2;&#x7ECF;&#x8BB2;&#x89E3;&#x5B8C;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5BF9;&#x4E8E;AOP&#x7684;&#x77E5;&#x8BC6;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x603B;&#x7ED3;:</p>
<h3 id="51-aop&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;">5.1 AOP&#x7684;&#x6838;&#x5FC3;&#x6982;&#x5FF5;</h3>
<ul>
<li>&#x6982;&#x5FF5;&#xFF1A;AOP(Aspect Oriented Programming)&#x9762;&#x5411;&#x5207;&#x9762;&#x7F16;&#x7A0B;&#xFF0C;&#x4E00;&#x79CD;&#x7F16;&#x7A0B;&#x8303;&#x5F0F;</li>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x5728;&#x4E0D;&#x60CA;&#x52A8;&#x539F;&#x59CB;&#x8BBE;&#x8BA1;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x4E3A;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x529F;&#x80FD;==&#x589E;&#x5F3A;==</li>
<li>&#x6838;&#x5FC3;&#x6982;&#x5FF5;<ul>
<li>&#x4EE3;&#x7406;&#xFF08;Proxy&#xFF09;&#xFF1A;SpringAOP&#x7684;&#x6838;&#x5FC3;&#x672C;&#x8D28;&#x662F;&#x91C7;&#x7528;&#x4EE3;&#x7406;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;</li>
<li>&#x8FDE;&#x63A5;&#x70B9;&#xFF08;JoinPoint&#xFF09;&#xFF1A;&#x5728;SpringAOP&#x4E2D;&#xFF0C;&#x7406;&#x89E3;&#x4E3A;&#x4EFB;&#x610F;&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;</li>
<li>&#x5207;&#x5165;&#x70B9;&#xFF08;Pointcut&#xFF09;&#xFF1A;&#x5339;&#x914D;&#x8FDE;&#x63A5;&#x70B9;&#x7684;&#x5F0F;&#x5B50;&#xFF0C;&#x4E5F;&#x662F;&#x5177;&#x6709;&#x5171;&#x6027;&#x529F;&#x80FD;&#x7684;&#x65B9;&#x6CD5;&#x63CF;&#x8FF0;</li>
<li>&#x901A;&#x77E5;&#xFF08;Advice&#xFF09;&#xFF1A;&#x82E5;&#x5E72;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x5171;&#x6027;&#x529F;&#x80FD;&#xFF0C;&#x5728;&#x5207;&#x5165;&#x70B9;&#x5904;&#x6267;&#x884C;&#xFF0C;&#x6700;&#x7EC8;&#x4F53;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;</li>
<li>&#x5207;&#x9762;&#xFF08;Aspect&#xFF09;&#xFF1A;&#x63CF;&#x8FF0;&#x901A;&#x77E5;&#x4E0E;&#x5207;&#x5165;&#x70B9;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;</li>
<li>&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#xFF08;Target&#xFF09;&#xFF1A;&#x88AB;&#x4EE3;&#x7406;&#x7684;&#x539F;&#x59CB;&#x5BF9;&#x8C61;&#x6210;&#x4E3A;&#x76EE;&#x6807;&#x5BF9;&#x8C61;</li>
</ul>
</li>
</ul>
<h3 id="52-&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;">5.2 &#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;</h3>
<ul>
<li><p>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#xFF1A;&#x52A8;&#x4F5C;&#x5173;&#x952E;&#x5B57;(&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;  &#x8FD4;&#x56DE;&#x503C;  &#x5305;&#x540D;.&#x7C7B;/&#x63A5;&#x53E3;&#x540D;.&#x65B9;&#x6CD5;&#x540D;&#xFF08;&#x53C2;&#x6570;&#xFF09;&#x5F02;&#x5E38;&#x540D;)</p>
<pre><code>execution(* com.itheima.service.*Service.*(..))
</code></pre></li>
<li><p>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x63CF;&#x8FF0;&#x901A;&#x914D;&#x7B26;&#xFF1A;</p>
<ul>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x7528;&#x4E8E;&#x5FEB;&#x901F;&#x63CF;&#x8FF0;&#xFF0C;&#x8303;&#x56F4;&#x63CF;&#x8FF0;</li>
<li><code>*</code>&#xFF1A;&#x5339;&#x914D;&#x4EFB;&#x610F;&#x7B26;&#x53F7;&#xFF08;&#x5E38;&#x7528;&#xFF09;</li>
<li><code>..</code> &#xFF1A;&#x5339;&#x914D;&#x591A;&#x4E2A;&#x8FDE;&#x7EED;&#x7684;&#x4EFB;&#x610F;&#x7B26;&#x53F7;&#xFF08;&#x5E38;&#x7528;&#xFF09;</li>
<li><code>+</code>&#xFF1A;&#x5339;&#x914D;&#x5B50;&#x7C7B;&#x7C7B;&#x578B;</li>
</ul>
</li>
<li><p>&#x5207;&#x5165;&#x70B9;&#x8868;&#x8FBE;&#x5F0F;&#x4E66;&#x5199;&#x6280;&#x5DE7;</p>
<p>1.&#x6309;==&#x6807;&#x51C6;&#x89C4;&#x8303;==&#x5F00;&#x53D1;
2.&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;*&#x5339;&#x914D;
3.&#x51CF;&#x5C11;&#x4F7F;&#x7528;..&#x7684;&#x5F62;&#x5F0F;&#x63CF;&#x8FF0;&#x5305;
4.==&#x5BF9;&#x63A5;&#x53E3;&#x8FDB;&#x884C;&#x63CF;&#x8FF0;==&#xFF0C;&#x4F7F;&#x7528;*&#x8868;&#x793A;&#x6A21;&#x5757;&#x540D;&#xFF0C;&#x4F8B;&#x5982;UserService&#x7684;&#x5339;&#x914D;&#x63CF;&#x8FF0;&#x4E3A;<em>Service
5.&#x65B9;&#x6CD5;&#x540D;&#x4E66;&#x5199;&#x4FDD;&#x7559;&#x52A8;&#x8BCD;&#xFF0C;&#x4F8B;&#x5982;get&#xFF0C;&#x4F7F;&#x7528;\</em>&#x8868;&#x793A;&#x540D;&#x8BCD;&#xFF0C;&#x4F8B;&#x5982;getById&#x5339;&#x914D;&#x63CF;&#x8FF0;&#x4E3A;getBy*
6.&#x53C2;&#x6570;&#x6839;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x7075;&#x6D3B;&#x8C03;&#x6574;</p>
</li>
</ul>
<h3 id="53-&#x4E94;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;">5.3 &#x4E94;&#x79CD;&#x901A;&#x77E5;&#x7C7B;&#x578B;</h3>
<ul>
<li>&#x524D;&#x7F6E;&#x901A;&#x77E5;</li>
<li>&#x540E;&#x7F6E;&#x901A;&#x77E5;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#xFF08;&#x91CD;&#x70B9;&#xFF09;<ul>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4F9D;&#x8D56;&#x5F62;&#x53C2;ProceedingJoinPoint&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x53EF;&#x4EE5;&#x9694;&#x79BB;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x6267;&#x884C;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x8FD4;&#x56DE;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;Object&#x7C7B;&#x578B;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;&#x4E2D;&#x53EF;&#x4EE5;&#x5BF9;&#x539F;&#x59CB;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x5F02;&#x5E38;&#x8FDB;&#x884C;&#x5904;&#x7406;</li>
</ul>
</li>
<li>&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;</li>
<li>&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</li>
</ul>
<h3 id="54-&#x901A;&#x77E5;&#x4E2D;&#x83B7;&#x53D6;&#x53C2;&#x6570;">5.4 &#x901A;&#x77E5;&#x4E2D;&#x83B7;&#x53D6;&#x53C2;&#x6570;</h3>
<ul>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x901A;&#x77E5;&#x7C7B;&#x578B;&#x90FD;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x53C2;&#x6570;<ul>
<li>JoinPoint&#xFF1A;&#x9002;&#x7528;&#x4E8E;&#x524D;&#x7F6E;&#x3001;&#x540E;&#x7F6E;&#x3001;&#x8FD4;&#x56DE;&#x540E;&#x3001;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</li>
<li>ProceedingJoinPoint&#xFF1A;&#x9002;&#x7528;&#x4E8E;&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x524D;&#x7F6E;&#x548C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;&#x662F;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x540E;&#x7F6E;&#x901A;&#x77E5;&#x53EF;&#x6709;&#x53EF;&#x65E0;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x505A;&#x7814;&#x7A76;<ul>
<li>&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
<li>&#x83B7;&#x53D6;&#x5207;&#x5165;&#x70B9;&#x65B9;&#x6CD5;&#x8FD0;&#x884C;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#xFF0C;&#x524D;&#x7F6E;&#x548C;&#x8FD4;&#x56DE;&#x540E;&#x901A;&#x77E5;&#x662F;&#x4E0D;&#x4F1A;&#x6709;&#xFF0C;&#x540E;&#x7F6E;&#x901A;&#x77E5;&#x53EF;&#x6709;&#x53EF;&#x65E0;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x505A;&#x7814;&#x7A76;<ul>
<li>&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x540E;&#x901A;&#x77E5;</li>
<li>&#x73AF;&#x7ED5;&#x901A;&#x77E5;</li>
</ul>
</li>
</ul>
<h2 id="6&#x3001;aop&#x4E8B;&#x52A1;&#x7BA1;&#x7406;">6&#x3001;AOP&#x4E8B;&#x52A1;&#x7BA1;&#x7406;</h2>
<h3 id="61-spring&#x4E8B;&#x52A1;&#x7B80;&#x4ECB;">6.1 Spring&#x4E8B;&#x52A1;&#x7B80;&#x4ECB;</h3>
<h4 id="611-&#x76F8;&#x5173;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;">6.1.1 &#x76F8;&#x5173;&#x6982;&#x5FF5;&#x4ECB;&#x7ECD;</h4>
<ul>
<li>&#x4E8B;&#x52A1;&#x4F5C;&#x7528;&#xFF1A;&#x5728;&#x6570;&#x636E;&#x5C42;&#x4FDD;&#x969C;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x6570;&#x636E;&#x5E93;&#x64CD;&#x4F5C;&#x540C;&#x6210;&#x529F;&#x540C;&#x5931;&#x8D25;</li>
<li>Spring&#x4E8B;&#x52A1;&#x4F5C;&#x7528;&#xFF1A;&#x5728;&#x6570;&#x636E;&#x5C42;&#x6216;<strong>==&#x4E1A;&#x52A1;&#x5C42;==</strong>&#x4FDD;&#x969C;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x6570;&#x636E;&#x5E93;&#x64CD;&#x4F5C;&#x540C;&#x6210;&#x529F;&#x540C;&#x5931;&#x8D25;</li>
</ul>
<p>&#x6570;&#x636E;&#x5C42;&#x6709;&#x4E8B;&#x52A1;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x4E1A;&#x52A1;&#x5C42;&#x4E5F;&#x9700;&#x8981;&#x5904;&#x7406;&#x4E8B;&#x52A1;&#x5462;?</p>
<p>&#x4E3E;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;</p>
<ul>
<li>&#x8F6C;&#x8D26;&#x4E1A;&#x52A1;&#x4F1A;&#x6709;&#x4E24;&#x6B21;&#x6570;&#x636E;&#x5C42;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4E00;&#x6B21;&#x662F;&#x52A0;&#x94B1;&#x4E00;&#x6B21;&#x662F;&#x51CF;&#x94B1;</li>
<li>&#x628A;&#x4E8B;&#x52A1;&#x653E;&#x5728;&#x6570;&#x636E;&#x5C42;&#xFF0C;&#x52A0;&#x94B1;&#x548C;&#x51CF;&#x94B1;&#x5C31;&#x6709;&#x4E24;&#x4E2A;&#x4E8B;&#x52A1;</li>
<li>&#x6CA1;&#x529E;&#x6CD5;&#x4FDD;&#x8BC1;&#x52A0;&#x94B1;&#x548C;&#x51CF;&#x94B1;&#x540C;&#x65F6;&#x6210;&#x529F;&#x6216;&#x8005;&#x540C;&#x65F6;&#x5931;&#x8D25;</li>
<li>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x5C06;&#x4E8B;&#x52A1;&#x653E;&#x5728;&#x4E1A;&#x52A1;&#x5C42;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</li>
</ul>
<p>Spring&#x4E3A;&#x4E86;&#x7BA1;&#x7406;&#x4E8B;&#x52A1;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5E73;&#x53F0;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;<code>PlatformTransactionManager</code></p>
<p><img src="../.gitbook/assets/1630243651541.png" alt="1630243651541"></p>
<p>commit&#x662F;&#x7528;&#x6765;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#xFF0C;rollback&#x662F;&#x7528;&#x6765;&#x56DE;&#x6EDA;&#x4E8B;&#x52A1;&#x3002;</p>
<p>PlatformTransactionManager&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;Spring&#x8FD8;&#x4E3A;&#x5176;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;:</p>
<p><img src="../.gitbook/assets/1630243993380.png" alt="1630243993380"></p>
<p>&#x4ECE;&#x540D;&#x79F0;&#x4E0A;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x7ED9;&#x5B83;&#x4E00;&#x4E2A;DataSource&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x5C31;&#x53EF;&#x4EE5;&#x5E2E;&#x4F60;&#x53BB;&#x5728;&#x4E1A;&#x52A1;&#x5C42;&#x7BA1;&#x7406;&#x4E8B;&#x52A1;&#x3002;&#x5176;&#x5185;&#x90E8;&#x91C7;&#x7528;&#x7684;&#x662F;JDBC&#x7684;&#x4E8B;&#x52A1;&#x3002;&#x6240;&#x4EE5;&#x8BF4;&#x5982;&#x679C;&#x4F60;&#x6301;&#x4E45;&#x5C42;&#x91C7;&#x7528;&#x7684;&#x662F;JDBC&#x76F8;&#x5173;&#x7684;&#x6280;&#x672F;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x8FD9;&#x4E2A;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;&#x6765;&#x7BA1;&#x7406;&#x4F60;&#x7684;&#x4E8B;&#x52A1;&#x3002;&#x800C;Mybatis&#x5185;&#x90E8;&#x91C7;&#x7528;&#x7684;&#x5C31;&#x662F;JDBC&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x6240;&#x4EE5;&#x540E;&#x671F;&#x6211;&#x4EEC;Spring&#x6574;&#x5408;Mybatis&#x5C31;&#x91C7;&#x7528;&#x7684;&#x8FD9;&#x4E2A;DataSourceTransactionManager&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;&#x3002;</p>
<h4 id="612-&#x8F6C;&#x8D26;&#x6848;&#x4F8B;-&#x9700;&#x6C42;&#x5206;&#x6790;">6.1.2 &#x8F6C;&#x8D26;&#x6848;&#x4F8B;-&#x9700;&#x6C42;&#x5206;&#x6790;</h4>
<p>&#x63A5;&#x4E0B;&#x6765;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6848;&#x4F8B;&#x6765;&#x5B66;&#x4E60;&#x4E0B;Spring&#x662F;&#x5982;&#x4F55;&#x6765;&#x7BA1;&#x7406;&#x4E8B;&#x52A1;&#x7684;&#x3002;</p>
<p>&#x5148;&#x6765;&#x5206;&#x6790;&#x4E0B;&#x9700;&#x6C42;:</p>
<p>&#x9700;&#x6C42;: &#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x4E24;&#x4E2A;&#x8D26;&#x6237;&#x95F4;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;</p>
<p>&#x9700;&#x6C42;&#x5FAE;&#x7F29;: A&#x8D26;&#x6237;&#x51CF;&#x94B1;&#xFF0C;B&#x8D26;&#x6237;&#x52A0;&#x94B1;</p>
<p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x4E0A;&#x8FF0;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x4E0B;&#x9762;&#x6B65;&#x9AA4;&#x6765;&#x5B9E;&#x73B0;&#x4E0B;:
&#x2460;&#xFF1A;&#x6570;&#x636E;&#x5C42;&#x63D0;&#x4F9B;&#x57FA;&#x7840;&#x64CD;&#x4F5C;&#xFF0C;&#x6307;&#x5B9A;&#x8D26;&#x6237;&#x51CF;&#x94B1;&#xFF08;outMoney&#xFF09;&#xFF0C;&#x6307;&#x5B9A;&#x8D26;&#x6237;&#x52A0;&#x94B1;&#xFF08;inMoney&#xFF09;</p>
<p>&#x2461;&#xFF1A;&#x4E1A;&#x52A1;&#x5C42;&#x63D0;&#x4F9B;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#xFF08;transfer&#xFF09;&#xFF0C;&#x8C03;&#x7528;&#x51CF;&#x94B1;&#x4E0E;&#x52A0;&#x94B1;&#x7684;&#x64CD;&#x4F5C;</p>
<p>&#x2462;&#xFF1A;&#x63D0;&#x4F9B;2&#x4E2A;&#x8D26;&#x53F7;&#x548C;&#x64CD;&#x4F5C;&#x91D1;&#x989D;&#x6267;&#x884C;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;</p>
<p>&#x2463;&#xFF1A;&#x57FA;&#x4E8E;Spring&#x6574;&#x5408;MyBatis&#x73AF;&#x5883;&#x642D;&#x5EFA;&#x4E0A;&#x8FF0;&#x64CD;&#x4F5C;</p>
<h4 id="613-&#x8F6C;&#x8D26;&#x6848;&#x4F8B;-&#x73AF;&#x5883;&#x642D;&#x5EFA;">6.1.3 &#x8F6C;&#x8D26;&#x6848;&#x4F8B;-&#x73AF;&#x5883;&#x642D;&#x5EFA;</h4>
<h5 id="&#x6B65;&#x9AA4;1&#x51C6;&#x5907;&#x6570;&#x636E;&#x5E93;&#x8868;">&#x6B65;&#x9AA4;1:&#x51C6;&#x5907;&#x6570;&#x636E;&#x5E93;&#x8868;</h5>
<p>&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x5728;&#x6574;&#x5408;Mybatis&#x7684;&#x65F6;&#x5019;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x8FD9;&#x4E2A;&#x8868;,&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;</p>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">database</span> spring_db <span class="hljs-built_in">character</span> <span class="hljs-keyword">set</span> utf8;
<span class="hljs-keyword">use</span> spring_db;
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tbl_account(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span> auto_increment,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">35</span>),
    money <span class="hljs-keyword">double</span>
);
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tbl_account <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>,<span class="hljs-string">&apos;Tom&apos;</span>,<span class="hljs-number">1000</span>);
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> tbl_account <span class="hljs-keyword">values</span>(<span class="hljs-number">2</span>,<span class="hljs-string">&apos;Jerry&apos;</span>,<span class="hljs-number">1000</span>);
</code></pre>
<h5 id="&#x6B65;&#x9AA4;2&#x521B;&#x5EFA;&#x9879;&#x76EE;&#x5BFC;&#x5165;jar&#x5305;">&#x6B65;&#x9AA4;2:&#x521B;&#x5EFA;&#x9879;&#x76EE;&#x5BFC;&#x5165;jar&#x5305;</h5>
<p>&#x9879;&#x76EE;&#x7684;pom.xml&#x6DFB;&#x52A0;&#x76F8;&#x5173;&#x4F9D;&#x8D56;</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h5 id="&#x6B65;&#x9AA4;3&#x6839;&#x636E;&#x8868;&#x521B;&#x5EFA;&#x6A21;&#x578B;&#x7C7B;">&#x6B65;&#x9AA4;3:&#x6839;&#x636E;&#x8868;&#x521B;&#x5EFA;&#x6A21;&#x578B;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{

    <span class="hljs-keyword">private</span> Integer id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Double money;
    <span class="hljs-comment">//setter...getter...toString...&#x65B9;&#x6CD5;&#x7565;    </span>
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;4&#x521B;&#x5EFA;dao&#x63A5;&#x53E3;">&#x6B65;&#x9AA4;4:&#x521B;&#x5EFA;Dao&#x63A5;&#x53E3;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountDao</span> </span>{

    <span class="hljs-meta">@Update</span>(<span class="hljs-string">&quot;update tbl_account set money = money + #{money} where name = #{name}&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">inMoney</span><span class="hljs-params">(@Param(<span class="hljs-string">&quot;name&quot;</span>)</span> String name, @<span class="hljs-title">Param</span><span class="hljs-params">(<span class="hljs-string">&quot;money&quot;</span>)</span> Double money)</span>;

    <span class="hljs-meta">@Update</span>(<span class="hljs-string">&quot;update tbl_account set money = money - #{money} where name = #{name}&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">outMoney</span><span class="hljs-params">(@Param(<span class="hljs-string">&quot;name&quot;</span>)</span> String name, @<span class="hljs-title">Param</span><span class="hljs-params">(<span class="hljs-string">&quot;money&quot;</span>)</span> Double money)</span>;
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;5&#x521B;&#x5EFA;service&#x63A5;&#x53E3;&#x548C;&#x5B9E;&#x73B0;&#x7C7B;">&#x6B65;&#x9AA4;5:&#x521B;&#x5EFA;Service&#x63A5;&#x53E3;&#x548C;&#x5B9E;&#x73B0;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountService</span> </span>{
    <span class="hljs-comment">/**
     * &#x8F6C;&#x8D26;&#x64CD;&#x4F5C;
     * <span class="hljs-doctag">@param</span> out &#x4F20;&#x51FA;&#x65B9;
     * <span class="hljs-doctag">@param</span> in &#x8F6C;&#x5165;&#x65B9;
     * <span class="hljs-doctag">@param</span> money &#x91D1;&#x989D;
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>;
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>{
        accountDao.outMoney(out,money);
        accountDao.inMoney(in,money);
    }

}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;6&#x6DFB;&#x52A0;jdbcproperties&#x6587;&#x4EF6;">&#x6B65;&#x9AA4;6:&#x6DFB;&#x52A0;jdbc.properties&#x6587;&#x4EF6;</h5>
<pre><code class="lang-properties">jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/spring_db?useSSL=false
jdbc.username=root
jdbc.password=root
</code></pre>
<h5 id="&#x6B65;&#x9AA4;7&#x521B;&#x5EFA;jdbcconfig&#x914D;&#x7F6E;&#x7C7B;">&#x6B65;&#x9AA4;7:&#x521B;&#x5EFA;JdbcConfig&#x914D;&#x7F6E;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcConfig</span> </span>{
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.driver}&quot;</span>)
    <span class="hljs-keyword">private</span> String driver;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.url}&quot;</span>)
    <span class="hljs-keyword">private</span> String url;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.username}&quot;</span>)
    <span class="hljs-keyword">private</span> String userName;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.password}&quot;</span>)
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">dataSource</span><span class="hljs-params">()</span></span>{
        DruidDataSource ds = <span class="hljs-keyword">new</span> DruidDataSource();
        ds.setDriverClassName(driver);
        ds.setUrl(url);
        ds.setUsername(userName);
        ds.setPassword(password);
        <span class="hljs-keyword">return</span> ds;
    }
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;8&#x521B;&#x5EFA;mybatisconfig&#x914D;&#x7F6E;&#x7C7B;">&#x6B65;&#x9AA4;8:&#x521B;&#x5EFA;MybatisConfig&#x914D;&#x7F6E;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisConfig</span> </span>{

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> SqlSessionFactoryBean <span class="hljs-title">sqlSessionFactory</span><span class="hljs-params">(DataSource dataSource)</span></span>{
        SqlSessionFactoryBean ssfb = <span class="hljs-keyword">new</span> SqlSessionFactoryBean();
        ssfb.setTypeAliasesPackage(<span class="hljs-string">&quot;com.itheima.domain&quot;</span>);
        ssfb.setDataSource(dataSource);
        <span class="hljs-keyword">return</span> ssfb;
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MapperScannerConfigurer <span class="hljs-title">mapperScannerConfigurer</span><span class="hljs-params">()</span></span>{
        MapperScannerConfigurer msc = <span class="hljs-keyword">new</span> MapperScannerConfigurer();
        msc.setBasePackage(<span class="hljs-string">&quot;com.itheima.dao&quot;</span>);
        <span class="hljs-keyword">return</span> msc;
    }
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;9&#x521B;&#x5EFA;springconfig&#x914D;&#x7F6E;&#x7C7B;">&#x6B65;&#x9AA4;9:&#x521B;&#x5EFA;SpringConfig&#x914D;&#x7F6E;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@PropertySource</span>(<span class="hljs-string">&quot;classpath:jdbc.properties&quot;</span>)
<span class="hljs-meta">@Import</span>({JdbcConfig.class,MybatisConfig.class})
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;10&#x7F16;&#x5199;&#x6D4B;&#x8BD5;&#x7C7B;">&#x6B65;&#x9AA4;10:&#x7F16;&#x5199;&#x6D4B;&#x8BD5;&#x7C7B;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@RunWith</span>(SpringJUnit4ClassRunner.class)
<span class="hljs-meta">@ContextConfiguration</span>(classes = SpringConfig.class)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceTest</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountService accountService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testTransfer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>{
        accountService.transfer(<span class="hljs-string">&quot;Tom&quot;</span>,<span class="hljs-string">&quot;Jerry&quot;</span>,<span class="hljs-number">100</span>D);
    }

}
</code></pre>
<p>&#x6700;&#x7EC8;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x9879;&#x76EE;&#x7ED3;&#x6784;&#x5982;&#x4E0B;:</p>
<p><img src="../.gitbook/assets/1630247220645.png" alt="1630247220645"></p>
<h4 id="614-&#x4E8B;&#x52A1;&#x7BA1;&#x7406;">6.1.4 &#x4E8B;&#x52A1;&#x7BA1;&#x7406;</h4>
<p>&#x4E0A;&#x8FF0;&#x73AF;&#x5883;&#xFF0C;&#x8FD0;&#x884C;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7C7B;&#xFF0C;&#x4F1A;&#x6267;&#x884C;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#xFF0C;<code>Tom</code>&#x7684;&#x8D26;&#x6237;&#x4F1A;&#x51CF;&#x5C11;100&#xFF0C;<code>Jerry</code>&#x7684;&#x8D26;&#x6237;&#x4F1A;&#x52A0;100&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x8FD0;&#x884C;&#x7ED3;&#x679C;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x5728;&#x8F6C;&#x8D26;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x5F02;&#x5E38;&#xFF0C;&#x5982;:</p>
<pre><code class="lang-java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>{
        accountDao.outMoney(out,money);
        <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>/<span class="hljs-number">0</span>;
        accountDao.inMoney(in,money);
    }

}
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x6A21;&#x62DF;&#x4E86;&#x8F6C;&#x8D26;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6B63;&#x786E;&#x7684;&#x64CD;&#x4F5C;&#x5E94;&#x8BE5;&#x662F;&#x8F6C;&#x8D26;&#x51FA;&#x95EE;&#x9898;&#x4E86;&#xFF0C;<code>Tom</code>&#x5E94;&#x8BE5;&#x8FD8;&#x662F;900&#xFF0C;<code>Jerry</code>&#x5E94;&#x8BE5;&#x8FD8;&#x662F;1100&#xFF0C;&#x4F46;&#x662F;&#x771F;&#x6B63;&#x8FD0;&#x884C;&#x540E;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x50CF;&#x6211;&#x4EEC;&#x60F3;&#x8C61;&#x7684;&#x90A3;&#x6837;&#xFF0C;<code>Tom</code>&#x8D26;&#x6237;&#x4E3A;800&#x800C;<code>Jerry</code>&#x8FD8;&#x662F;1100,100&#x5757;&#x94B1;&#x51ED;&#x7A7A;&#x6D88;&#x606F;&#x4E86;&#xFF0C;&#x94F6;&#x884C;&#x4E50;&#x75AF;&#x4E86;&#x3002;&#x5982;&#x679C;&#x628A;&#x8F6C;&#x8D26;&#x6362;&#x4E2A;&#x987A;&#x5E8F;&#xFF0C;&#x94F6;&#x884C;&#x5C31;&#x8BE5;&#x54ED;&#x4E86;&#x3002;</p>
<p>&#x4E0D;&#x7BA1;&#x54EA;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x90FD;&#x662F;&#x4E0D;&#x5141;&#x8BB8;&#x51FA;&#x73B0;&#x7684;&#xFF0C;&#x5BF9;&#x521A;&#x624D;&#x7684;&#x7ED3;&#x679C;&#x6211;&#x4EEC;&#x505A;&#x4E00;&#x4E2A;&#x5206;&#x6790;:</p>
<p>&#x2460;&#xFF1A;&#x7A0B;&#x5E8F;&#x6B63;&#x5E38;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x8D26;&#x6237;&#x91D1;&#x989D;A&#x51CF;B&#x52A0;&#xFF0C;&#x6CA1;&#x6709;&#x95EE;&#x9898;</p>
<p>&#x2461;&#xFF1A;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x540E;&#xFF0C;&#x8F6C;&#x8D26;&#x5931;&#x8D25;&#xFF0C;&#x4F46;&#x662F;&#x5F02;&#x5E38;&#x4E4B;&#x524D;&#x64CD;&#x4F5C;&#x6210;&#x529F;&#xFF0C;&#x5F02;&#x5E38;&#x4E4B;&#x540E;&#x64CD;&#x4F5C;&#x5931;&#x8D25;&#xFF0C;&#x6574;&#x4F53;&#x4E1A;&#x52A1;&#x5931;&#x8D25;</p>
<p>&#x5F53;&#x7A0B;&#x5E8F;&#x51FA;&#x95EE;&#x9898;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BA9;&#x4E8B;&#x52A1;&#x8FDB;&#x884C;&#x56DE;&#x6EDA;&#xFF0C;&#x800C;&#x4E14;&#x8FD9;&#x4E2A;&#x4E8B;&#x52A1;&#x5E94;&#x8BE5;&#x662F;&#x52A0;&#x5728;&#x4E1A;&#x52A1;&#x5C42;&#x4E0A;&#xFF0C;&#x800C;Spring&#x7684;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5C31;&#x662F;&#x7528;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x7684;&#x3002;</p>
<p>Spring&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x6B65;&#x9AA4;&#x4E3A;:</p>
<h5 id="&#x6B65;&#x9AA4;1&#x5728;&#x9700;&#x8981;&#x88AB;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x4E0A;&#x6DFB;&#x52A0;&#x6CE8;&#x89E3;">&#x6B65;&#x9AA4;1:&#x5728;&#x9700;&#x8981;&#x88AB;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x7684;&#x65B9;&#x6CD5;&#x4E0A;&#x6DFB;&#x52A0;&#x6CE8;&#x89E3;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountService</span> </span>{
    <span class="hljs-comment">/**
     * &#x8F6C;&#x8D26;&#x64CD;&#x4F5C;
     * <span class="hljs-doctag">@param</span> out &#x4F20;&#x51FA;&#x65B9;
     * <span class="hljs-doctag">@param</span> in &#x8F6C;&#x5165;&#x65B9;
     * <span class="hljs-doctag">@param</span> money &#x91D1;&#x989D;
     */</span>
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x5F53;&#x524D;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x5177;&#x6709;&#x4E8B;&#x52A1;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>;
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>{
        accountDao.outMoney(out,money);
        <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>/<span class="hljs-number">0</span>;
        accountDao.inMoney(in,money);
    }

}
</code></pre>
<p>==&#x6CE8;&#x610F;:==</p>
<p>@Transactional&#x53EF;&#x4EE5;&#x5199;&#x5728;&#x63A5;&#x53E3;&#x7C7B;&#x4E0A;&#x3001;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x4E0A;&#x3001;&#x5B9E;&#x73B0;&#x7C7B;&#x4E0A;&#x548C;&#x5B9E;&#x73B0;&#x7C7B;&#x65B9;&#x6CD5;&#x4E0A;</p>
<ul>
<li>&#x5199;&#x5728;&#x63A5;&#x53E3;&#x7C7B;&#x4E0A;&#xFF0C;&#x8BE5;&#x63A5;&#x53E3;&#x7684;&#x6240;&#x6709;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x6709;&#x4E8B;&#x52A1;</li>
<li>&#x5199;&#x5728;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x4E0A;&#xFF0C;&#x8BE5;&#x63A5;&#x53E3;&#x7684;&#x6240;&#x6709;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x8BE5;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x6709;&#x4E8B;&#x52A1;</li>
<li>&#x5199;&#x5728;&#x5B9E;&#x73B0;&#x7C7B;&#x4E0A;&#xFF0C;&#x8BE5;&#x7C7B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x90FD;&#x4F1A;&#x6709;&#x4E8B;&#x52A1;</li>
<li>&#x5199;&#x5728;&#x5B9E;&#x73B0;&#x7C7B;&#x65B9;&#x6CD5;&#x4E0A;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4E0A;&#x6709;&#x4E8B;&#x52A1;</li>
<li>==&#x5EFA;&#x8BAE;&#x5199;&#x5728;&#x5B9E;&#x73B0;&#x7C7B;&#x6216;&#x5B9E;&#x73B0;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x4E0A;==</li>
</ul>
<h5 id="&#x6B65;&#x9AA4;2&#x5728;jdbcconfig&#x7C7B;&#x4E2D;&#x914D;&#x7F6E;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;">&#x6B65;&#x9AA4;2:&#x5728;JdbcConfig&#x7C7B;&#x4E2D;&#x914D;&#x7F6E;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;</h5>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JdbcConfig</span> </span>{
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.driver}&quot;</span>)
    <span class="hljs-keyword">private</span> String driver;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.url}&quot;</span>)
    <span class="hljs-keyword">private</span> String url;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.username}&quot;</span>)
    <span class="hljs-keyword">private</span> String userName;
    <span class="hljs-meta">@Value</span>(<span class="hljs-string">&quot;${jdbc.password}&quot;</span>)
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> DataSource <span class="hljs-title">dataSource</span><span class="hljs-params">()</span></span>{
        DruidDataSource ds = <span class="hljs-keyword">new</span> DruidDataSource();
        ds.setDriverClassName(driver);
        ds.setUrl(url);
        ds.setUsername(userName);
        ds.setPassword(password);
        <span class="hljs-keyword">return</span> ds;
    }

    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;&#xFF0C;mybatis&#x4F7F;&#x7528;&#x7684;&#x662F;jdbc&#x4E8B;&#x52A1;</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title">transactionManager</span><span class="hljs-params">(DataSource dataSource)</span></span>{
        DataSourceTransactionManager transactionManager = <span class="hljs-keyword">new</span> DataSourceTransactionManager();
        transactionManager.setDataSource(dataSource);
        <span class="hljs-keyword">return</span> transactionManager;
    }
}
</code></pre>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5668;&#x8981;&#x6839;&#x636E;&#x4F7F;&#x7528;&#x6280;&#x672F;&#x8FDB;&#x884C;&#x9009;&#x62E9;&#xFF0C;Mybatis&#x6846;&#x67B6;&#x4F7F;&#x7528;&#x7684;&#x662F;JDBC&#x4E8B;&#x52A1;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;<code>DataSourceTransactionManager</code></p>
<h5 id="&#x6B65;&#x9AA4;3&#xFF1A;&#x5F00;&#x542F;&#x4E8B;&#x52A1;&#x6CE8;&#x89E3;">&#x6B65;&#x9AA4;3&#xFF1A;&#x5F00;&#x542F;&#x4E8B;&#x52A1;&#x6CE8;&#x89E3;</h5>
<p>&#x5728;SpringConfig&#x7684;&#x914D;&#x7F6E;&#x7C7B;&#x4E2D;&#x5F00;&#x542F;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ComponentScan</span>(<span class="hljs-string">&quot;com.itheima&quot;</span>)
<span class="hljs-meta">@PropertySource</span>(<span class="hljs-string">&quot;classpath:jdbc.properties&quot;</span>)
<span class="hljs-meta">@Import</span>({JdbcConfig.class,MybatisConfig.class
<span class="hljs-comment">//&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x5F0F;&#x4E8B;&#x52A1;&#x9A71;&#x52A8;</span>
<span class="hljs-meta">@EnableTransactionManagement</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringConfig</span> </span>{
}
</code></pre>
<h5 id="&#x6B65;&#x9AA4;4&#x8FD0;&#x884C;&#x6D4B;&#x8BD5;&#x7C7B;">&#x6B65;&#x9AA4;4:&#x8FD0;&#x884C;&#x6D4B;&#x8BD5;&#x7C7B;</h5>
<p>&#x4F1A;&#x53D1;&#x73B0;&#x5728;&#x8F6C;&#x6362;&#x7684;&#x4E1A;&#x52A1;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#x540E;&#xFF0C;&#x4E8B;&#x52A1;&#x5C31;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x56DE;&#x987E;&#xFF0C;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x6B63;&#x786E;&#x6027;&#x3002;</p>
<h5 id="&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;enabletransactionmanagement">&#x77E5;&#x8BC6;&#x70B9;1&#xFF1A;@EnableTransactionManagement</h5>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@EnableTransactionManagement</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x914D;&#x7F6E;&#x7C7B;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x914D;&#x7F6E;&#x7C7B;&#x5B9A;&#x4E49;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x8BBE;&#x7F6E;&#x5F53;&#x524D;Spring&#x73AF;&#x5883;&#x4E2D;&#x5F00;&#x542F;&#x6CE8;&#x89E3;&#x5F0F;&#x4E8B;&#x52A1;&#x652F;&#x6301;</td>
</tr>
</tbody>
</table>
<h5 id="&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;transactional">&#x77E5;&#x8BC6;&#x70B9;2&#xFF1A;@Transactional</h5>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>@Transactional</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x7C7B;&#x578B;</td>
<td>&#x63A5;&#x53E3;&#x6CE8;&#x89E3;  &#x7C7B;&#x6CE8;&#x89E3;  &#x65B9;&#x6CD5;&#x6CE8;&#x89E3;</td>
</tr>
<tr>
<td>&#x4F4D;&#x7F6E;</td>
<td>&#x4E1A;&#x52A1;&#x5C42;&#x63A5;&#x53E3;&#x4E0A;&#x65B9;  &#x4E1A;&#x52A1;&#x5C42;&#x5B9E;&#x73B0;&#x7C7B;&#x4E0A;&#x65B9;  &#x4E1A;&#x52A1;&#x65B9;&#x6CD5;&#x4E0A;&#x65B9;</td>
</tr>
<tr>
<td>&#x4F5C;&#x7528;</td>
<td>&#x4E3A;&#x5F53;&#x524D;&#x4E1A;&#x52A1;&#x5C42;&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x4E8B;&#x52A1;&#xFF08;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x5728;&#x7C7B;&#x6216;&#x63A5;&#x53E3;&#x4E0A;&#x65B9;&#x5219;&#x7C7B;&#x6216;&#x63A5;&#x53E3;&#x4E2D;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x5747;&#x6DFB;&#x52A0;&#x4E8B;&#x52A1;&#xFF09;</td>
</tr>
</tbody>
</table>
<h3 id="62-spring&#x4E8B;&#x52A1;&#x89D2;&#x8272;">6.2 Spring&#x4E8B;&#x52A1;&#x89D2;&#x8272;</h3>
<p>&#x8FD9;&#x8282;&#x4E2D;&#x6211;&#x4EEC;&#x91CD;&#x70B9;&#x8981;&#x7406;&#x89E3;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x5206;&#x522B;&#x662F;<code>&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5458;</code>&#x548C;<code>&#x4E8B;&#x52A1;&#x534F;&#x8C03;&#x5458;</code>&#x3002;</p>
<ol>
<li>&#x672A;&#x5F00;&#x542F;Spring&#x4E8B;&#x52A1;&#x4E4B;&#x524D;:</li>
</ol>
<p><img src="../.gitbook/assets/1630248794837.png" alt="1630248794837"></p>
<ul>
<li>AccountDao&#x7684;outMoney&#x56E0;&#x4E3A;&#x662F;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x4F1A;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;T1</li>
<li>AccountDao&#x7684;inMoney&#x56E0;&#x4E3A;&#x662F;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x4F1A;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;T2</li>
<li><p>AccountService&#x7684;transfer&#x6CA1;&#x6709;&#x4E8B;&#x52A1;&#xFF0C;</p>
<ul>
<li>&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x5219;T1&#x548C;T2&#x90FD;&#x6B63;&#x5E38;&#x63D0;&#x4EA4;&#xFF0C;&#x6570;&#x636E;&#x6B63;&#x786E;</li>
<li>&#x5982;&#x679C;&#x5728;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x4E2D;&#x95F4;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;T1&#x56E0;&#x4E3A;&#x6267;&#x884C;&#x6210;&#x529F;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#xFF0C;T2&#x56E0;&#x4E3A;&#x629B;&#x5F02;&#x5E38;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;</li>
<li>&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x51FA;&#x73B0;&#x9519;&#x8BEF;</li>
</ul>
</li>
<li><p>&#x5F00;&#x542F;Spring&#x7684;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x540E;</p>
</li>
</ul>
<p><img src="../.gitbook/assets/1630249111055.png" alt="1630249111055"></p>
<ul>
<li>transfer&#x4E0A;&#x6DFB;&#x52A0;&#x4E86;@Transactional&#x6CE8;&#x89E3;&#xFF0C;&#x5728;&#x8BE5;&#x65B9;&#x6CD5;&#x4E0A;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;T</li>
<li>AccountDao&#x7684;outMoney&#x65B9;&#x6CD5;&#x7684;&#x4E8B;&#x52A1;T1&#x52A0;&#x5165;&#x5230;transfer&#x7684;&#x4E8B;&#x52A1;T&#x4E2D;</li>
<li>AccountDao&#x7684;inMoney&#x65B9;&#x6CD5;&#x7684;&#x4E8B;&#x52A1;T2&#x52A0;&#x5165;&#x5230;transfer&#x7684;&#x4E8B;&#x52A1;T&#x4E2D;</li>
<li>&#x8FD9;&#x6837;&#x5C31;&#x4FDD;&#x8BC1;&#x4ED6;&#x4EEC;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x4E2D;&#xFF0C;&#x5F53;&#x4E1A;&#x52A1;&#x5C42;&#x4E2D;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#xFF0C;&#x6574;&#x4E2A;&#x4E8B;&#x52A1;&#x5C31;&#x4F1A;&#x56DE;&#x6EDA;&#xFF0C;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x51C6;&#x786E;&#x6027;&#x3002;</li>
</ul>
<p>&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#x7684;&#x5206;&#x6790;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5982;&#x4E0B;&#x6982;&#x5FF5;:</p>
<ul>
<li>&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5458;&#xFF1A;&#x53D1;&#x8D77;&#x4E8B;&#x52A1;&#x65B9;&#xFF0C;&#x5728;Spring&#x4E2D;&#x901A;&#x5E38;&#x6307;&#x4EE3;&#x4E1A;&#x52A1;&#x5C42;&#x5F00;&#x542F;&#x4E8B;&#x52A1;&#x7684;&#x65B9;&#x6CD5;</li>
<li>&#x4E8B;&#x52A1;&#x534F;&#x8C03;&#x5458;&#xFF1A;&#x52A0;&#x5165;&#x4E8B;&#x52A1;&#x65B9;&#xFF0C;&#x5728;Spring&#x4E2D;&#x901A;&#x5E38;&#x6307;&#x4EE3;&#x6570;&#x636E;&#x5C42;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E1A;&#x52A1;&#x5C42;&#x65B9;&#x6CD5;</li>
</ul>
<p>==&#x6CE8;&#x610F;:==</p>
<p>&#x76EE;&#x524D;&#x7684;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x662F;&#x57FA;&#x4E8E;<code>DataSourceTransactionManager</code>&#x548C;<code>SqlSessionFactoryBean</code>&#x4F7F;&#x7528;&#x7684;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x6E90;&#x3002;</p>
<h3 id="63-spring&#x4E8B;&#x52A1;&#x5C5E;&#x6027;">6.3 Spring&#x4E8B;&#x52A1;&#x5C5E;&#x6027;</h3>
<p>&#x4E0A;&#x4E00;&#x8282;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x4E86;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x4E8B;&#x52A1;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x548C;&#x4E8B;&#x52A1;&#x7684;&#x534F;&#x540C;&#x5458;&#xFF0C;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#x5177;&#x4F53;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5F85;&#x4F1A;&#x901A;&#x8FC7;&#x6848;&#x4F8B;&#x6765;&#x4F7F;&#x7528;&#x4E0B;&#x3002;&#x9664;&#x4E86;&#x8FD9;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x8FD8;&#x6709;&#x5C31;&#x662F;&#x4E8B;&#x52A1;&#x7684;&#x5176;&#x4ED6;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x90FD;&#x6709;&#x54EA;&#x4E9B;&#xFF0C;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x5B66;&#x4E60;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E00;&#x8282;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x5B66;&#x4E60;&#x4E09;&#x90E8;&#x5206;&#x5185;&#x5BB9;<code>&#x4E8B;&#x52A1;&#x914D;&#x7F6E;</code>&#x3001;<code>&#x8F6C;&#x8D26;&#x4E1A;&#x52A1;&#x8FFD;&#x52A0;&#x65E5;&#x5FD7;</code>&#x3001;<code>&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;</code>&#x3002;</p>
<h4 id="631-&#x4E8B;&#x52A1;&#x914D;&#x7F6E;">6.3.1 &#x4E8B;&#x52A1;&#x914D;&#x7F6E;</h4>
<p><img src="../.gitbook/assets/1630250069844.png" alt="1630250069844"></p>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x90FD;&#x53EF;&#x4EE5;&#x5728;<code>@Transactional</code>&#x6CE8;&#x89E3;&#x7684;&#x53C2;&#x6570;&#x4E0A;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x3002;</p>
<ul>
<li><p>readOnly&#xFF1A;true&#x53EA;&#x8BFB;&#x4E8B;&#x52A1;&#xFF0C;false&#x8BFB;&#x5199;&#x4E8B;&#x52A1;&#xFF0C;&#x589E;&#x5220;&#x6539;&#x8981;&#x8BBE;&#x4E3A;false,&#x67E5;&#x8BE2;&#x8BBE;&#x4E3A;true&#x3002;</p>
</li>
<li><p>timeout:&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x5355;&#x4F4D;&#x79D2;&#xFF0C;&#x5728;&#x591A;&#x957F;&#x65F6;&#x95F4;&#x4E4B;&#x5185;&#x4E8B;&#x52A1;&#x6CA1;&#x6709;&#x63D0;&#x4EA4;&#x6210;&#x529F;&#x5C31;&#x81EA;&#x52A8;&#x56DE;&#x6EDA;&#xFF0C;-1&#x8868;&#x793A;&#x4E0D;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x3002;</p>
</li>
<li><p>rollbackFor:&#x5F53;&#x51FA;&#x73B0;&#x6307;&#x5B9A;&#x5F02;&#x5E38;&#x8FDB;&#x884C;&#x4E8B;&#x52A1;&#x56DE;&#x6EDA;</p>
</li>
<li><p>noRollbackFor:&#x5F53;&#x51FA;&#x73B0;&#x6307;&#x5B9A;&#x5F02;&#x5E38;&#x4E0D;&#x8FDB;&#x884C;&#x4E8B;&#x52A1;&#x56DE;&#x6EDA;</p>
<ul>
<li><p>&#x601D;&#x8003;:&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x4F1A;&#x81EA;&#x52A8;&#x56DE;&#x6EDA;&#xFF0C;&#x8FD9;&#x4E2A;&#x662F;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5C31;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x7684;</p>
</li>
<li><p>noRollbackFor&#x662F;&#x8BBE;&#x5B9A;&#x5BF9;&#x4E8E;&#x6307;&#x5B9A;&#x7684;&#x5F02;&#x5E38;&#x4E0D;&#x56DE;&#x6EDA;&#xFF0C;&#x8FD9;&#x4E2A;&#x597D;&#x7406;&#x89E3;</p>
</li>
<li><p>rollbackFor&#x662F;&#x6307;&#x5B9A;&#x56DE;&#x6EDA;&#x5F02;&#x5E38;&#xFF0C;&#x5BF9;&#x4E8E;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x4E0D;&#x5E94;&#x8BE5;&#x90FD;&#x56DE;&#x6EDA;&#x4E48;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x8FD8;&#x8981;&#x6307;&#x5B9A;?</p>
<ul>
<li><p>&#x8FD9;&#x5757;&#x9700;&#x8981;&#x66F4;&#x6B63;&#x4E00;&#x4E2A;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x5F02;&#x5E38;&#x90FD;&#x4F1A;&#x56DE;&#x6EDA;&#x4E8B;&#x52A1;&#xFF0C;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5C31;&#x4E0D;&#x4F1A;&#x56DE;&#x6EDA;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountService</span> </span>{
    <span class="hljs-comment">/**
     * &#x8F6C;&#x8D26;&#x64CD;&#x4F5C;
     * <span class="hljs-doctag">@param</span> out &#x4F20;&#x51FA;&#x65B9;
     * <span class="hljs-doctag">@param</span> in &#x8F6C;&#x5165;&#x65B9;
     * <span class="hljs-doctag">@param</span> money &#x91D1;&#x989D;
     */</span>
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x5F53;&#x524D;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x5177;&#x6709;&#x4E8B;&#x52A1;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> <span class="hljs-keyword">throws</span> IOException</span>;
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> <span class="hljs-keyword">throws</span> IOException</span>{
        accountDao.outMoney(out,money);
        <span class="hljs-comment">//int i = 1/0; //&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x4F1A;&#x56DE;&#x6EDA;</span>
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IOException(); <span class="hljs-comment">//&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x5C31;&#x4E0D;&#x4F1A;&#x56DE;&#x6EDA;</span>
        }
        accountDao.inMoney(in,money);
    }

}
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li><p>&#x51FA;&#x73B0;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x539F;&#x56E0;&#x662F;&#xFF0C;Spring&#x7684;&#x4E8B;&#x52A1;&#x53EA;&#x4F1A;&#x5BF9;<code>Error&#x5F02;&#x5E38;</code>&#x548C;<code>RuntimeException&#x5F02;&#x5E38;</code>&#x53CA;&#x5176;&#x5B50;&#x7C7B;&#x8FDB;&#x884C;&#x4E8B;&#x52A1;&#x56DE;&#x987E;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5F02;&#x5E38;&#x7C7B;&#x578B;&#x662F;&#x4E0D;&#x4F1A;&#x56DE;&#x6EDA;&#x7684;&#xFF0C;&#x5BF9;&#x5E94;IOException&#x4E0D;&#x7B26;&#x5408;&#x4E0A;&#x8FF0;&#x6761;&#x4EF6;&#x6240;&#x4EE5;&#x4E0D;&#x56DE;&#x6EDA;</p>
<ul>
<li><p>&#x6B64;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;rollbackFor&#x5C5E;&#x6027;&#x6765;&#x8BBE;&#x7F6E;&#x51FA;&#x73B0;IOException&#x5F02;&#x5E38;&#x4E0D;&#x56DE;&#x6EDA;</p>
<pre><code class="lang-java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;
     <span class="hljs-meta">@Transactional</span>(rollbackFor = {IOException.class})
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> <span class="hljs-keyword">throws</span> IOException</span>{
        accountDao.outMoney(out,money);
        <span class="hljs-comment">//int i = 1/0; //&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x4F1A;&#x56DE;&#x6EDA;</span>
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IOException(); <span class="hljs-comment">//&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x4E8B;&#x52A1;&#x5C31;&#x4E0D;&#x4F1A;&#x56DE;&#x6EDA;</span>
        }
        accountDao.inMoney(in,money);
    }

}
</code></pre>
</li>
</ul>
</li>
<li><p>rollbackForClassName&#x7B49;&#x540C;&#x4E8E;rollbackFor,&#x53EA;&#x4E0D;&#x8FC7;&#x5C5E;&#x6027;&#x4E3A;&#x5F02;&#x5E38;&#x7684;&#x7C7B;&#x5168;&#x540D;&#x5B57;&#x7B26;&#x4E32;</p>
</li>
<li><p>noRollbackForClassName&#x7B49;&#x540C;&#x4E8E;noRollbackFor&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5C5E;&#x6027;&#x4E3A;&#x5F02;&#x5E38;&#x7684;&#x7C7B;&#x5168;&#x540D;&#x5B57;&#x7B26;&#x4E32;</p>
</li>
<li><p>isolation&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x7684;&#x9694;&#x79BB;&#x7EA7;&#x522B;</p>
<ul>
<li>DEFAULT   :&#x9ED8;&#x8BA4;&#x9694;&#x79BB;&#x7EA7;&#x522B;, &#x4F1A;&#x91C7;&#x7528;&#x6570;&#x636E;&#x5E93;&#x7684;&#x9694;&#x79BB;&#x7EA7;&#x522B;</li>
<li>READ_UNCOMMITTED : &#x8BFB;&#x672A;&#x63D0;&#x4EA4;</li>
<li>READ_COMMITTED : &#x8BFB;&#x5DF2;&#x63D0;&#x4EA4;</li>
<li>REPEATABLE_READ : &#x91CD;&#x590D;&#x8BFB;&#x53D6;</li>
<li>SERIALIZABLE: &#x4E32;&#x884C;&#x5316;</li>
</ul>
</li>
</ul>
<p>&#x4ECB;&#x7ECD;&#x5B8C;&#x4E0A;&#x8FF0;&#x5C5E;&#x6027;&#x540E;&#xFF0C;&#x8FD8;&#x6709;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x7684;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#xFF0C;&#x4E3A;&#x4E86;&#x8BB2;&#x89E3;&#x8BE5;&#x5C5E;&#x6027;&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x6848;&#x4F8B;&#x3002;</p>
<h4 id="632-&#x8F6C;&#x8D26;&#x4E1A;&#x52A1;&#x8FFD;&#x52A0;&#x65E5;&#x5FD7;&#x6848;&#x4F8B;">6.3.2 &#x8F6C;&#x8D26;&#x4E1A;&#x52A1;&#x8FFD;&#x52A0;&#x65E5;&#x5FD7;&#x6848;&#x4F8B;</h4>
<h5 id="6321-&#x9700;&#x6C42;&#x5206;&#x6790;">6.3.2.1 &#x9700;&#x6C42;&#x5206;&#x6790;</h5>
<p>&#x5728;&#x524D;&#x9762;&#x7684;&#x8F6C;&#x6848;&#x4F8B;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x5B8C;&#x6210;&#x8F6C;&#x8D26;&#x540E;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x3002;</p>
<ul>
<li>&#x9700;&#x6C42;&#xFF1A;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x4E24;&#x4E2A;&#x8D26;&#x6237;&#x95F4;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5BF9;&#x6BCF;&#x6B21;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x5728;&#x6570;&#x636E;&#x5E93;&#x8FDB;&#x884C;&#x7559;&#x75D5;</li>
<li>&#x9700;&#x6C42;&#x5FAE;&#x7F29;&#xFF1A;A&#x8D26;&#x6237;&#x51CF;&#x94B1;&#xFF0C;B&#x8D26;&#x6237;&#x52A0;&#x94B1;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;</li>
</ul>
<p>&#x57FA;&#x4E8E;&#x4E0A;&#x8FF0;&#x7684;&#x4E1A;&#x52A1;&#x9700;&#x6C42;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x5206;&#x6790;&#x4E0B;&#x8BE5;&#x5982;&#x4F55;&#x5B9E;&#x73B0;:</p>
<p>&#x2460;&#xFF1A;&#x57FA;&#x4E8E;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x6848;&#x4F8B;&#x6DFB;&#x52A0;&#x65E5;&#x5FD7;&#x6A21;&#x5757;&#xFF0C;&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;</p>
<p>&#x2461;&#xFF1A;&#x4E1A;&#x52A1;&#x5C42;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#xFF08;transfer&#xFF09;&#xFF0C;&#x8C03;&#x7528;&#x51CF;&#x94B1;&#x3001;&#x52A0;&#x94B1;&#x4E0E;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x529F;&#x80FD;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x8FD9;&#x4E2A;&#x6848;&#x4F8B;&#x7684;&#x9884;&#x671F;&#x6548;&#x679C;&#x4E3A;:</p>
<p>==&#x65E0;&#x8BBA;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x662F;&#x5426;&#x6210;&#x529F;&#xFF0C;&#x5747;&#x8FDB;&#x884C;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x7684;&#x65E5;&#x5FD7;&#x7559;&#x75D5;==</p>
<h5 id="6322-&#x73AF;&#x5883;&#x51C6;&#x5907;">6.3.2.2 &#x73AF;&#x5883;&#x51C6;&#x5907;</h5>
<p>&#x8BE5;&#x73AF;&#x5883;&#x662F;&#x57FA;&#x4E8E;&#x8F6C;&#x8D26;&#x73AF;&#x5883;&#x6765;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x73AF;&#x5883;&#x7684;&#x51C6;&#x5907;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<code>6.1.3&#x7684;&#x73AF;&#x5883;&#x642D;&#x5EFA;&#x6B65;&#x9AA4;</code>&#xFF0C;&#x5728;&#x5176;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x5199;</p>
<h6 id="&#x6B65;&#x9AA4;1&#x521B;&#x5EFA;&#x65E5;&#x5FD7;&#x8868;">&#x6B65;&#x9AA4;1:&#x521B;&#x5EFA;&#x65E5;&#x5FD7;&#x8868;</h6>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> tbl_log(
   <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span> auto_increment,
   info <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),
   createDate datetime
)
</code></pre>
<h6 id="&#x6B65;&#x9AA4;2&#x6DFB;&#x52A0;logdao&#x63A5;&#x53E3;">&#x6B65;&#x9AA4;2:&#x6DFB;&#x52A0;LogDao&#x63A5;&#x53E3;</h6>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">LogDao</span> </span>{
    <span class="hljs-meta">@Insert</span>(<span class="hljs-string">&quot;insert into tbl_log (info,createDate) values(#{info},now())&quot;</span>)
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String info)</span></span>;
}
</code></pre>
<h6 id="&#x6B65;&#x9AA4;3&#x6DFB;&#x52A0;logservice&#x63A5;&#x53E3;&#x4E0E;&#x5B9E;&#x73B0;&#x7C7B;">&#x6B65;&#x9AA4;3:&#x6DFB;&#x52A0;LogService&#x63A5;&#x53E3;&#x4E0E;&#x5B9E;&#x73B0;&#x7C7B;</h6>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">LogService</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String out, String in, Double money)</span></span>;
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">LogService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LogDao logDao;
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String out,String in,Double money )</span> </span>{
        logDao.log(<span class="hljs-string">&quot;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x7531;&quot;</span>+out+<span class="hljs-string">&quot;&#x5230;&quot;</span>+in+<span class="hljs-string">&quot;,&#x91D1;&#x989D;&#xFF1A;&quot;</span>+money);
    }
}
</code></pre>
<h6 id="&#x6B65;&#x9AA4;4&#x5728;&#x8F6C;&#x8D26;&#x7684;&#x4E1A;&#x52A1;&#x4E2D;&#x6DFB;&#x52A0;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;">&#x6B65;&#x9AA4;4:&#x5728;&#x8F6C;&#x8D26;&#x7684;&#x4E1A;&#x52A1;&#x4E2D;&#x6DFB;&#x52A0;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;</h6>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AccountService</span> </span>{
    <span class="hljs-comment">/**
     * &#x8F6C;&#x8D26;&#x64CD;&#x4F5C;
     * <span class="hljs-doctag">@param</span> out &#x4F20;&#x51FA;&#x65B9;
     * <span class="hljs-doctag">@param</span> in &#x8F6C;&#x5165;&#x65B9;
     * <span class="hljs-doctag">@param</span> money &#x91D1;&#x989D;
     */</span>
    <span class="hljs-comment">//&#x914D;&#x7F6E;&#x5F53;&#x524D;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x5177;&#x6709;&#x4E8B;&#x52A1;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span><span class="hljs-keyword">throws</span> IOException </span>;
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AccountService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountDao accountDao;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LogService logService;
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">transfer</span><span class="hljs-params">(String out,String in ,Double money)</span> </span>{
        <span class="hljs-keyword">try</span>{
            accountDao.outMoney(out,money);
            accountDao.inMoney(in,money);
        }<span class="hljs-keyword">finally</span> {
            logService.log(out,in,money);
        }
    }

}
</code></pre>
<h6 id="&#x6B65;&#x9AA4;5&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;">&#x6B65;&#x9AA4;5:&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;</h6>
<ul>
<li><p>&#x5F53;&#x7A0B;&#x5E8F;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#xFF0C;tbl_account&#x8868;&#x4E2D;&#x8F6C;&#x8D26;&#x6210;&#x529F;&#xFF0C;tbl_log&#x8868;&#x4E2D;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x6210;&#x529F;</p>
</li>
<li><p>&#x5F53;&#x8F6C;&#x8D26;&#x4E1A;&#x52A1;&#x4E4B;&#x95F4;&#x51FA;&#x73B0;&#x5F02;&#x5E38;(int i =1/0),&#x8F6C;&#x8D26;&#x5931;&#x8D25;&#xFF0C;tbl_account&#x6210;&#x529F;&#x56DE;&#x6EDA;&#xFF0C;&#x4F46;&#x662F;tbl_log&#x8868;&#x672A;&#x6DFB;&#x52A0;&#x6570;&#x636E;</p>
</li>
<li>&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x548C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x4EC0;&#x4E48;&#x539F;&#x56E0;?&#x8BE5;&#x5982;&#x4F55;&#x89E3;&#x51B3;?</li>
<li>&#x5931;&#x8D25;&#x539F;&#x56E0;:&#x65E5;&#x5FD7;&#x7684;&#x8BB0;&#x5F55;&#x4E0E;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x96B6;&#x5C5E;&#x540C;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#xFF0C;&#x540C;&#x6210;&#x529F;&#x540C;&#x5931;&#x8D25;</li>
<li>&#x6700;&#x7EC8;&#x6548;&#x679C;:&#x65E0;&#x8BBA;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x662F;&#x5426;&#x6210;&#x529F;&#xFF0C;&#x65E5;&#x5FD7;&#x5FC5;&#x987B;&#x4FDD;&#x7559;</li>
</ul>
<h4 id="633-&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;">6.3.3 &#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;</h4>
<p><img src="../.gitbook/assets/1630253779575.png" alt="1630253779575"></p>
<p>&#x5BF9;&#x4E8E;&#x4E0A;&#x8FF0;&#x6848;&#x4F8B;&#x7684;&#x5206;&#x6790;:</p>
<ul>
<li>log&#x65B9;&#x6CD5;&#x3001;inMoney&#x65B9;&#x6CD5;&#x548C;outMoney&#x65B9;&#x6CD5;&#x90FD;&#x5C5E;&#x4E8E;&#x589E;&#x5220;&#x6539;&#xFF0C;&#x5206;&#x522B;&#x6709;&#x4E8B;&#x52A1;T1,T2,T3</li>
<li>transfer&#x56E0;&#x4E3A;&#x52A0;&#x4E86;@Transactional&#x6CE8;&#x89E3;&#xFF0C;&#x4E5F;&#x5F00;&#x542F;&#x4E86;&#x4E8B;&#x52A1;T</li>
<li>&#x524D;&#x9762;&#x6211;&#x4EEC;&#x8BB2;&#x8FC7;Spring&#x4E8B;&#x52A1;&#x4F1A;&#x628A;T1,T2,T3&#x90FD;&#x52A0;&#x5165;&#x5230;&#x4E8B;&#x52A1;T&#x4E2D;</li>
<li>&#x6240;&#x4EE5;&#x5F53;&#x8F6C;&#x8D26;&#x5931;&#x8D25;&#x540E;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4E8B;&#x52A1;&#x90FD;&#x56DE;&#x6EDA;&#xFF0C;&#x5BFC;&#x81F4;&#x65E5;&#x5FD7;&#x6CA1;&#x6709;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;</li>
<li>&#x8FD9;&#x548C;&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;&#x4E0D;&#x7B26;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x5C31;&#x60F3;&#x80FD;&#x4E0D;&#x80FD;&#x8BA9;log&#x65B9;&#x6CD5;&#x5355;&#x72EC;&#x662F;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x5462;?</li>
</ul>
<p>&#x8981;&#x60F3;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#xFF0C;&#x6240;&#x8C13;&#x7684;&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#x6307;&#x7684;&#x662F;:</p>
<p>&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#xFF1A;&#x4E8B;&#x52A1;&#x534F;&#x8C03;&#x5458;&#x5BF9;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x5458;&#x6240;&#x643A;&#x5E26;&#x4E8B;&#x52A1;&#x7684;&#x5904;&#x7406;&#x6001;&#x5EA6;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5982;&#x4F55;&#x89E3;&#x51B3;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x8BF4;&#x7684;<code>propagation&#x5C5E;&#x6027;</code>&#x3002;</p>
<h5 id="1&#x4FEE;&#x6539;logservice&#x6539;&#x53D8;&#x4E8B;&#x52A1;&#x7684;&#x4F20;&#x64AD;&#x884C;&#x4E3A;">1.&#x4FEE;&#x6539;logService&#x6539;&#x53D8;&#x4E8B;&#x52A1;&#x7684;&#x4F20;&#x64AD;&#x884C;&#x4E3A;</h5>
<pre><code class="lang-java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">LogService</span> </span>{

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LogDao logDao;
    <span class="hljs-comment">//propagation&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x5C5E;&#x6027;&#xFF1A;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#x8BBE;&#x7F6E;&#x4E3A;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x65B0;&#x4E8B;&#x52A1;</span>
    <span class="hljs-meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String out,String in,Double money )</span> </span>{
        logDao.log(<span class="hljs-string">&quot;&#x8F6C;&#x8D26;&#x64CD;&#x4F5C;&#x7531;&quot;</span>+out+<span class="hljs-string">&quot;&#x5230;&quot;</span>+in+<span class="hljs-string">&quot;,&#x91D1;&#x989D;&#xFF1A;&quot;</span>+money);
    }
}
</code></pre>
<p>&#x8FD0;&#x884C;&#x540E;&#xFF0C;&#x5C31;&#x80FD;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4E0D;&#x7BA1;&#x8F6C;&#x8D26;&#x662F;&#x5426;&#x6210;&#x529F;&#xFF0C;&#x90FD;&#x4F1A;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x3002;</p>
<h5 id="2&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#x7684;&#x53EF;&#x9009;&#x503C;">2.&#x4E8B;&#x52A1;&#x4F20;&#x64AD;&#x884C;&#x4E3A;&#x7684;&#x53EF;&#x9009;&#x503C;</h5>
<p><img src="../.gitbook/assets/1630254257628.png" alt="1630254257628"></p>
<p>&#x5BF9;&#x4E8E;&#x6211;&#x4EEC;&#x5F00;&#x53D1;&#x5B9E;&#x9645;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x8BDD;&#xFF0C;&#x56E0;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#x9700;&#x8981;&#x4E8B;&#x52A1;&#x662F;&#x5E38;&#x6001;&#x7684;&#x3002;&#x6839;&#x636E;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x9009;&#x62E9;&#x5176;&#x4ED6;&#x7684;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x4F8B;&#x5982;&#x6848;&#x4F8B;&#x4E2D;&#x9700;&#x8981;&#x65B0;&#x4E8B;&#x52A1;&#x5C31;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x914D;&#x7F6E;&#x3002;&#x5176;&#x5B9E;&#x5165;&#x8D26;&#x548C;&#x51FA;&#x8D26;&#x64CD;&#x4F5C;&#x4E0A;&#x4E5F;&#x6709;&#x4E8B;&#x52A1;&#xFF0C;&#x91C7;&#x7528;&#x7684;&#x5C31;&#x662F;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Spring_2.html" class="navigation navigation-prev " aria-label="Previous page: Spring_2">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../springmvc/SpringMVC_1.html" class="navigation navigation-next " aria-label="Next page: Spring MVC_1">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Spring_3","level":"3.3","depth":1,"next":{"title":"Spring MVC_1","level":"4.1","depth":1,"path":"springmvc/SpringMVC_1.md","ref":"springmvc/SpringMVC_1.md","articles":[]},"previous":{"title":"Spring_2","level":"3.2","depth":1,"path":"spring/Spring_2.md","ref":"spring/Spring_2.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"spring/Spring_3.md","mtime":"2023-04-24T15:27:14.057Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-04-24T15:59:17.501Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

